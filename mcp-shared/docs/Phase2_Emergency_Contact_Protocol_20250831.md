# Phase 2緊急連絡体制プロトコル

**作成日**: 2025年8月31日  
**有効期間**: Phase 2実施期間（9月1日-5日）  
**対象**: VoiceDriveチーム・医療職員管理システムチーム

## 🚨 緊急連絡体制概要

Phase 2本番移行期間中の24時間緊急対応体制を確立します。

### 📞 緊急連絡先一覧

#### VoiceDriveチーム 24時間対応
- **緊急ホットライン**: `voicedrive-emergency-hotline`
- **Slack緊急チャンネル**: `#phase2-emergency-support`
- **技術リード**: VoiceDrive技術責任者（24時間待機）
- **インフラ担当**: AWS・サーバー専任（24時間待機）

#### 医療システムチーム 営業時間対応
- **営業時間**: 平日 8:00-18:00
- **専任担当**: 医療システム Phase 2責任者
- **緊急時**: 営業時間外は翌営業日対応

#### 合同対応チーム
- **重大障害時**: 30分以内に合同対応開始
- **対応レベル**: Level 1（軽微）〜 Level 4（システム停止）

## 🎯 エスカレーション基準

### Level 1: 軽微な問題
- **例**: 個別通知配信遅延、UI表示問題
- **対応時間**: 4時間以内
- **対応チーム**: 該当システムチーム単独

### Level 2: 中程度の問題  
- **例**: API応答遅延、一部機能停止
- **対応時間**: 2時間以内
- **対応チーム**: 技術リード参加

### Level 3: 重大な問題
- **例**: 大量通知配信失敗、データ不整合
- **対応時間**: 1時間以内
- **対応チーム**: 合同対応チーム招集

### Level 4: システム停止
- **例**: 全システム停止、データ消失
- **対応時間**: 30分以内
- **対応チーム**: 全チーム緊急招集・経営陣報告

## 📋 Phase 2期間中の特別体制

### 9月1日（日） 本番環境設定日
```
担当者待機スケジュール:
08:00-12:00 VoiceDrive: インフラチーム常駐
13:00-17:00 VoiceDrive: 開発チーム常駐  
18:00-20:00 VoiceDrive: 運用チーム待機
20:00-08:00 VoiceDrive: オンコール体制
```

### 9月2-3日（月-火） 本番統合テスト
```
合同作業体制:
09:00-12:00 両チーム合同テスト実施
13:00-17:00 両チーム合同テスト実施
17:00-18:00 日次進捗会議・問題対応
18:00-09:00 VoiceDrive: オンコール待機
```

### 9月4-5日（水-木） 最終確認・承認
```
最終判定体制:
09:00-17:00 両チーム常駐・最終確認
17:00-18:00 Go/No-Go最終判定会議
18:00以降 VoiceDrive: 24時間監視開始
```

## 🔧 技術的緊急対応手順

### システム障害時の自動対応
```bash
# 1. 自動ヘルスチェック（30秒間隔）
curl https://api.voicedrive.medical.local/health

# 2. 障害検知時の自動スケールアウト
aws autoscaling set-desired-capacity --auto-scaling-group-name voicedrive-prod

# 3. フェイルオーバー実行
kubectl rollout restart deployment/voicedrive-api

# 4. 緊急連絡自動送信
slack-notify "#phase2-emergency" "System failure detected - Level 3"
```

### データバックアップ・復旧手順
```bash
# データベース緊急バックアップ
pg_dump voicedrive_prod > emergency_backup_$(date +%Y%m%d_%H%M%S).sql

# 緊急復旧（最新バックアップから）
psql voicedrive_prod < latest_backup.sql

# API再起動・接続確認
systemctl restart voicedrive-api
curl -f https://api.voicedrive.medical.local/api/status
```

## 📊 監視・アラート設定

### リアルタイム監視項目
- **API応答時間**: >500ms でアラート
- **通知配信成功率**: <95% でアラート  
- **データベース接続**: 接続失敗でアラート
- **CPU・メモリ使用率**: >80% で警告、>90% でアラート

### アラート通知先
1. **Slack**: `#phase2-emergency` (全レベル)
2. **メール**: 技術リード（Level 2以上）
3. **SMS**: 緊急ホットライン（Level 3以上）
4. **電話**: 責任者直通（Level 4）

## 🎭 役割・責任分担

### VoiceDriveチーム緊急時役割
- **インフラ担当**: サーバー・AWS・データベース対応
- **API開発担当**: バックエンド・API・認証問題対応  
- **フロントエンド担当**: UI・UX・ブラウザ問題対応
- **QAテスト担当**: 復旧後の動作確認・回帰テスト

### 医療システムチーム緊急時役割
- **API連携担当**: 医療システム側API・通信問題対応
- **データ管理担当**: 評価データ・整合性問題対応
- **運用担当**: 医療システム側設定・権限問題対応

## 📞 緊急時連絡フロー

### Step 1: 問題発見・初期対応
1. 問題発見者が初期診断・レベル判定
2. 該当チームSlackチャンネルに第一報
3. 15分以内に初期対応開始

### Step 2: エスカレーション判定
1. 30分以内に解決見込みを評価
2. 困難と判断した場合、上位レベルにエスカレーション
3. 必要に応じて合同対応チーム招集

### Step 3: 合同対応・解決
1. 両チーム技術リードによる問題分析
2. 解決方針決定・作業分担
3. 並行作業による迅速な問題解決

### Step 4: 復旧確認・報告
1. 復旧後の動作確認（30分間監視）
2. 問題の根本原因分析
3. 再発防止策の検討・実施

## 📝 緊急時対応記録

Phase 2期間中の全ての問題・対応を記録：

### 記録項目
- 発生日時・問題内容・影響範囲
- 対応開始時刻・解決時刻・対応時間
- 対応者・対応手順・結果
- 根本原因・再発防止策

### 記録方法
```bash
# 緊急事態記録テンプレート
cat > emergency_log_$(date +%Y%m%d_%H%M%S).md << 'EOF'
# Phase 2緊急事態対応記録

## 基本情報
- 発生日時: $(date)
- 問題レベル: [Level 1-4]
- 影響システム: [VoiceDrive/医療システム/両方]

## 問題詳細
- 症状: [具体的な症状]
- 影響範囲: [影響を受けた機能・ユーザー]
- 推定原因: [初期診断結果]

## 対応記録
- 対応開始: [時刻]
- 対応者: [担当者名]
- 対応手順: [実施した対応]
- 解決時刻: [時刻]
- 対応時間: [分]

## 根本原因・対策
- 根本原因: [詳細分析結果]
- 再発防止策: [実施予定の対策]
EOF
```

## 🎯 Phase 2成功のための特別配慮

### ユーザー影響最小化
- **段階的展開**: 問題発生時の影響範囲限定
- **迅速な情報提供**: ユーザー向けの透明な状況報告
- **代替手段確保**: システム障害時の業務継続方法

### 医療業務への配慮
- **営業時間優先**: 営業時間内の問題は最優先対応
- **データ整合性重視**: 医療データの正確性を最重要視
- **セキュリティ維持**: 緊急時でもセキュリティ基準堅持

## ✅ Phase 2緊急体制チェックリスト

### 事前準備（8月31日完了）
- [ ] 緊急連絡先リスト配布・確認
- [ ] 監視システム・アラート設定完了
- [ ] 緊急時対応手順書配布・説明
- [ ] バックアップ・復旧手順テスト完了
- [ ] 合同緊急対応チーム顔合わせ完了

### Phase 2期間中（毎日確認）
- [ ] 担当者待機状況確認
- [ ] 監視システム正常動作確認  
- [ ] 緊急連絡手段疎通確認
- [ ] バックアップデータ最新性確認
- [ ] 前日問題・対応状況レビュー

---

**緊急時は冷静・迅速・協力で対応しましょう！**

VoiceDriveチーム・医療システムチーム 合同緊急対応体制
Phase 2実施委員会