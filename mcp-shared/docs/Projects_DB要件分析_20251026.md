# EnhancedProjectListPage (/projects) DBè¦ä»¶åˆ†æ

**æ–‡æ›¸ç•ªå·**: DB-REQ-2025-1026-003
**ä½œæˆæ—¥**: 2025å¹´10æœˆ26æ—¥
**å¯¾è±¡ãƒšãƒ¼ã‚¸**: https://voicedrive-v100.vercel.app/projects EnhancedProjectListPage
**å‚ç…§æ–‡æ›¸**:
- [ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»åˆ†ç•Œç‚¹å®šç¾©æ›¸_20251008.md](./ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»åˆ†ç•Œç‚¹å®šç¾©æ›¸_20251008.md)
- [ProjectListPage_DBè¦ä»¶åˆ†æ_20251026.md](./ProjectListPage_DBè¦ä»¶åˆ†æ_20251026.md)
- [PersonalStation_DBè¦ä»¶åˆ†æ_20251008.md](./PersonalStation_DBè¦ä»¶åˆ†æ_20251008.md)

---

## ğŸ“‹ åˆ†æã‚µãƒãƒªãƒ¼

### çµè«–
EnhancedProjectListPageï¼ˆ/projectsï¼‰ã¯**VoiceDriveç‹¬è‡ªã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤ºæ©Ÿèƒ½**ã§ã‚ã‚Šã€**Phase 2ã¾ã§å®Œå…¨å®Ÿè£…æ¸ˆã¿**ã§ã™ã€‚

### ğŸ‰ å®Ÿè£…çŠ¶æ³
| é …ç›® | çŠ¶æ…‹ | è©³ç´° |
|------|------|------|
| **Phase 1å®Ÿè£…** | âœ… **å®Œäº†** | åŸºæœ¬çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤º |
| **Phase 2å®Ÿè£…** | âœ… **å®Œäº†** | ãƒ¬ãƒ™ãƒ«è¨ˆç®—ãƒ»æ‰¿èªãƒ•ãƒ­ãƒ¼ãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ** | âœ… **å®Œå…¨** | å…¨å¿…è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å­˜åœ¨ |
| **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIé€£æº** | âœ… **å®Œäº†** | éƒ¨ç½²ãƒã‚¹ã‚¿APIçµ±åˆæ¸ˆã¿ |
| **ã‚µãƒ¼ãƒ“ã‚¹å±¤** | âœ… **å®Œäº†** | 6ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…æ¸ˆã¿ |
| **Phase 3å®Ÿè£…** | ğŸŸ¡ **æœªå®Ÿè£…** | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿ï¼‰ |

---

## ğŸ¯ ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»åˆ†ç•Œç‚¹

### VoiceDriveå´ã®è²¬ä»»ï¼ˆ100%ï¼‰
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºæœ¬æƒ…å ±ï¼ˆtitle, description, status, category, priorityï¼‰
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ï¼ˆDEPARTMENT/FACILITY/CORPORATE/EMERGENCYï¼‰
- âœ… é€²æ—ç®¡ç†ï¼ˆprogressRate, startedAt, completedAtï¼‰
- âœ… æ‰¿èªçŠ¶æ…‹ï¼ˆapprovalStatus, currentApproverï¼‰
- âœ… ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆisEmergencyEscalated, escalatedBy, escalatedDateï¼‰
- âœ… ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ï¼ˆProjectTeamMemberï¼‰
- âœ… å‚åŠ è€…æ•°ã®é›†è¨ˆ
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼å½¹å‰²åˆ¤å®šï¼ˆowner/participant/viewerï¼‰

### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ã®è²¬ä»»
- ğŸ“¡ éƒ¨ç½²ãƒã‚¹ã‚¿APIæä¾›ã®ã¿ï¼ˆGET /api/v2/departmentsï¼‰
- ğŸ“¡ æ–½è¨­æƒ…å ±æä¾›ã®ã¿ï¼ˆdepartmentsãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…ï¼‰
- âŒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ã¯**ä¸€åˆ‡ãªã—**

---

## ğŸ“Š ãƒšãƒ¼ã‚¸æ©Ÿèƒ½åˆ†æ

### 1. URLãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
```typescript
// ãƒšãƒ¼ã‚¸URL
https://voicedrive-v100.vercel.app/projects

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
src/pages/ProjectListPage.tsx

// URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®åˆæœŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¯¾å¿œ
?filter=active        â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: é€²è¡Œä¸­
?filter=completed     â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Œäº†
?filter=department    â†’ ã‚«ãƒ†ã‚´ãƒªãƒ¼: æ¥­å‹™æ”¹å–„
?filter=facility      â†’ ã‚«ãƒ†ã‚´ãƒªãƒ¼: æ–½è¨­ç®¡ç†
?filter=corporate     â†’ ã‚«ãƒ†ã‚´ãƒªãƒ¼: ã‚·ã‚¹ãƒ†ãƒ 
```

---

### 2. ç”»é¢æ§‹æˆ

#### 2.1 çµ±è¨ˆã‚µãƒãƒªãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³
```typescript
interface ProjectStats {
  active: number;      // å‚åŠ ä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
  completed: number;   // å®Œäº†æ¸ˆã¿ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
  proposed: number;    // ææ¡ˆä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
  owned: number;       // ã‚ªãƒ¼ãƒŠãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
}
```

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `ProjectListService.getProjectStats(currentUserId)`
**è¨ˆç®—æ–¹æ³•**:
- `active`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‚åŠ ä¸­ï¼ˆproposer or teamMemberï¼‰ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
- `completed`: å…¨ã¦ã®completedçŠ¶æ…‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
- `proposed`: å…¨ã¦ã®proposedçŠ¶æ…‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°
- `owned`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒproposerã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°

---

#### 2.2 æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³
```typescript
interface Filters {
  searchTerm: string;                                    // ã‚¿ã‚¤ãƒˆãƒ«ãƒ»èª¬æ˜æ–‡ã§æ¤œç´¢
  status: 'all' | 'active' | 'completed' | 'proposed';  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
  category: 'all' | 'improvement' | 'community' | 'facility' | 'system'; // ã‚«ãƒ†ã‚´ãƒªãƒ¼
  level: 'all' | 'DEPARTMENT' | 'FACILITY' | 'CORPORATE' | 'EMERGENCY';  // ãƒ¬ãƒ™ãƒ«
}
```

**å®Ÿè£…çŠ¶æ³**: âœ… å®Œå…¨å®Ÿè£…æ¸ˆã¿
- æ¤œç´¢: ã‚¿ã‚¤ãƒˆãƒ«ãƒ»èª¬æ˜æ–‡ã®éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ï¼ˆå¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ãªã—ï¼‰
- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: 4ã¤ã®ç‹¬ç«‹ã—ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆANDæ¡ä»¶ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‚åŠ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: proposer or teamMemberã®ã¿è¡¨ç¤º

---

#### 2.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³

**47ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’è¡¨ç¤º**:

```typescript
interface ProjectListItem {
  // === åŸºæœ¬æƒ…å ±ï¼ˆ9é …ç›®ï¼‰===
  id: string;                    // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID
  title: string;                 // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
  description: string;           // èª¬æ˜æ–‡
  status: 'proposed' | 'active' | 'completed' | 'paused';  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  category: 'improvement' | 'community' | 'facility' | 'system'; // ã‚«ãƒ†ã‚´ãƒªãƒ¼
  priority: 'high' | 'medium' | 'low' | 'urgent' | null;  // å„ªå…ˆåº¦
  progress: number;              // é€²æ—ç‡ï¼ˆ0-100ï¼‰
  startDate: string | null;      // é–‹å§‹æ—¥
  endDate: string | null;        // å®Œäº†æ—¥

  // === ãƒãƒ¼ãƒ æƒ…å ±ï¼ˆ2é …ç›®ï¼‰===
  participants: number;          // å‚åŠ è€…æ•°ï¼ˆé›†è¨ˆï¼‰
  myRole: 'owner' | 'participant' | 'viewer';  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å½¹å‰²

  // === çµ„ç¹”æƒ…å ±ï¼ˆ2é …ç›®ï¼‰===
  department: string;            // ææ¡ˆè€…ã®éƒ¨ç½²å
  facility: string;              // æ–½è¨­åï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIã‹ã‚‰å–å¾—ï¼‰

  // === Phase 2æ‹¡å¼µï¼ˆ6é …ç›®ï¼‰===
  projectLevel: string | null;          // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«
  isEmergencyEscalated: boolean;       // ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æœ‰ç„¡
  escalatedBy: string | null;          // ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œè€…ID
  escalatedDate: string | null;        // ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ—¥æ™‚
  approvalStatus: string;              // æ‰¿èªçŠ¶æ…‹
  currentApprover: string | null;      // ç¾åœ¨ã®æ‰¿èªè€…ID
}
```

**åˆè¨ˆ47ãƒ‡ãƒ¼ã‚¿é …ç›®ã®å†…è¨³**:
- åŸºæœ¬æƒ…å ±: 9é …ç›®
- ãƒãƒ¼ãƒ æƒ…å ±: 2é …ç›®
- çµ„ç¹”æƒ…å ±: 2é …ç›®
- Phase 2æ‹¡å¼µ: 6é …ç›®
- å†…éƒ¨ç®¡ç†ç”¨: 28é …ç›®ï¼ˆproposerId, createdAt, updatedAtç­‰ï¼‰

---

## ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…çŠ¶æ³

### 1. Projectãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå®Œå…¨å®Ÿè£…æ¸ˆã¿ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `prisma/schema.prisma` (lines 308-365)

```prisma
model Project {
  // === Phase 1: åŸºæœ¬ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ===
  id                    String    @id @default(cuid())
  title                 String
  description           String
  category              String    // improvement/community/facility/system
  status                String    @default("proposed")  // proposed/active/completed/paused
  priority              String?   // high/medium/low/urgent
  proposerId            String
  progressRate          Float     @default(0)  // 0-100ï¼ˆprogressè¡¨ç¤ºç”¨ï¼‰
  startedAt             DateTime? // startDateè¡¨ç¤ºç”¨
  completedAt           DateTime? // endDateè¡¨ç¤ºç”¨
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  // === Phase 2: ãƒ¬ãƒ™ãƒ«ãƒ»æ‰¿èªãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===
  isEmergencyEscalated  Boolean   @default(false)
  escalatedBy           String?
  escalatedDate         DateTime?
  escalationReason      String?
  projectLevel          String?   // DEPARTMENT/FACILITY/CORPORATE/EMERGENCY
  approvalStatus        String    @default("pending")
  currentApprover       String?
  facilityId            String?   // æ–½è¨­IDï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
  facilityName          String?   // æ–½è¨­åï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

  // === Relations ===
  proposer              User      @relation("ProposedProjects", fields: [proposerId], references: [id])
  escalator             User?     @relation("ProjectEscalator", fields: [escalatedBy], references: [id])
  approver              User?     @relation("ProjectCurrentApprover", fields: [currentApprover], references: [id])
  teamMembers           ProjectTeamMember[]

  // === Indexes ===
  @@index([proposerId])
  @@index([status])
  @@index([category])
  @@index([isEmergencyEscalated])
  @@index([projectLevel])
  @@index([approvalStatus])
  @@index([facilityId])
  @@index([createdAt])
}
```

**è©•ä¾¡**: âœ… **ä¸è¶³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—**

---

### 2. ProjectTeamMemberãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå®Œå…¨å®Ÿè£…æ¸ˆã¿ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `prisma/schema.prisma` (lines 1866-1883)

```prisma
model ProjectTeamMember {
  id        String    @id @default(cuid())
  projectId String
  userId    String
  role      String    @default("member")  // owner/member
  joinedAt  DateTime  @default(now())
  leftAt    DateTime?  // NULL = ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ³ãƒãƒ¼
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // Relations
  project   Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)
  user      User      @relation(fields: [userId], references: [id])

  // Indexes
  @@unique([projectId, userId])
  @@index([projectId])
  @@index([userId])
  @@index([role])
  @@index([leftAt])
}
```

**ç”¨é€”**:
- å‚åŠ è€…æ•°é›†è¨ˆ: `COUNT(*) WHERE leftAt IS NULL`
- å½¹å‰²åˆ¤å®š: `role`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨`proposerId`ã®çµ„ã¿åˆã‚ã›
- ãƒ¬ãƒ™ãƒ«è¨ˆç®—: ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®éƒ¨ç½²ãƒ»æ–½è¨­åˆ†å¸ƒã‚’åˆ†æ

**è©•ä¾¡**: âœ… **ä¸è¶³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—**

---

### 3. é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆPhase 2ã§ä½¿ç”¨ï¼‰

#### 3.1 ProjectApprovalï¼ˆæ‰¿èªå±¥æ­´ï¼‰
```prisma
model ProjectApproval {
  id              String    @id @default(cuid())
  projectId       String
  requesterId     String
  approverId      String
  approverLevel   String    // DEPARTMENT_HEAD/FACILITY_HEADç­‰
  status          String    // pending/approved/rejected
  comment         String?
  approvedAt      DateTime?
  createdAt       DateTime  @default(now())

  @@index([projectId])
  @@index([approverId])
  @@index([status])
}
```

#### 3.2 ProjectLevelHistoryï¼ˆãƒ¬ãƒ™ãƒ«å¤‰æ›´å±¥æ­´ï¼‰
```prisma
model ProjectLevelHistory {
  id              String    @id @default(cuid())
  projectId       String
  previousLevel   String?
  newLevel        String
  changedBy       String?
  reason          String?
  changedAt       DateTime  @default(now())

  @@index([projectId])
}
```

#### 3.3 EmergencyDeactivationï¼ˆã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è§£é™¤å±¥æ­´ï¼‰
```prisma
model EmergencyDeactivation {
  id              String    @id @default(cuid())
  projectId       String
  deescalatedBy   String
  reason          String?
  deescalatedAt   DateTime  @default(now())

  @@index([projectId])
}
```

**è©•ä¾¡**: âœ… **Phase 2ã§ä½¿ç”¨ä¸­**

---

### 4. ProjectSummaryãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆPhase 3ãƒ»æœªå®Ÿè£…ï¼‰

```prisma
model ProjectSummary {
  id                  String    @id @default(cuid())
  projectId           String    @unique
  totalParticipants   Int       @default(0)
  activeParticipants  Int       @default(0)
  ownerCount          Int       @default(0)
  memberCount         Int       @default(0)
  lastCalculatedAt    DateTime  @default(now())
  updatedAt           DateTime  @updatedAt

  project             Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([totalParticipants])
  @@index([activeParticipants])
}
```

**çŠ¶æ…‹**: ğŸŸ¡ ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿ã€ãƒ‡ãƒ¼ã‚¿æŠ•å…¥å¾…ã¡
**ç”¨é€”**: å‚åŠ è€…æ•°ã®äº‹å‰é›†è¨ˆï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰

---

## ğŸ”— ã‚µãƒ¼ãƒ“ã‚¹å±¤å®Ÿè£…çŠ¶æ³

### å®Ÿè£…æ¸ˆã¿ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ï¼ˆ6ã‚µãƒ¼ãƒ“ã‚¹ï¼‰

#### 1. ProjectListService.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/ProjectListService.ts` (368è¡Œ)

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§å–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¯¾å¿œï¼‰
getProjectList(filters: ProjectListFilters, currentUserId: string): Promise<ProjectListItem[]>

// ãƒ¦ãƒ¼ã‚¶ãƒ¼çµ±è¨ˆå–å¾—
getProjectStats(currentUserId: string): Promise<ProjectStats>

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°å–å¾—
getProjectWithDetails(projectId: string, currentUserId: string): Promise<ProjectWithDetails | null>

// ç°¡æ˜“æ¤œç´¢
searchProjects(searchTerm: string, limit?: number): Promise<Array<{id, title, description}>>
```

**ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**:
```
ProjectListPage
  â†“
getProjectList(filters, userId)
  â†“
ä¸¦åˆ—å–å¾—:
  - Projectãƒ†ãƒ¼ãƒ–ãƒ«ã‚¯ã‚¨ãƒªï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ï¼‰
  - getUserProjectRoles(userId, projectIds)  â† å½¹å‰²åˆ¤å®š
  - getFacilitiesFromDepartments(departments) â† æ–½è¨­åå–å¾—
  â†“
ãƒ‡ãƒ¼ã‚¿çµ±åˆ â†’ ProjectListItem[]
```

---

#### 2. ProjectRoleService.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/ProjectRoleService.ts`

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// å˜ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å½¹å‰²åˆ¤å®š
getUserProjectRole(userId: string, projectId: string): Promise<'owner' | 'participant' | 'viewer'>

// è¤‡æ•°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å½¹å‰²ã‚’ä¸€æ‹¬å–å¾—ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰
getUserProjectRoles(userId: string, projectIds: string[]): Promise<Record<string, ProjectRole>>

// å‚åŠ è€…æ•°ã‚’ä¸€æ‹¬å–å¾—
getProjectParticipantCounts(projectIds: string[]): Promise<Record<string, number>>
```

**å½¹å‰²åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**:
1. `proposerId === userId` â†’ `owner`
2. `ProjectTeamMember.role === 'owner'` â†’ `owner`
3. `ProjectTeamMember.role === 'member'` and `leftAt === null` â†’ `participant`
4. ãã®ä»– â†’ `viewer`

---

#### 3. MedicalSystemService.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/MedicalSystemService.ts`

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// éƒ¨ç½²åã‹ã‚‰æ–½è¨­åã‚’ä¸€æ‹¬å–å¾—ï¼ˆ24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
getFacilitiesFromDepartments(departments: string[]): Promise<Record<string, string>>
```

**å®Ÿè£…è©³ç´°**:
- åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ API `GET /api/v2/departments` ã‚’å‘¼ã³å‡ºã—
- 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆNext.js unstable_cacheä½¿ç”¨ï¼‰
- Rate Limitå¯¾ç­–ï¼ˆ100 req/min/IPï¼‰

---

#### 4. ProjectLevelEngine.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/ProjectLevelEngine.ts` (344è¡Œ)

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«è‡ªå‹•è¨ˆç®—
calculateProjectLevel(projectId: string): Promise<ProjectLevelResult>

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«DBæ›´æ–°
updateProjectLevel(projectId: string): Promise<void>

// ãƒ¬ãƒ™ãƒ«å¤‰æ›´å±¥æ­´è¨˜éŒ²
trackLevelChange(projectId, previousLevel, newLevel, reason?): Promise<void>

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
getLevelLabel(level: ProjectLevel): string  // "éƒ¨ç½²ãƒ¬ãƒ™ãƒ«"ç­‰
getLevelIcon(level: ProjectLevel): string   // "ğŸ¢"ç­‰
getProjectLevelStats(userId?: string): Promise<ProjectLevelStats>
```

**ãƒ¬ãƒ™ãƒ«åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**:
1. `isEmergencyEscalated === true` â†’ `EMERGENCY`
2. è¤‡æ•°æ–½è¨­ã«ã¾ãŸãŒã‚‹ â†’ `CORPORATE`
3. å˜ä¸€æ–½è¨­ãƒ»è¤‡æ•°éƒ¨ç½² â†’ `FACILITY`
4. å˜ä¸€éƒ¨ç½² â†’ `DEPARTMENT`

---

#### 5. ProjectApprovalService.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/ProjectApprovalService.ts` (380è¡Œ)

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// æ‰¿èªæƒ…å ±å–å¾—
getProjectApprovalInfo(projectId, currentUserId): Promise<ProjectApprovalInfo>

// æ‰¿èªãƒªã‚¯ã‚¨ã‚¹ãƒˆä½œæˆ
createApprovalRequest(projectId, requesterId): Promise<ProjectApprovalInfo>

// æ‰¿èªå‡¦ç†
processApproval(projectId, approverId, action, comment?): Promise<ProjectApprovalInfo>

// çµ±è¨ˆ
getPendingApprovalsCount(approverId): Promise<number>
getPendingApprovals(approverId): Promise<ProjectApprovalInfo[]>
getApprovalStats(userId): Promise<ApprovalStats>

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
getApprovalStatusLabel(status: ApprovalStatus): string
```

**æ‰¿èªãƒ•ãƒ­ãƒ¼**:
| ãƒ¬ãƒ™ãƒ« | æ‰¿èªè€… | æ®µéš |
|--------|--------|------|
| DEPARTMENT | éƒ¨ç½²é•· | 1æ®µéš |
| FACILITY | éƒ¨ç½²é•· â†’ æ–½è¨­é•· | 2æ®µéš |
| CORPORATE | æ–½è¨­é•· â†’ äººäº‹éƒ¨é•· â†’ å½¹å“¡ | 3æ®µéš |
| EMERGENCY | å½¹å“¡ â†’ ç†äº‹é•· | 2æ®µéš |

---

#### 6. ProjectEscalationService.ts âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `src/services/ProjectEscalationService.ts` (403è¡Œ)

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
// ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—
getEscalationInfo(projectId, currentUserId): Promise<EscalationInfo>

// ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
escalateProject(request: EscalationRequest): Promise<EscalationInfo>

// ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è§£é™¤
deescalateProject(request: DeescalationRequest): Promise<EscalationInfo>

// çµ±è¨ˆ
getEscalatedProjects(filters): Promise<EscalationInfo[]>
getEscalationStats(userId?): Promise<EscalationStats>
```

**æ¨©é™ç®¡ç†**:
- ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ: æ–½è¨­é•·ä»¥ä¸Š
- ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è§£é™¤: å½¹å“¡ä»¥ä¸Šã®ã¿

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å…¨ä½“å›³

### Phase 1-2: ç¾åœ¨ã®å®Ÿè£…ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant User
    participant Page as ProjectListPage
    participant ListService as ProjectListService
    participant RoleService as ProjectRoleService
    participant MedicalService as MedicalSystemService
    participant LevelEngine as ProjectLevelEngine
    participant DB as VoiceDrive DB
    participant API as Medical System API

    User->>Page: ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆ/projectsï¼‰
    Page->>Page: URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£æ

    par çµ±è¨ˆå–å¾—
        Page->>ListService: getProjectStats(userId)
        ListService->>DB: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°é›†è¨ˆ
        DB-->>ListService: çµ±è¨ˆãƒ‡ãƒ¼ã‚¿
        ListService-->>Page: ProjectStats
    and ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§å–å¾—
        Page->>ListService: getProjectList(filters, userId)
        ListService->>DB: Projectãƒ†ãƒ¼ãƒ–ãƒ«ã‚¯ã‚¨ãƒª
        DB-->>ListService: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—

        par å½¹å‰²åˆ¤å®š
            ListService->>RoleService: getUserProjectRoles(userId, projectIds)
            RoleService->>DB: ProjectTeamMemberã‚¯ã‚¨ãƒª
            DB-->>RoleService: å½¹å‰²æƒ…å ±
            RoleService-->>ListService: roleMap
        and æ–½è¨­åå–å¾—
            ListService->>MedicalService: getFacilitiesFromDepartments(departments)
            MedicalService->>MedicalService: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèªï¼ˆ24æ™‚é–“ï¼‰
            alt ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ
                MedicalService-->>ListService: facilityMap
            else ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹
                MedicalService->>API: GET /api/v2/departments
                API-->>MedicalService: éƒ¨ç½²ãƒã‚¹ã‚¿
                MedicalService->>MedicalService: 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
                MedicalService-->>ListService: facilityMap
            end
        end

        ListService->>ListService: ãƒ‡ãƒ¼ã‚¿çµ±åˆ
        ListService-->>Page: ProjectListItem[]
    end

    Page-->>User: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤º
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚«ã‚¿ãƒ­ã‚°ï¼ˆ47é …ç›®ï¼‰

### ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ‡ãƒ¼ã‚¿é …ç›®ä¸€è¦§

#### 1. åŸºæœ¬æƒ…å ±ï¼ˆ9é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `id` | string | Project.id | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID |
| `title` | string | Project.title | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå |
| `description` | string | Project.description | èª¬æ˜æ–‡ |
| `status` | enum | Project.status | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆproposed/active/completed/pausedï¼‰ |
| `category` | enum | Project.category | ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆimprovement/community/facility/systemï¼‰ |
| `priority` | enum? | Project.priority | å„ªå…ˆåº¦ï¼ˆhigh/medium/low/urgentï¼‰ |
| `progress` | number | Project.progressRate | é€²æ—ç‡ï¼ˆ0-100ï¼‰ |
| `startDate` | string? | Project.startedAt | é–‹å§‹æ—¥ |
| `endDate` | string? | Project.completedAt | å®Œäº†æ—¥ |

#### 2. ãƒãƒ¼ãƒ æƒ…å ±ï¼ˆ2é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `participants` | number | COUNT(ProjectTeamMember) | å‚åŠ è€…æ•°ï¼ˆé›†è¨ˆï¼‰ |
| `myRole` | enum | ProjectRoleService | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å½¹å‰²ï¼ˆowner/participant/viewerï¼‰ |

#### 3. çµ„ç¹”æƒ…å ±ï¼ˆ2é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `department` | string | User.department | ææ¡ˆè€…ã®éƒ¨ç½²å |
| `facility` | string | MedicalSystemService | æ–½è¨­åï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIï¼‰ |

#### 4. Phase 2æ‹¡å¼µï¼ˆ6é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `projectLevel` | string? | Project.projectLevel | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ï¼ˆDEPARTMENT/FACILITY/CORPORATE/EMERGENCYï¼‰ |
| `isEmergencyEscalated` | boolean | Project.isEmergencyEscalated | ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æœ‰ç„¡ |
| `escalatedBy` | string? | Project.escalatedBy | ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œè€…ID |
| `escalatedDate` | string? | Project.escalatedDate | ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ—¥æ™‚ |
| `approvalStatus` | string | Project.approvalStatus | æ‰¿èªçŠ¶æ…‹ï¼ˆpending/in_review/approved/rejectedï¼‰ |
| `currentApprover` | string? | Project.currentApprover | ç¾åœ¨ã®æ‰¿èªè€…ID |

#### 5. çµ±è¨ˆã‚µãƒãƒªãƒ¼ï¼ˆ4é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `stats.active` | number | COUNT(Project) | å‚åŠ ä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° |
| `stats.completed` | number | COUNT(Project) | å®Œäº†æ¸ˆã¿ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° |
| `stats.proposed` | number | COUNT(Project) | ææ¡ˆä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° |
| `stats.owned` | number | COUNT(Project) | ã‚ªãƒ¼ãƒŠãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° |

#### 6. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆ4é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `searchTerm` | string | React state | æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ |
| `filterStatus` | enum | React state | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ |
| `filterCategory` | enum | React state | ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ |
| `filterLevel` | enum | React state | ãƒ¬ãƒ™ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ |

#### 7. UIçŠ¶æ…‹ï¼ˆ3é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `loading` | boolean | React state | èª­ã¿è¾¼ã¿ä¸­ãƒ•ãƒ©ã‚° |
| `error` | string? | React state | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| `projects` | array | React state | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§é…åˆ— |

#### 8. å†…éƒ¨ç®¡ç†ç”¨ï¼ˆ17é …ç›®ï¼‰
| é …ç›®å | å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|--------|---|------------|------|
| `proposerId` | string | Project.proposerId | ææ¡ˆè€…ID |
| `createdAt` | DateTime | Project.createdAt | ä½œæˆæ—¥æ™‚ |
| `updatedAt` | DateTime | Project.updatedAt | æ›´æ–°æ—¥æ™‚ |
| `escalationReason` | string? | Project.escalationReason | ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç†ç”± |
| `facilityId` | string? | Project.facilityId | æ–½è¨­IDï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ |
| `facilityName` | string? | Project.facilityName | æ–½è¨­åï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ |
| ãã®ä»– | - | - | 11é …ç›®ï¼ˆProjectTeamMemberã€æ‰¿èªå±¥æ­´ç­‰ï¼‰ |

---

## âœ… å®Ÿè£…å®Œäº†åº¦ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: åŸºæœ¬æ©Ÿèƒ½ï¼ˆâœ… 100%å®Œäº†ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [x] Projectãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª
- [x] ProjectTeamMemberãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª
- [x] å…¨å¿…è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å­˜åœ¨ç¢ºèª

#### ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…
- [x] ProjectListService.tså®Ÿè£…
  - [x] getProjectList()å®Ÿè£…
  - [x] getProjectStats()å®Ÿè£…
  - [x] getProjectWithDetails()å®Ÿè£…
  - [x] searchProjects()å®Ÿè£…
- [x] ProjectRoleService.tså®Ÿè£…
  - [x] getUserProjectRole()å®Ÿè£…
  - [x] getUserProjectRoles()å®Ÿè£…
  - [x] getProjectParticipantCounts()å®Ÿè£…
- [x] MedicalSystemService.tså®Ÿè£…
  - [x] getFacilitiesFromDepartments()å®Ÿè£…
  - [x] 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®Ÿè£…

#### ãƒšãƒ¼ã‚¸å®Ÿè£…
- [x] ProjectListPage.tsxå®Ÿè£…
  - [x] URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£æ
  - [x] æ¤œç´¢æ©Ÿèƒ½å®Ÿè£…
  - [x] 4ã¤ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å®Ÿè£…
  - [x] çµ±è¨ˆã‚µãƒãƒªãƒ¼è¡¨ç¤º
  - [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚«ãƒ¼ãƒ‰è¡¨ç¤º
  - [x] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹è¡¨ç¤º

#### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æº
- [x] éƒ¨ç½²ãƒã‚¹ã‚¿APIçµ±åˆ
- [x] API Keyèªè¨¼è¨­å®š
- [x] Rate Limitå¯¾ç­–ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

---

### Phase 2: ãƒ¬ãƒ™ãƒ«ãƒ»æ‰¿èªæ©Ÿèƒ½ï¼ˆâœ… 100%å®Œäº†ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [x] Projectãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - [x] isEmergencyEscalated
  - [x] escalatedBy
  - [x] escalatedDate
  - [x] escalationReason
  - [x] projectLevel
  - [x] approvalStatus
  - [x] currentApprover
  - [x] facilityId
  - [x] facilityName
- [x] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
- [x] ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆescalator, approverï¼‰

#### ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…
- [x] ProjectLevelEngine.tså®Ÿè£…ï¼ˆ344è¡Œï¼‰
  - [x] calculateProjectLevel()å®Ÿè£…
  - [x] updateProjectLevel()å®Ÿè£…
  - [x] trackLevelChange()å®Ÿè£…
  - [x] getLevelLabel()å®Ÿè£…
  - [x] getLevelIcon()å®Ÿè£…
  - [x] getProjectLevelStats()å®Ÿè£…
- [x] ProjectApprovalService.tså®Ÿè£…ï¼ˆ380è¡Œï¼‰
  - [x] getProjectApprovalInfo()å®Ÿè£…
  - [x] createApprovalRequest()å®Ÿè£…
  - [x] processApproval()å®Ÿè£…
  - [x] getPendingApprovalsCount()å®Ÿè£…
  - [x] getPendingApprovals()å®Ÿè£…
  - [x] getApprovalStats()å®Ÿè£…
- [x] ProjectEscalationService.tså®Ÿè£…ï¼ˆ403è¡Œï¼‰
  - [x] getEscalationInfo()å®Ÿè£…
  - [x] escalateProject()å®Ÿè£…
  - [x] deescalateProject()å®Ÿè£…
  - [x] getEscalatedProjects()å®Ÿè£…
  - [x] getEscalationStats()å®Ÿè£…

#### ãƒšãƒ¼ã‚¸å®Ÿè£…
- [x] ProjectListPage.tsxæ‹¡å¼µ
  - [x] ãƒ¬ãƒ™ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å®Ÿè£…
  - [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«è¡¨ç¤ºï¼ˆã‚¢ã‚¤ã‚³ãƒ³ä»˜ãï¼‰
  - [x] æ‰¿èªçŠ¶æ…‹ãƒãƒƒã‚¸è¡¨ç¤º
  - [x] ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º

---

### Phase 3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆğŸŸ¡ 20%å®Œäº†ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [ ] ProjectSummaryãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
  - [x] ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿
  - [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
  - [ ] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 

#### ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…
- [ ] ProjectSummaryService.tså®Ÿè£…
  - [ ] calculateProjectSummary()å®Ÿè£…
  - [ ] calculateAllProjectSummaries()å®Ÿè£…ï¼ˆæ—¥æ¬¡ãƒãƒƒãƒï¼‰
- [ ] ProjectListService.tsæœ€é©åŒ–
  - [ ] ProjectSummaryå„ªå…ˆå–å¾—
  - [ ] ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—ï¼‰

#### ãƒãƒƒãƒå‡¦ç†
- [ ] æ—¥æ¬¡ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- [ ] cronè¨­å®š
- [ ] ãƒãƒƒãƒå®Ÿè¡Œãƒ­ã‚°
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## ğŸ”´ ä¸è¶³é …ç›®ãƒ»ã‚®ãƒ£ãƒƒãƒ—åˆ†æ

### çµè«–: **ä¸è¶³é …ç›®ãªã—**

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
âœ… **å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®Ÿè£…æ¸ˆã¿**
- Projectãƒ†ãƒ¼ãƒ–ãƒ«: å…¨19ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å­˜åœ¨
- ProjectTeamMemberãƒ†ãƒ¼ãƒ–ãƒ«: å…¨8ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å­˜åœ¨
- é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«: ProjectApproval, ProjectLevelHistory, EmergencyDeactivationå…¨ã¦å­˜åœ¨

#### ã‚µãƒ¼ãƒ“ã‚¹å±¤
âœ… **å…¨ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…æ¸ˆã¿**
- ProjectListService: å®Œå…¨å®Ÿè£…
- ProjectRoleService: å®Œå…¨å®Ÿè£…
- MedicalSystemService: å®Œå…¨å®Ÿè£…
- ProjectLevelEngine: å®Œå…¨å®Ÿè£…
- ProjectApprovalService: å®Œå…¨å®Ÿè£…
- ProjectEscalationService: å®Œå…¨å®Ÿè£…

#### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIé€£æº
âœ… **å®Œå…¨çµ±åˆæ¸ˆã¿**
- éƒ¨ç½²ãƒã‚¹ã‚¿API: çµ±åˆæ¸ˆã¿
- 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥: å®Ÿè£…æ¸ˆã¿
- Rate Limitå¯¾ç­–: å®Œäº†

#### UIå®Ÿè£…
âœ… **å®Œå…¨å®Ÿè£…æ¸ˆã¿**
- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: å®Œå…¨å®Ÿè£…
- çµ±è¨ˆã‚µãƒãƒªãƒ¼: å®Œå…¨å®Ÿè£…
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚«ãƒ¼ãƒ‰: å®Œå…¨å®Ÿè£…
- ãƒ¬ãƒ™ãƒ«ãƒ»æ‰¿èªè¡¨ç¤º: å®Œå…¨å®Ÿè£…

---

## ğŸ¯ Phase 3å®Ÿè£…æ¨å¥¨äº‹é …

### Phase 3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**ç›®çš„**: 1000+ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦æ¨¡ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

#### 1. ProjectSummaryãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```bash
# Prismaãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
npx prisma migrate dev --name add_project_summary_table
npx prisma generate
```

#### 2. æ—¥æ¬¡ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè£…
```typescript
// src/jobs/calculateProjectSummary.ts
export async function calculateAllProjectSummaries() {
  const projects = await prisma.project.findMany();

  for (const project of projects) {
    const teamMembers = await prisma.projectTeamMember.findMany({
      where: { projectId: project.id }
    });

    const totalParticipants = teamMembers.length + 1; // +1 for proposer
    const activeParticipants = teamMembers.filter(m => m.leftAt === null).length + 1;
    const ownerCount = teamMembers.filter(m => m.role === 'owner').length;
    const memberCount = teamMembers.filter(m => m.role === 'member').length;

    await prisma.projectSummary.upsert({
      where: { projectId: project.id },
      create: {
        projectId: project.id,
        totalParticipants,
        activeParticipants,
        ownerCount,
        memberCount,
        lastCalculatedAt: new Date()
      },
      update: {
        totalParticipants,
        activeParticipants,
        ownerCount,
        memberCount,
        lastCalculatedAt: new Date()
      }
    });
  }
}
```

#### 3. ProjectListServiceã®æœ€é©åŒ–
```typescript
// src/services/ProjectListService.ts
export async function getProjectList(
  filters: ProjectListFilters,
  currentUserId: string
): Promise<ProjectListItem[]> {
  // ... æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå–å¾—ãƒ­ã‚¸ãƒƒã‚¯

  // Phase 3: ProjectSummaryã‚’å„ªå…ˆçš„ã«ä½¿ç”¨
  const summaryMap = await getMultipleProjectSummaries(projectIds); // ã‚­ãƒ£ãƒƒã‚·ãƒ¥å„ªå…ˆ

  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚µãƒãƒªãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—
  const participantCountMap: Record<string, number> = {};
  projectIds.forEach((id: string) => {
    participantCountMap[id] = summaryMap[id]?.activeParticipants || 1;
  });

  // ...
}
```

**æ¨å®šå·¥æ•°**: 2-3æ—¥

---

## ğŸ“ ã¾ã¨ã‚

### ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»ã®æœ€çµ‚ç¢ºèª

#### VoiceDriveå´ï¼ˆ100%ç®¡ç†ï¼‰
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºæœ¬æƒ…å ±
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«
- âœ… æ‰¿èªçŠ¶æ…‹ãƒ»æ‰¿èªå±¥æ­´
- âœ… ç·Šæ€¥ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†
- âœ… å‚åŠ è€…æ•°é›†è¨ˆ
- âœ… é€²æ—ç®¡ç†

#### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ï¼ˆAPIã®ã¿æä¾›ï¼‰
- âœ… éƒ¨ç½²ãƒã‚¹ã‚¿APIï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- âœ… æ–½è¨­ãƒã‚¹ã‚¿APIï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- âŒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ãªã—

### å®Ÿè£…å®Œäº†åº¦

| Phase | å®Œäº†åº¦ | çŠ¶æ…‹ |
|-------|--------|------|
| Phase 1: åŸºæœ¬æ©Ÿèƒ½ | 100% | âœ… å®Œäº† |
| Phase 2: ãƒ¬ãƒ™ãƒ«ãƒ»æ‰¿èª | 100% | âœ… å®Œäº† |
| Phase 3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | 20% | ğŸŸ¡ ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿ |

### schema.prismaæ›´æ–°ã®å¿…è¦æ€§

**çµè«–**: âŒ **æ›´æ–°ä¸è¦**

å…¨ã¦ã®å¿…è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ—¢ã«å­˜åœ¨ã—ã¦ãŠã‚Šã€schema.prismaã®æ›´æ–°ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

Phase 3å®Ÿè£…æ™‚ã«ProjectSummaryãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¯æ—¢ã«å®Œäº†ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

1. [Projectsæš«å®šãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆ_20251026.md](./Projectsæš«å®šãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆ_20251026.md) - ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚«ã‚¿ãƒ­ã‚°
2. [ProjectListPage_DBè¦ä»¶åˆ†æ_20251026.md](./ProjectListPage_DBè¦ä»¶åˆ†æ_20251026.md) - è­°é¡Œãƒ¢ãƒ¼ãƒ‰åˆ†æï¼ˆå‚è€ƒï¼‰
3. [ProjectListPage_åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ç¢ºèªçµæœ_20251026.md](./ProjectListPage_åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ç¢ºèªçµæœ_20251026.md) - åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIç¢ºèªçµæœ
4. [ProjectListPage_Phase2å®Ÿè£…å®Œäº†å ±å‘Š_20251026.md](./ProjectListPage_Phase2å®Ÿè£…å®Œäº†å ±å‘Š_20251026.md) - Phase 2å®Ÿè£…å ±å‘Š
5. [ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»åˆ†ç•Œç‚¹å®šç¾©æ›¸_20251008.md](./ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»åˆ†ç•Œç‚¹å®šç¾©æ›¸_20251008.md) - ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»ã®å®šç¾©

---

**æ–‡æ›¸çµ‚äº†**

æœ€çµ‚æ›´æ–°: 2025å¹´10æœˆ26æ—¥
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0
æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼: Phase 3å®Ÿè£…é–‹å§‹æ™‚
