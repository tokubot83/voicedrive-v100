# è­°é¡Œãƒ¢ãƒ¼ãƒ‰å®Ÿè£…å®Œäº†å ±å‘Š

**ä½œæˆæ—¥**: 2025å¹´10æœˆ19æ—¥
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ï¼ˆãƒ†ã‚¹ãƒˆå¾…ã¡ï¼‰

---

## 1. å®Ÿè£…æ¦‚è¦

è­°é¡Œãƒ¢ãƒ¼ãƒ‰ï¼ˆéƒ¨ç½²è­°é¡Œãƒ¢ãƒ¼ãƒ‰ï½æ³•äººè­°é¡Œãƒ¢ãƒ¼ãƒ‰ï¼‰ã®å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸã€‚

### å®Ÿè£…ç¯„å›²

- âœ… **30ç‚¹**: ä¸»ä»»ãƒ»å¸«é•·ã¸ã®æ—©æœŸé€šçŸ¥
- âœ… **50ç‚¹**: ä¸»ä»»æ¨è–¦ â†’ å¸«é•·æ‰¿èªã®2æ®µéšãƒ•ãƒ­ãƒ¼
- âœ… **100ç‚¹**: å‰¯çœ‹è­·éƒ¨é•·åˆ¤æ–­ï¼ˆå§”å“¡ä¼šæå‡º/æ³•äººæ¤œè¨æ˜‡æ ¼/å´ä¸‹ï¼‰
- âœ… **300ç‚¹**: äº‹å‹™é•·åˆ¤æ–­ï¼ˆæ³•äººè­°é¡Œæ‰¿èª/600ç‚¹ç›®æ¨™æ˜‡æ ¼/å´ä¸‹ï¼‰
- âœ… **600ç‚¹**: æ³•äººçµ±æ‹¬äº‹å‹™å±€é•·åˆ¤æ–­ï¼ˆæ³•äººé‹å–¶ä¼šè­°æå‡º/å´ä¸‹ï¼‰
- âœ… **æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼**: ä¸Šä½ãƒ¬ãƒ™ãƒ«å´ä¸‹æ™‚ã®ä¸‹ä½ãƒ¬ãƒ™ãƒ«æ•‘æ¸ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³

---

## 2. å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

#### 2.1 Prisma Schemaæ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `prisma/schema.prisma`

```prisma
// ğŸ†• è­°é¡Œãƒ¢ãƒ¼ãƒ‰ç®¡ç†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
agendaStatus                 String?   @default("pending") @map("agenda_status")
agendaDecisionBy             String?   @map("agenda_decision_by")
agendaDecisionAt             DateTime? @map("agenda_decision_at")
agendaDecisionReason         String?   @map("agenda_decision_reason")
agendaRescueLevel            Int?      @map("agenda_rescue_level")
agendaVotingDeadline         DateTime? @map("agenda_voting_deadline")
```

**ç›®çš„**: æŠ•ç¨¿ãƒ†ãƒ¼ãƒ–ãƒ«ã«è­°é¡Œãƒ¢ãƒ¼ãƒ‰ã®è©³ç´°çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 

---

#### 2.2 AgendaDecisionService

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/AgendaDecisionService.ts` (æ–°è¦ä½œæˆ)

**ä¸»ãªæ©Ÿèƒ½**:
- å„ãƒ¬ãƒ™ãƒ«ï¼ˆ3.5, 7, 8, 11, 18ï¼‰ã®åˆ¤æ–­å‡¦ç†ã‚’çµ±åˆç®¡ç†
- æ‰¿èª/å´ä¸‹/æ˜‡æ ¼ã®åˆ¤æ–­ã‚¿ã‚¤ãƒ—ã‚’17ç¨®é¡å®šç¾©
- æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼å‡¦ç†ã‚’å®Ÿè£…
- é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®çµ±åˆ

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```typescript
async executeDecision(input: AgendaDecisionInput): Promise<AgendaDecisionResult>

// Level 3.5
- handleRecommendToManager()
- handleRejectBySupervisor()

// Level 7
- handleApproveAsDeptAgenda()
- handleEscalateToFacility()
- handleRejectByManager()
- handleRescueAsDeptAgenda() // æ•‘æ¸ˆ
- handleCompleteRejection()

// Level 8
- handleApproveForCommittee()
- handleEscalateToCorpReview()
- handleRejectByDeputyDirector()

// Level 11
- handleApproveAsCorpAgenda()
- handleEscalateToCorpAgenda()
- handleRejectByGeneralAffairs()
- handleRescueAsFacilityAgenda() // æ•‘æ¸ˆ

// Level 18
- handleApproveForCorpMeeting()
- handleRejectByGeneralAffairsDirector()
```

---

#### 2.3 AgendaLevelNotificationServiceæ‹¡å¼µ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/AgendaLevelNotificationService.ts` (æ‹¡å¼µ)

**è¿½åŠ ãƒ¡ã‚½ãƒƒãƒ‰**: 17å€‹ã®é€šçŸ¥ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 

ä¸»ãªé€šçŸ¥å…ˆ:
- **æŠ•ç¨¿è€…**: å…¨ã¦ã®åˆ¤æ–­çµæœ
- **ä¸»ä»»/å¸«é•·**: æ¨è–¦ãƒ»æ‰¿èªè¦æ±‚
- **éƒ¨ç½²å†…å…¨å“¡**: éƒ¨ç½²è­°é¡Œæ‰¿èª/å´ä¸‹
- **æ–½è¨­å†…å…¨å“¡**: æ–½è¨­è­°é¡Œæ˜‡æ ¼/æ³•äººæ¤œè¨æ˜‡æ ¼
- **æ³•äººå†…å…¨å“¡**: æ³•äººè­°é¡Œæ‰¿èªï¼ˆ600ç‚¹ï¼‰

**æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼é€šçŸ¥**:
```typescript
async notifyDeputyDirectorRejection()  // â†’ å¸«é•·ã«æ•‘æ¸ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥
async notifyGeneralAffairsRejection()  // â†’ å‰¯çœ‹è­·éƒ¨é•·ã«æ•‘æ¸ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥
async notifyGeneralAffairsDirectorRejection() // â†’ äº‹å‹™é•·ã«æ•‘æ¸ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥
```

---

#### 2.4 APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/pages/api/agenda/decision.ts` (æ–°è¦ä½œæˆ)

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `POST /api/agenda/decision`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
{
  postId: string;
  decisionType: AgendaDecisionType;
  deciderId: string;
  reason: string;
  committeeId?: string; // Level 8æ‰¿èªæ™‚ã®ã¿
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
{
  success: boolean;
  message: string;
  post?: any;
  notificationsSent?: number;
}
```

---

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

#### 2.5 AgendaDecisionModal

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/components/agenda/AgendaDecisionModal.tsx` (æ–°è¦ä½œæˆ)

**æ©Ÿèƒ½**:
- åˆ¤æ–­ç†ç”±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
- å§”å“¡ä¼šé¸æŠï¼ˆLevel 8æ‰¿èªæ™‚ï¼‰
- æ˜‡æ ¼æ™‚ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
- åˆ¤æ–­ã‚¿ã‚¤ãƒ—ã”ã¨ã®è‰²åˆ†ã‘ï¼ˆç·‘/é’/èµ¤ï¼‰

**è¡¨ç¤ºå†…å®¹**:
- æŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«
- åˆ¤æ–­ç†ç”±å…¥åŠ›æ¬„ï¼ˆå¿…é ˆï¼‰
- å§”å“¡ä¼šé¸æŠï¼ˆLevel 8ã®ã¿ï¼‰
- æ˜‡æ ¼æ™‚ã®è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

---

#### 2.6 AgendaDecisionButtons

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/components/agenda/AgendaDecisionButtons.tsx` (æ–°è¦ä½œæˆ)

**æ©Ÿèƒ½**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¬ãƒ™ãƒ«ã¨ã‚¹ã‚³ã‚¢ã«å¿œã˜ã¦é©åˆ‡ãªãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
- ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºåˆ¶å¾¡
- APIå‘¼ã³å‡ºã—å‡¦ç†

**ãƒœã‚¿ãƒ³è¡¨ç¤ºæ¡ä»¶**:

| ãƒ¬ãƒ™ãƒ« | ã‚¹ã‚³ã‚¢ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ãƒœã‚¿ãƒ³ |
|--------|--------|-----------|--------|
| 3.5 | 50+ | pending | âœ… å¸«é•·ã«æ¨è–¦ / âŒ å´ä¸‹ |
| 7 | - | recommended_to_manager | âœ… éƒ¨ç½²è­°é¡Œæ‰¿èª / â¬†ï¸ æ–½è¨­è­°é¡Œæ˜‡æ ¼ / âŒ å´ä¸‹ |
| 7 | - | pending_rescue_by_manager | âœ… éƒ¨ç½²è­°é¡Œæ‰¿èª / âŒ å®Œå…¨å´ä¸‹ |
| 8 | 100+ | pending_deputy_director_review | âœ… å§”å“¡ä¼šæå‡º / â¬†ï¸ æ³•äººæ¤œè¨æ˜‡æ ¼ / âŒ å´ä¸‹ |
| 11 | 300+ | pending_general_affairs_review | âœ… æ³•äººè­°é¡Œæ‰¿èª / â¬†ï¸ 600ç‚¹ç›®æ¨™æ˜‡æ ¼ / âŒ å´ä¸‹ |
| 11 | - | pending_rescue_by_deputy_director | âœ… æ–½è¨­è­°é¡Œæ‰¿èª / âŒ å®Œå…¨å´ä¸‹ |
| 18 | 600+ | pending_general_affairs_director_review | âœ… æ³•äººé‹å–¶ä¼šè­°æå‡º / âŒ å´ä¸‹ |

---

## 3. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è©³ç´°

### 3.1 éƒ¨ç½²è­°é¡Œãƒ¬ãƒ™ãƒ«ï¼ˆ30-99ç‚¹ï¼‰

#### 30ç‚¹åˆ°é”

**è‡ªå‹•å‡¦ç†**:
- æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_supervisor_review`

**é€šçŸ¥å…ˆ**:
- ä¸»ä»»ï¼ˆLevel 3.5ï¼‰- æ—©æœŸè­¦å‘Š
- å¸«é•·ï¼ˆLevel 7ï¼‰- æ—©æœŸè­¦å‘Š
- æŠ•ç¨¿è€… - 30ç‚¹åˆ°é”ã®ãŠçŸ¥ã‚‰ã›

---

#### 50ç‚¹åˆ°é”

**è‡ªå‹•å‡¦ç†**:
- ä¸»ä»»ã«åˆ¤æ–­è¦æ±‚é€šçŸ¥

**ä¸»ä»»ã®é¸æŠè‚¢**:
1. **âœ… å¸«é•·ã«æ¨è–¦**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `recommended_to_manager`
   - é€šçŸ¥: æŠ•ç¨¿è€… + å¸«é•·

2. **âŒ å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected_by_supervisor`
   - æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected`
   - é€šçŸ¥: æŠ•ç¨¿è€…ã®ã¿

---

#### å¸«é•·ã®åˆ¤æ–­

**ä¸»ä»»æ¨è–¦å¾Œã®é¸æŠè‚¢**:

1. **âœ… éƒ¨ç½²è­°é¡Œæ‰¿èª**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_as_dept_agenda`
   - agendaLevel: `DEPT_AGENDA`
   - é€šçŸ¥: æŠ•ç¨¿è€… + éƒ¨ç½²å†…å…¨å“¡

2. **â¬†ï¸ æ–½è¨­è­°é¡Œã«æ˜‡æ ¼**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `escalated_to_facility`
   - agendaLevel: `FACILITY_AGENDA`
   - æŠ•ç¥¨æœŸé™: 60æ—¥å»¶é•·
   - å…¬é–‹ç¯„å›²: æ–½è¨­å†…å…¨è·å“¡
   - é€šçŸ¥: æŠ•ç¨¿è€… + ä¸»ä»» + Level 8 + æ–½è¨­å†…å…¨è·å“¡

3. **âŒ å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected_by_manager`
   - æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected`
   - é€šçŸ¥: æŠ•ç¨¿è€… + éƒ¨ç½²å†…å…¨å“¡ + æ–½è¨­å†…å…¨è·å“¡

---

### 3.2 æ–½è¨­è­°é¡Œãƒ¬ãƒ™ãƒ«ï¼ˆ100-299ç‚¹ï¼‰

#### 100ç‚¹åˆ°é”

**è‡ªå‹•å‡¦ç†**:
- æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_deputy_director_review`

**é€šçŸ¥å…ˆ**:
- å‰¯çœ‹è­·éƒ¨é•·ï¼ˆLevel 8ï¼‰- åˆ¤æ–­è¦æ±‚
- å¸«é•·ï¼ˆLevel 7ï¼‰- æƒ…å ±å…±æœ‰
- ä¸»ä»»ï¼ˆLevel 3.5ï¼‰- æƒ…å ±å…±æœ‰
- æŠ•ç¨¿è€… - 100ç‚¹åˆ°é”ã®ãŠçŸ¥ã‚‰ã›
- æ–½è¨­å†…å…¨è·å“¡ - æ–½è¨­è­°é¡Œåˆ°é”ã®ãŠçŸ¥ã‚‰ã›

---

#### å‰¯çœ‹è­·éƒ¨é•·ã®åˆ¤æ–­

**é¸æŠè‚¢**:

1. **âœ… å§”å“¡ä¼šæå‡ºæ‰¿èª**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_for_committee`
   - agendaLevel: `FACILITY_AGENDA`
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

2. **â¬†ï¸ æ³•äººæ¤œè¨ã«æ˜‡æ ¼ï¼ˆ300ç‚¹ç›®æ¨™ï¼‰**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `escalated_to_corp_review`
   - agendaLevel: `CORP_REVIEW`
   - æŠ•ç¥¨æœŸé™: 90æ—¥å»¶é•·
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

3. **âŒ å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_rescue_by_manager` (æ•‘æ¸ˆå¾…ã¡)
   - é€šçŸ¥: æŠ•ç¨¿è€… + å¸«é•·ï¼ˆæ•‘æ¸ˆåˆ¤æ–­è¦æ±‚ï¼‰

---

#### æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼ï¼ˆLevel 8å´ä¸‹å¾Œï¼‰

**å¸«é•·ã®é¸æŠè‚¢**:

1. **âœ… éƒ¨ç½²è­°é¡Œæ‰¿èªï¼ˆæ•‘æ¸ˆï¼‰**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_as_dept_agenda`
   - agendaLevel: `DEPT_AGENDA`
   - agendaRescueLevel: `7`
   - é€šçŸ¥: æŠ•ç¨¿è€… + éƒ¨ç½²å†…å…¨å“¡

2. **âŒ å®Œå…¨å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected_by_manager`
   - æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected`
   - é€šçŸ¥: æŠ•ç¨¿è€… + éƒ¨ç½²å†…å…¨å“¡

---

### 3.3 æ³•äººæ¤œè¨ãƒ¬ãƒ™ãƒ«ï¼ˆ300-599ç‚¹ï¼‰

#### 300ç‚¹åˆ°é”

**è‡ªå‹•å‡¦ç†**:
- æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_general_affairs_review`

**é€šçŸ¥å…ˆ**:
- äº‹å‹™é•·ï¼ˆLevel 11ï¼‰- åˆ¤æ–­è¦æ±‚
- å‰¯çœ‹è­·éƒ¨é•·ï¼ˆLevel 8ï¼‰- æƒ…å ±å…±æœ‰
- æŠ•ç¨¿è€… - 300ç‚¹åˆ°é”ã®ãŠçŸ¥ã‚‰ã›
- æ–½è¨­å†…å…¨è·å“¡ - æ³•äººæ¤œè¨åˆ°é”ã®ãŠçŸ¥ã‚‰ã›

---

#### äº‹å‹™é•·ã®åˆ¤æ–­

**é¸æŠè‚¢**:

1. **âœ… æ³•äººè­°é¡Œæ‰¿èª**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_as_corp_agenda`
   - agendaLevel: `CORP_AGENDA`
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

2. **â¬†ï¸ æ³•äººè­°é¡Œã«æ˜‡æ ¼ï¼ˆ600ç‚¹ç›®æ¨™ï¼‰**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `escalated_to_corp_agenda`
   - agendaLevel: `CORP_AGENDA`
   - æŠ•ç¥¨æœŸé™: 120æ—¥å»¶é•·
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

3. **âŒ å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_rescue_by_deputy_director` (æ•‘æ¸ˆå¾…ã¡)
   - é€šçŸ¥: æŠ•ç¨¿è€… + å‰¯çœ‹è­·éƒ¨é•·ï¼ˆæ•‘æ¸ˆåˆ¤æ–­è¦æ±‚ï¼‰

---

#### æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼ï¼ˆLevel 11å´ä¸‹å¾Œï¼‰

**å‰¯çœ‹è­·éƒ¨é•·ã®é¸æŠè‚¢**:

1. **âœ… æ–½è¨­è­°é¡Œæ‰¿èªï¼ˆæ•‘æ¸ˆï¼‰**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_for_committee`
   - agendaLevel: `FACILITY_AGENDA`
   - agendaRescueLevel: `11`
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

2. **âŒ å®Œå…¨å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected_by_deputy_director`
   - æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected`
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

---

### 3.4 æ³•äººè­°é¡Œãƒ¬ãƒ™ãƒ«ï¼ˆ600ç‚¹ä»¥ä¸Šï¼‰

#### 600ç‚¹åˆ°é”

**è‡ªå‹•å‡¦ç†**:
- æŠ•ç¨¿å…¬é–‹ç¯„å›²: **æ³•äººå†…å…¨è·å“¡ã«æ‹¡å¤§**
- æŠ•ç¨¿è¡¨ç¤º: æ–½è¨­å + æŠ•ç¨¿è€…åã‚’è¨˜è¼‰
- æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_general_affairs_director_review`

**é€šçŸ¥å…ˆ**:
- æ³•äººçµ±æ‹¬äº‹å‹™å±€é•·ï¼ˆLevel 18ï¼‰- åˆ¤æ–­è¦æ±‚
- å…¨æ–½è¨­ã®äº‹å‹™é•·ï¼ˆLevel 11ï¼‰- æƒ…å ±å…±æœ‰
- **æ³•äººå†…å…¨è·å“¡** - æ³•äººè­°é¡Œåˆ°é”ã®ãŠçŸ¥ã‚‰ã›

---

#### æ³•äººçµ±æ‹¬äº‹å‹™å±€é•·ã®åˆ¤æ–­

**é¸æŠè‚¢**:

1. **âœ… æ³•äººé‹å–¶ä¼šè­°æå‡ºæ‰¿èª**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_for_corp_meeting`
   - agendaLevel: `CORP_AGENDA`
   - é€šçŸ¥: æŠ•ç¨¿è€… + **æ³•äººå†…å…¨è·å“¡**ï¼ˆæ–½è¨­åãƒ»æŠ•ç¨¿è€…åä»˜ãï¼‰

2. **âŒ å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `pending_rescue_by_deputy_director` (æ•‘æ¸ˆå¾…ã¡)
   - é€šçŸ¥: æŠ•ç¨¿è€… + äº‹å‹™é•·ï¼ˆæ•‘æ¸ˆåˆ¤æ–­è¦æ±‚ï¼‰

---

#### æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼ï¼ˆLevel 18å´ä¸‹å¾Œï¼‰

**äº‹å‹™é•·ã®é¸æŠè‚¢**:

1. **âœ… æ–½è¨­è­°é¡Œæ‰¿èªï¼ˆæ•‘æ¸ˆï¼‰**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `approved_for_committee`
   - agendaLevel: `FACILITY_AGENDA`
   - agendaRescueLevel: `11`
   - å…¬é–‹ç¯„å›²: æ–½è¨­å†…ã«ç¸®å°
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

2. **âŒ å®Œå…¨å´ä¸‹**:
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected_by_general_affairs`
   - æŠ•ç¨¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: `rejected`
   - å…¬é–‹ç¯„å›²: æ–½è¨­å†…ã«ç¸®å°
   - é€šçŸ¥: æŠ•ç¨¿è€… + æ–½è¨­å†…å…¨è·å“¡

---

## 4. æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼ä¸€è¦§

| å´ä¸‹ãƒ¬ãƒ™ãƒ« | æ•‘æ¸ˆè€… | æ•‘æ¸ˆç¯„å›² | æ•‘æ¸ˆå¾Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|-----------|--------|---------|----------------|
| Level 8ï¼ˆå‰¯çœ‹è­·éƒ¨é•·ï¼‰ | Level 7ï¼ˆå¸«é•·ï¼‰ | éƒ¨ç½²è­°é¡Œ | `approved_as_dept_agenda` |
| Level 11ï¼ˆäº‹å‹™é•·ï¼‰ | Level 8ï¼ˆå‰¯çœ‹è­·éƒ¨é•·ï¼‰ | æ–½è¨­è­°é¡Œ | `approved_for_committee` |
| Level 18ï¼ˆæ³•äººçµ±æ‹¬äº‹å‹™å±€é•·ï¼‰ | Level 11ï¼ˆäº‹å‹™é•·ï¼‰ | æ–½è¨­è­°é¡Œ | `approved_for_committee` |

---

## 5. çµ„ç¹”è¨ºæ–­æ©Ÿèƒ½ã¨ã—ã¦ã®ä¾¡å€¤

ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã¯ã€å˜ãªã‚‹è­°é¡Œç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã¯ãªãã€**çµ„ç¹”è¨ºæ–­ãƒ„ãƒ¼ãƒ«**ã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã—ã¾ã™ã€‚

### è¨ºæ–­å¯èƒ½ãªçµ„ç¹”èª²é¡Œ

1. **æ‰¿èªç‡ã®åã‚Š**: ç‰¹å®šã®éƒ¨ç½²ã‚„ç®¡ç†è€…ãŒæ¥µç«¯ã«æ‰¿èªç‡ãŒä½ã„/é«˜ã„
2. **å´ä¸‹ç†ç”±ã®åˆ†æ**: å´ä¸‹ç†ç”±ã‹ã‚‰çµ„ç¹”ã®å•é¡Œã‚’ç‰¹å®š
3. **æ˜‡æ ¼/é™æ ¼ãƒ‘ã‚¿ãƒ¼ãƒ³**: ä¸è‡ªç„¶ãªæ˜‡æ ¼ãƒ»æ•‘æ¸ˆã®é »ç™º
4. **åˆ¤æ–­é…å»¶**: åˆ¤æ–­ã¾ã§ã®æ™‚é–“ãŒé•·ã„ç®¡ç†è€…ã‚„éƒ¨ç½²

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¾‹

```typescript
// éƒ¨ç½²åˆ¥æ‰¿èªç‡
const deptApprovalRate = {
  "çœ‹è­·éƒ¨Aç—…æ£Ÿ": 75%,
  "çœ‹è­·éƒ¨Bç—…æ£Ÿ": 45%, // â† ä½ã™ãã‚‹ï¼Ÿ
  "ãƒªãƒãƒ“ãƒªç§‘": 90%,
}

// ç®¡ç†è€…åˆ¥åˆ¤æ–­é…å»¶
const managerDecisionDelay = {
  "å¸«é•·A": 2.5æ—¥,
  "å¸«é•·B": 7.8æ—¥, // â† é…ã™ãã‚‹ï¼Ÿ
  "å¸«é•·C": 1.2æ—¥,
}

// æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼ç™ºç”Ÿç‡
const rescueFlowRate = {
  "æ–½è¨­A": 5%,
  "æ–½è¨­B": 25%, // â† é«˜ã™ãã‚‹ï¼Ÿä¸Šä½ãƒ¬ãƒ™ãƒ«ã¨ã®ä¸ä¸€è‡´
}
```

---

## 6. ä»Šå¾Œã®å®Ÿè£…ã‚¿ã‚¹ã‚¯

### 6.1 å³æ™‚å¯¾å¿œãŒå¿…è¦

- [ ] **Prisma Migrate**: Schemaå¤‰æ›´ã‚’æœ¬ç•ªDBã«é©ç”¨
- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ãƒ­ã‚¸ãƒƒã‚¯**: AgendaLevelNotificationServiceã®TODOå®Ÿè£…
  - `getManagersByDepartment()`
  - `getDepartmentMembersByDept()`
  - `getDeputyDirectorsByFacility()`
  - `getFacilityMembers()`
  - `getGeneralAffairsByFacility()`
  - `getCorporationMembers()`

### 6.2 æ©Ÿèƒ½è¿½åŠ 

- [ ] **ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½**: åˆ¤æ–­æ™‚ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- [ ] **æœŸé™ç®¡ç†**: åˆ¤æ–­æœŸé™ã®è¨­å®šã¨é€šçŸ¥
- [ ] **å±¥æ­´è¡¨ç¤º**: åˆ¤æ–­å±¥æ­´ã®è©³ç´°è¡¨ç¤º
- [ ] **çµ„ç¹”è¨ºæ–­ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: ãƒ¡ãƒˆãƒªã‚¯ã‚¹å¯è¦–åŒ–

### 6.3 ãƒ†ã‚¹ãƒˆ

- [ ] **å˜ä½“ãƒ†ã‚¹ãƒˆ**: AgendaDecisionServiceã®å„ãƒ¡ã‚½ãƒƒãƒ‰
- [ ] **çµ±åˆãƒ†ã‚¹ãƒˆ**: APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®E2Eãƒ†ã‚¹ãƒˆ
- [ ] **UIãƒ†ã‚¹ãƒˆ**: ãƒœã‚¿ãƒ³è¡¨ç¤ºã¨åˆ¤æ–­ãƒ•ãƒ­ãƒ¼

---

## 7. ä½¿ç”¨æ–¹æ³•

### 7.1 æ—¢å­˜ã®æŠ•ç¨¿ç®¡ç†ç”»é¢ã¸ã®çµ„ã¿è¾¼ã¿

```tsx
import { AgendaDecisionButtons } from '@/components/agenda/AgendaDecisionButtons';
import { AgendaDecisionType } from '@/services/AgendaDecisionService';

const ProposalManagementPage = () => {
  const { user } = useAuth();

  const handleDecision = async (
    decisionType: AgendaDecisionType,
    reason: string,
    committeeId?: string
  ) => {
    const response = await fetch('/api/agenda/decision', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        postId: post.id,
        decisionType,
        deciderId: user.id,
        reason,
        committeeId,
      }),
    });

    const result = await response.json();

    if (result.success) {
      alert(`${result.message}\n${result.notificationsSent}åã«é€šçŸ¥ã‚’é€ä¿¡ã—ã¾ã—ãŸ`);
      // ç”»é¢æ›´æ–°å‡¦ç†
    }
  };

  return (
    <div>
      {/* æ—¢å­˜ã®UI */}

      {/* åˆ¤æ–­ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º */}
      <AgendaDecisionButtons
        postId={post.id}
        postTitle={post.content}
        userLevel={user.permissionLevel}
        agendaScore={post.agendaScore}
        agendaStatus={post.agendaStatus}
        onDecision={handleDecision}
      />
    </div>
  );
};
```

---

## 8. ã¾ã¨ã‚

- âœ… **å®Œå…¨å®Ÿè£…**: 30ç‚¹ï½600ç‚¹ã®å…¨éšå±¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- âœ… **æ•‘æ¸ˆãƒ•ãƒ­ãƒ¼**: 3æ®µéšã®æ•‘æ¸ˆãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
- âœ… **é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **: 17ç¨®é¡ã®é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
- âœ… **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: ãƒ¢ãƒ¼ãƒ€ãƒ« + å‹•çš„ãƒœã‚¿ãƒ³è¡¨ç¤º
- âœ… **API**: RESTful APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- âš ï¸ **Prismaçµ±åˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ãŒTODO

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: Prisma Migrateã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…

---

**ä½œæˆè€…**: Claude Code
**ãƒ¬ãƒ“ãƒ¥ãƒ¼**: æœªå®Ÿæ–½
**æ‰¿èª**: æœªå®Ÿæ–½
