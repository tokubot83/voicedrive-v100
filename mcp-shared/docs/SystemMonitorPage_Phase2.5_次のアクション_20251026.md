# SystemMonitorPage Phase 2.5 - æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆVoiceDriveãƒãƒ¼ãƒ ï¼‰

**ä½œæˆæ—¥**: 2025å¹´10æœˆ26æ—¥
**å¯¾è±¡**: VoiceDriveãƒãƒ¼ãƒ 
**Phase**: Phase 2å®Œäº† â†’ Phase 2.5æº–å‚™é–‹å§‹

---

## ğŸ“‹ ç¾åœ¨ã®çŠ¶æ³

### âœ… å®Œäº†ã—ãŸä½œæ¥­

1. **Phase 2å®Ÿè£…**: åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºç›£è¦–20é …ç›®ãŒå‹•ä½œä¸­
2. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ**: 5ã¤ã®æ–‡æ›¸ã‚’ä½œæˆãƒ»å…±æœ‰
3. **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã¨ã®åˆæ„**: 4é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€APIä»•æ§˜ã€å®Ÿè£…æ–¹é‡

### ğŸ¯ ã“ã‚Œã‹ã‚‰ã‚„ã‚‹ã“ã¨

åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã‹ã‚‰ã®å›ç­”ã‚’å—ã‘ã¦ã€VoiceDriveå´ã§ã‚‚æº–å‚™ã‚’é–‹å§‹ã—ã¾ã™ã€‚

---

## ğŸš€ ä»Šæ—¥ãƒ»æ˜æ—¥ã‚„ã‚‹ã“ã¨ï¼ˆå„ªå…ˆåº¦é †ï¼‰

### 1. åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã¸Slacké€šçŸ¥ã‚’é€ã‚‹ â­â­â­

**ç›®çš„**: VoiceDriveå´ã®å›ç­”æ›¸ã‚’åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã«ä¼ãˆã‚‹

**Slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¡ˆ**ï¼ˆ`#phase2-integration`ãƒãƒ£ãƒ³ãƒãƒ«ï¼‰:

```markdown
@medical-system-team ãŠç–²ã‚Œæ§˜ã§ã™ï¼VoiceDriveãƒãƒ¼ãƒ ã§ã™ã€‚

Phase 2.5ã®å›ç­”æ›¸ï¼ˆMED-RESPONSE-2025-1026-002ï¼‰ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸğŸ™

VoiceDriveå´ã‹ã‚‰ã®å›ç­”æ›¸ã‚’ä½œæˆã—ã¾ã—ãŸã®ã§ã€ã”ç¢ºèªãã ã•ã„ï¼š

ğŸ“„ **SystemMonitorPage_VoiceDriveå›ç­”æ›¸_20251026.md**
   å ´æ‰€: mcp-shared/docs/

ã€å›ç­”å†…å®¹ã‚µãƒãƒªãƒ¼ã€‘
âœ… APIãƒ™ãƒ¼ã‚¹URL: ææ¡ˆé€šã‚Šã§å•é¡Œã‚ã‚Šã¾ã›ã‚“
âœ… APIã‚­ãƒ¼: ç’°å¢ƒã”ã¨ã«åˆ¥ã€…ã®ã‚­ãƒ¼ã‚’ä½¿ç”¨ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨ãƒ»æœ¬ç•ªç”¨ï¼‰
âœ… çµ±åˆãƒ†ã‚¹ãƒˆ: 6ã¤ã®ã‚·ãƒŠãƒªã‚ªã‚’è©³ç´°åŒ–ã—ã¾ã—ãŸ
âœ… ãƒ‡ãƒ¼ã‚¿ä¿æŒæœŸé–“: 3ãƒ¶æœˆï¼ˆ90æ—¥ï¼‰ã§çµ±ä¸€ã—ã¾ã™

ã€VoiceDriveå´ã‹ã‚‰ã®è¿½åŠ å…±æœ‰äº‹é …ã€‘
ğŸ“ å‹å®šç¾©ã‚’äº‹å‰å…±æœ‰ã—ã¾ã™ï¼ˆ10/28ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGæ™‚ï¼‰
ğŸ“ çµ±åˆãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè©³ç´°ç‰ˆã‚’11/12ã«å…±æœ‰ã—ã¾ã™
ğŸ“ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ³ãƒ—ãƒ«å½¢å¼ã‚’è¨˜è¼‰ã—ã¾ã—ãŸ

ã€ç¢ºèªäº‹é …ã€‘
1. ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒAPIã‚­ãƒ¼ã‚’10/28ã®MTGã§å…±æœ‰ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ
2. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ï¼ˆJSONé…åˆ—ï¼‰ã§å•é¡Œãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

å¼•ãç¶šãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ï¼

æ¬¡å›: 10æœˆ28æ—¥ï¼ˆæœˆï¼‰10:00 ã‚­ãƒƒã‚¯ã‚ªãƒ•MTG ğŸ¯
```

**å®Ÿæ–½æ–¹æ³•**:
1. Slackã‚’é–‹ã
2. `#phase2-integration`ãƒãƒ£ãƒ³ãƒãƒ«ã«æŠ•ç¨¿
3. åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã‹ã‚‰ã®è¿”ä¿¡ã‚’å¾…ã¤

---

### 2. Phase 2ã®å‹•ä½œç¢ºèªã¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾— â­â­â­

**ç›®çš„**: ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGã§åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã«Phase 2ã®æˆæœã‚’ãƒ‡ãƒ¢ã™ã‚‹

**æ‰‹é †**:

```bash
# 1. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# 2. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹
# URL: http://localhost:3001/admin/system-monitor

# 3. ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆLevel 99ï¼‰

# 4. ã€ŒåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯

# 5. ä»¥ä¸‹ã®é …ç›®ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
# âœ… æ¥ç¶šæ€§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆhealthy/warning/criticalï¼‰
# âœ… Webhookå—ä¿¡çµ±è¨ˆï¼ˆ24æ™‚é–“ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ï¼‰
# âœ… ãƒ‡ãƒ¼ã‚¿åŒæœŸçµ±è¨ˆï¼ˆç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã€å†™çœŸåŒæœŸç‡ï¼‰
# âœ… ç›´è¿‘ã®ã‚¨ãƒ©ãƒ¼ãƒªã‚¹ãƒˆ

# 6. ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±
# - å…¨ä½“ç”»é¢
# - Webhookçµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³
# - ãƒ‡ãƒ¼ã‚¿åŒæœŸã‚»ã‚¯ã‚·ãƒ§ãƒ³
```

**ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜å…ˆ**:
```
mcp-shared/docs/screenshots/
â”œâ”€â”€ system-monitor-integration-overview.png
â”œâ”€â”€ webhook-stats.png
â””â”€â”€ data-sync-stats.png
```

**ç”¨é€”**:
- 10/28ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGã§ã®ãƒ‡ãƒ¢
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®æ·»ä»˜
- Phase 2å®Œäº†å ±å‘Š

---

### 3. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™ â­â­

**ç›®çš„**: Phase 2.5å®Ÿè£…ã§å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’äº‹å‰è¨­å®š

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.env.development`ï¼ˆé–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒç”¨ï¼‰

```bash
# æ—¢å­˜ã®ç’°å¢ƒå¤‰æ•°
DATABASE_URL="postgresql://..."
NEXTAUTH_SECRET="..."
NEXTAUTH_URL="http://localhost:3001"

# Phase 2ã§è¿½åŠ æ¸ˆã¿ï¼ˆWebhookå—ä¿¡ç”¨ï¼‰
WEBHOOK_SECRET="your_webhook_secret_here"

# ğŸ†• Phase 2.5ã§è¿½åŠ ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIé€£æºç”¨ï¼‰
MEDICAL_SYSTEM_API_URL="https://staging-medical.example.com"
MEDICAL_SYSTEM_API_KEY=""  # â† 10/28ã®MTGã§å–å¾—äºˆå®š
```

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.env.production`ï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ï¼‰

```bash
# æ—¢å­˜ã®ç’°å¢ƒå¤‰æ•°
DATABASE_URL="postgresql://..."
NEXTAUTH_SECRET="..."
NEXTAUTH_URL="https://voicedrive-v100.vercel.app"

# Phase 2ã§è¿½åŠ æ¸ˆã¿
WEBHOOK_SECRET="production_webhook_secret"

# ğŸ†• Phase 2.5ã§è¿½åŠ 
MEDICAL_SYSTEM_API_URL="https://medical-system.example.com"
MEDICAL_SYSTEM_API_KEY=""  # â† Week 4ï¼ˆæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å‰ï¼‰ã«å–å¾—äºˆå®š
```

**æ³¨æ„äº‹é …**:
- `.env.example`ã‚‚æ›´æ–°ã—ã¦ã€å¿…è¦ãªå¤‰æ•°ã‚’æ–‡æ›¸åŒ–
- APIã‚­ãƒ¼ã¯10/28ã®MTGå¾Œã«è¨­å®š
- `.gitignore`ã§`.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒé™¤å¤–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

---

### 4. å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ â­â­

**ç›®çš„**: åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã«äº‹å‰å…±æœ‰ã™ã‚‹å‹å®šç¾©ã‚’æº–å‚™

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/types/medicalSystem.types.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

```typescript
/**
 * åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIé€£æºç”¨ã®å‹å®šç¾©
 * Phase 2.5ã§ä½¿ç”¨
 *
 * æœ€çµ‚æ›´æ–°: 2025-10-26
 * å‚ç…§: SystemMonitorPage_VoiceDriveå›ç­”æ›¸_20251026.md
 */

/**
 * åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ã®Webhooké€ä¿¡çµ±è¨ˆ
 * API 1: GET /api/voicedrive/webhook-stats
 */
export interface MedicalSystemWebhookStats {
  /** éå»24æ™‚é–“ã®é€ä¿¡ä»¶æ•° */
  sent24h: number;
  /** æˆåŠŸä»¶æ•° */
  succeeded: number;
  /** å¤±æ•—ä»¶æ•° */
  failed: number;
  /** ãƒªãƒˆãƒ©ã‚¤ä¸­ã®ä»¶æ•° */
  retried: number;
  /** æœ€çµ‚é€ä¿¡æ—¥æ™‚ï¼ˆISO 8601ï¼‰ */
  lastSentAt: string;

  /** ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—åˆ¥çµ±è¨ˆ */
  byEventType: {
    [eventType: string]: {
      sent: number;
      succeeded: number;
      failed: number;
      avgResponseTime: number;  // ãƒŸãƒªç§’
    };
  };

  /** ãƒªãƒˆãƒ©ã‚¤ã‚­ãƒ¥ãƒ¼ã®çŠ¶æ…‹ */
  queueStatus: {
    pending: number;    // é€ä¿¡å¾…ã¡
    processing: number; // å‡¦ç†ä¸­
    failed: number;     // å¤±æ•—ï¼ˆãƒªãƒˆãƒ©ã‚¤ä¸Šé™è¶…éï¼‰
  };

  /** ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼æƒ…å ± */
  retryPolicy: {
    maxRetries: number;        // æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°
    retryIntervals: number[];  // ãƒªãƒˆãƒ©ã‚¤é–“éš”ï¼ˆç§’ï¼‰
    currentRetrying: number;   // ç¾åœ¨ãƒªãƒˆãƒ©ã‚¤ä¸­ã®ä»¶æ•°
  };
}

/**
 * åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ã®é¢è«‡å®Ÿæ–½çµ±è¨ˆ
 * API 2: GET /api/voicedrive/interview-completion-stats
 */
export interface MedicalSystemInterviewStats {
  /** äºˆå®šã•ã‚ŒãŸé¢è«‡ã®ç·æ•° */
  totalScheduled: number;
  /** å®Ÿéš›ã«å®Œäº†ã—ãŸé¢è«‡æ•° */
  actuallyCompleted: number;
  /** å®Ÿæ–½ç‡ï¼ˆ%ï¼‰ */
  completionRate: number;
  /** ç„¡æ–­æ¬ å¸­ç‡ï¼ˆ%ï¼‰ */
  noShowRate: number;
  /** å†äºˆç´„ã•ã‚ŒãŸä»¶æ•° */
  rescheduledCount: number;
  /** å¹³å‡æ‰€è¦æ™‚é–“ï¼ˆåˆ†ï¼‰ */
  avgDuration: number;

  /** é¢è«‡ã‚¿ã‚¤ãƒ—åˆ¥çµ±è¨ˆ */
  byInterviewType: {
    [type: string]: {
      scheduled: number;
      completed: number;
      completionRate: number;
      avgDuration: number;
    };
  };

  /** ç›´è¿‘å®Œäº†é¢è«‡ãƒªã‚¹ãƒˆï¼ˆæœ€å¤§5ä»¶ï¼‰ */
  recentCompletions: Array<{
    interviewId: string;
    staffId: string;
    staffName: string;
    interviewType: string;
    scheduledAt: string;     // ISO 8601
    completedAt: string;     // ISO 8601
    duration: number;        // åˆ†
    status: 'completed';
  }>;

  /** æœªå®Œäº†é¢è«‡ãƒªã‚¹ãƒˆ */
  pendingInterviews: Array<{
    interviewId: string;
    staffId: string;
    staffName: string;
    interviewType: string;
    scheduledAt: string;
    status: 'scheduled';
    isPastDue: boolean;      // äºˆå®šæ™‚åˆ»ã‚’éãã¦ã„ã‚‹ã‹
  }>;

  /** æ¬ å¸­ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«é¢è«‡ãƒªã‚¹ãƒˆ */
  missedInterviews: Array<{
    interviewId: string;
    staffId: string;
    staffName: string;
    interviewType: string;
    scheduledAt: string;
    status: 'no_show' | 'cancelled';
    reason: string | null;
  }>;
}

/**
 * æ‹¡å¼µã•ã‚ŒãŸé€£æºãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆVoiceDrive + åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ï¼‰
 */
export interface EnhancedIntegrationMetrics extends IntegrationMetrics {
  /** åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ã®ãƒ‡ãƒ¼ã‚¿ */
  medicalSystem: {
    webhookStats: MedicalSystemWebhookStats;
    interviewStats: MedicalSystemInterviewStats;

    /** é€ä¿¡ vs å—ä¿¡ã®å·®åˆ† */
    syncDiscrepancy: number;

    /** é€£æºã®å¥å…¨æ€§ */
    syncHealth: 'healthy' | 'warning' | 'critical';
  } | null;  // åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIãŒã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯null
}

/**
 * åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
 */
export interface MedicalSystemApiError {
  success: false;
  error: {
    code: string;
    message: string;
  };
  timestamp: string;
}

/**
 * åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIã®æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆå…±é€šï¼‰
 */
export interface MedicalSystemApiResponse<T> {
  success: true;
  data: T;
  timestamp: string;
}
```

**å®Ÿæ–½**:
1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
2. åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã«å…±æœ‰ï¼ˆ10/28ã®MTGæ™‚ï¼‰
3. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åæ˜ 

---

## ğŸ“… 10æœˆ28æ—¥ï¼ˆæœˆï¼‰ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGæº–å‚™ â­â­â­

### æº–å‚™ã™ã‚‹ã‚‚ã®

1. **ãƒ‡ãƒ¢ç’°å¢ƒ**:
   - VoiceDriveé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ãŠã
   - SystemMonitorPageã‚’è¡¨ç¤ºã§ãã‚‹çŠ¶æ…‹ã«ã™ã‚‹
   - Phase 2ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºã‚¿ãƒ–ï¼‰ã‚’ãƒ‡ãƒ¢

2. **è³‡æ–™**:
   - Phase 2ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
   - å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`medicalSystem.types.ts`ï¼‰
   - Phase 2.5å®Ÿè£…è¨ˆç”»ï¼ˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ï¼‰

3. **è³ªå•ãƒªã‚¹ãƒˆ**:
   ```
   1. ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®APIã‚­ãƒ¼ã‚’ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ
   2. APIã®ãƒ™ãƒ¼ã‚¹URLã¯ https://staging-medical.example.com ã§ç¢ºå®šã§ã™ã‹ï¼Ÿ
   3. èªè¨¼æ–¹å¼ã¯Bearer Tokenã§å•é¡Œãªã„ã§ã™ã‹ï¼Ÿ
   4. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ï¼ˆJSONé…åˆ—ï¼‰ã§å•é¡Œãªã„ã§ã™ã‹ï¼Ÿ
   ```

### MTGè­°é¡Œï¼ˆææ¡ˆï¼‰

```
10:00-10:10 (10åˆ†): Phase 2ãƒ‡ãƒ¢
â”œâ”€ SystemMonitorPageã®ã€ŒåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºã€ã‚¿ãƒ–ã‚’å®Ÿæ¼”
â”œâ”€ Webhookå—ä¿¡çµ±è¨ˆã€ãƒ‡ãƒ¼ã‚¿åŒæœŸçµ±è¨ˆã‚’èª¬æ˜
â””â”€ Phase 2å®Œäº†ã®ç¢ºèª

10:10-10:25 (15åˆ†): Phase 2.5ã®è©³ç´°ç¢ºèª
â”œâ”€ API 1ï¼ˆWebhooké€ä¿¡çµ±è¨ˆï¼‰ã®ä»•æ§˜ç¢ºèª
â”œâ”€ API 2ï¼ˆé¢è«‡å®Ÿæ–½çµ±è¨ˆï¼‰ã®ä»•æ§˜ç¢ºèª
â”œâ”€ å‹å®šç¾©ã®å…±æœ‰ã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼
â””â”€ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ–¹é‡ã®ç¢ºèª

10:25-10:40 (15åˆ†): æŠ€è¡“çš„è©³ç´°
â”œâ”€ èªè¨¼æ–¹å¼ï¼ˆBearer Tokenï¼‰ã®ç¢ºèª
â”œâ”€ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆ100 req/minï¼‰ã®ç¢ºèª
â”œâ”€ ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®ç¢ºèª
â”œâ”€ APIã‚­ãƒ¼ã®å…±æœ‰ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒç”¨ï¼‰
â””â”€ ãƒ†ã‚¹ãƒˆç’°å¢ƒã®æ¥ç¶šç¢ºèª

10:40-10:55 (15åˆ†): ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³
â”œâ”€ Week 1-4ã®è©³ç´°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
â”œâ”€ å„Weekã®æˆæœç‰©ç¢ºèª
â”œâ”€ çµ±åˆãƒ†ã‚¹ãƒˆã®æ—¥ç¨‹èª¿æ•´ï¼ˆ11/18-22ï¼‰
â””â”€ ãƒ‡ãƒ—ãƒ­ã‚¤æ—¥ã®ç¢ºå®šï¼ˆ11/21ã¾ãŸã¯11/22ï¼‰

10:55-11:00 (5åˆ†): Next Actions
â”œâ”€ VoiceDrive: Week 1å®Ÿè£…é–‹å§‹ï¼ˆMedicalSystemClientï¼‰
â”œâ”€ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ : Week 1å®Ÿè£…é–‹å§‹ï¼ˆAPI 1ï¼‰
â””â”€ æ¬¡å›MTGæ—¥ç¨‹èª¿æ•´ï¼ˆé€±æ¬¡é€²æ—ä¼šè­°ï¼‰
```

---

## ğŸ› ï¸ Week 1ï¼ˆ10/28-11/1ï¼‰ã®å®Ÿè£…è¨ˆç”»

### Day 1ï¼ˆ10/28 æœˆï¼‰: ã‚­ãƒƒã‚¯ã‚ªãƒ•MTG + ãƒ–ãƒ©ãƒ³ãƒä½œæˆ

```bash
# 1. ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGå‚åŠ ï¼ˆ10:00-11:00ï¼‰

# 2. Phase 2.5ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git checkout main
git pull origin main
git checkout -b feature/system-monitor-phase2.5

# 3. ç’°å¢ƒå¤‰æ•°ã«APIã‚­ãƒ¼ã‚’è¨­å®šï¼ˆMTGã§å–å¾—ï¼‰
# .env.developmentã«è¿½è¨˜:
# MEDICAL_SYSTEM_API_KEY="vd-staging-api-key-xxx"

# 4. å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆæ—¢ã«æº–å‚™æ¸ˆã¿ï¼‰
# src/types/medicalSystem.types.ts

# 5. ã‚³ãƒŸãƒƒãƒˆ
git add .
git commit -m "feat: Phase 2.5æº–å‚™ - å‹å®šç¾©ã¨ç’°å¢ƒå¤‰æ•°è¿½åŠ "
```

### Day 2ï¼ˆ10/29 ç«ï¼‰: MedicalSystemClientå®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/MedicalSystemClient.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

```typescript
import axios, { AxiosError } from 'axios';
import {
  MedicalSystemWebhookStats,
  MedicalSystemInterviewStats,
  MedicalSystemApiResponse,
  MedicalSystemApiError
} from '@/types/medicalSystem.types';

const MEDICAL_SYSTEM_BASE_URL = process.env.MEDICAL_SYSTEM_API_URL || '';
const API_KEY = process.env.MEDICAL_SYSTEM_API_KEY || '';

if (!MEDICAL_SYSTEM_BASE_URL || !API_KEY) {
  console.warn('[MedicalSystemClient] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIã®è¨­å®šãŒä¸å®Œå…¨ã§ã™');
}

export class MedicalSystemClient {
  private static axiosInstance = axios.create({
    baseURL: MEDICAL_SYSTEM_BASE_URL,
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'X-VoiceDrive-System-ID': 'voicedrive-v100',
      'Content-Type': 'application/json'
    },
    timeout: 10000  // 10ç§’
  });

  /**
   * Webhooké€ä¿¡çµ±è¨ˆã‚’å–å¾—
   */
  static async getWebhookStats(
    startDate?: string,
    endDate?: string
  ): Promise<MedicalSystemWebhookStats> {
    try {
      const response = await this.axiosInstance.get<MedicalSystemApiResponse<MedicalSystemWebhookStats>>(
        '/api/voicedrive/webhook-stats',
        {
          params: { startDate, endDate }
        }
      );

      return response.data.data;
    } catch (error) {
      this.handleError('getWebhookStats', error);
      throw error;
    }
  }

  /**
   * é¢è«‡å®Ÿæ–½çµ±è¨ˆã‚’å–å¾—
   */
  static async getInterviewStats(
    startDate?: string,
    endDate?: string
  ): Promise<MedicalSystemInterviewStats> {
    try {
      const response = await this.axiosInstance.get<MedicalSystemApiResponse<MedicalSystemInterviewStats>>(
        '/api/voicedrive/interview-completion-stats',
        {
          params: { startDate, endDate }
        }
      );

      return response.data.data;
    } catch (error) {
      this.handleError('getInterviewStats', error);
      throw error;
    }
  }

  /**
   * ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   */
  private static handleError(method: string, error: unknown): void {
    if (axios.isAxiosError(error)) {
      const axiosError = error as AxiosError<MedicalSystemApiError>;

      if (axiosError.response) {
        // ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ï¼ˆ4xx, 5xxï¼‰
        console.error(`[MedicalSystemClient.${method}] APIã‚¨ãƒ©ãƒ¼:`, {
          status: axiosError.response.status,
          error: axiosError.response.data
        });
      } else if (axiosError.request) {
        // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç­‰ï¼‰
        console.error(`[MedicalSystemClient.${method}] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:`, {
          message: axiosError.message,
          code: axiosError.code
        });
      } else {
        // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
        console.error(`[MedicalSystemClient.${method}] ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­å®šã‚¨ãƒ©ãƒ¼:`, axiosError.message);
      }
    } else {
      console.error(`[MedicalSystemClient.${method}] äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼:`, error);
    }
  }
}
```

### Day 3ï¼ˆ10/30 æ°´ï¼‰: MonitoringServiceæ‹¡å¼µ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/MonitoringService.ts`ï¼ˆæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ï¼‰

```typescript
import { MedicalSystemClient } from './MedicalSystemClient';
import { EnhancedIntegrationMetrics } from '@/types/medicalSystem.types';

export class MonitoringService {
  // ... æ—¢å­˜ã®ãƒ¡ã‚½ãƒƒãƒ‰ ...

  /**
   * æ‹¡å¼µã•ã‚ŒãŸé€£æºãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—ï¼ˆVoiceDrive + åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ï¼‰
   */
  static async getEnhancedIntegrationMetrics(): Promise<EnhancedIntegrationMetrics> {
    const { PrismaClient } = await import('@prisma/client');
    const prisma = new PrismaClient();

    try {
      // VoiceDriveå´ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—ï¼ˆæ—¢å­˜ï¼‰
      const voicedriveMetrics = await this.getIntegrationMetrics();

      // åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—ï¼ˆæ–°è¦ï¼‰
      try {
        const [webhookStats, interviewStats] = await Promise.all([
          MedicalSystemClient.getWebhookStats(),
          MedicalSystemClient.getInterviewStats()
        ]);

        // é€ä¿¡ vs å—ä¿¡ã®å·®åˆ†è¨ˆç®—
        const syncDiscrepancy = webhookStats.sent24h - voicedriveMetrics.webhook.received24h;

        // å¥å…¨æ€§åˆ¤å®š
        let syncHealth: 'healthy' | 'warning' | 'critical';
        if (syncDiscrepancy <= 5) {
          syncHealth = 'healthy';
        } else if (syncDiscrepancy <= 20) {
          syncHealth = 'warning';
        } else {
          syncHealth = 'critical';
        }

        return {
          ...voicedriveMetrics,
          medicalSystem: {
            webhookStats,
            interviewStats,
            syncDiscrepancy,
            syncHealth
          }
        };
      } catch (medicalSystemError) {
        console.error('[MonitoringService] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIã‚¨ãƒ©ãƒ¼:', medicalSystemError);

        // åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ APIãŒã‚¨ãƒ©ãƒ¼ã§ã‚‚ã€VoiceDriveå´ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¯è¿”ã™
        return {
          ...voicedriveMetrics,
          medicalSystem: null
        };
      }
    } finally {
      await prisma.$disconnect();
    }
  }
}
```

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ä»Šæ—¥ãƒ»æ˜æ—¥ï¼ˆ10/26-27ï¼‰

- [ ] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã¸Slacké€šçŸ¥ã‚’é€ä»˜
- [ ] Phase 2ã®å‹•ä½œç¢ºèªã¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾—
- [ ] ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™ï¼ˆ`.env.development`ã€`.env.production`ã€`.env.example`ï¼‰
- [ ] å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆï¼ˆ`src/types/medicalSystem.types.ts`ï¼‰
- [ ] ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGè­°é¡Œã®æº–å‚™

### 10æœˆ28æ—¥ï¼ˆæœˆï¼‰

- [ ] 10:00-11:00 ã‚­ãƒƒã‚¯ã‚ªãƒ•MTGå‚åŠ 
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒAPIã‚­ãƒ¼ã‚’å–å¾—
- [ ] Phase 2.5ãƒ–ãƒ©ãƒ³ãƒä½œæˆï¼ˆ`feature/system-monitor-phase2.5`ï¼‰
- [ ] ç’°å¢ƒå¤‰æ•°ã«APIã‚­ãƒ¼ã‚’è¨­å®š
- [ ] åˆå›ã‚³ãƒŸãƒƒãƒˆ

### Week 1æ®‹ã‚Šï¼ˆ10/29-11/1ï¼‰

- [ ] MedicalSystemClientå®Ÿè£…
- [ ] MonitoringService.getEnhancedIntegrationMetrics()å®Ÿè£…
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã¨ã®æ¥ç¶šãƒ†ã‚¹ãƒˆ

---

## ğŸ“ é€£çµ¡å…ˆãƒ»ãƒªã‚½ãƒ¼ã‚¹

- **Slack**: `#phase2-integration`ãƒãƒ£ãƒ³ãƒãƒ«
- **MCPãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰**: `mcp-shared/docs/`
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
  - `SystemMonitorPage_Phase2.5ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³_20251026.md`
  - `SystemMonitorPage_VoiceDriveå›ç­”æ›¸_20251026.md`
  - `SystemMonitorPage_åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ç¢ºèªçµæœ_20251026.md`

---

**ãŒã‚“ã°ã‚Šã¾ã—ã‚‡ã†ï¼Phase 2.5ã®æˆåŠŸã«å‘ã‘ã¦ğŸš€**

æœ€çµ‚æ›´æ–°: 2025å¹´10æœˆ26æ—¥
