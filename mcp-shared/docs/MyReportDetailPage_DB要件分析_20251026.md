# MyReportDetailPage DBè¦ä»¶åˆ†æ

**æ–‡æ›¸ç•ªå·**: VD-DB-2025-1026-004
**ä½œæˆæ—¥**: 2025å¹´10æœˆ26æ—¥
**ä½œæˆè€…**: VoiceDriveãƒãƒ¼ãƒ 
**å¯¾è±¡ãƒšãƒ¼ã‚¸**: MyReportDetailPageï¼ˆå†…éƒ¨é€šå ±è©³ç´°ãƒšãƒ¼ã‚¸ï¼‰
**URL**: `https://voicedrive-v100.vercel.app/my-reports/:id`
**é‡è¦åº¦**: ğŸ”´ æœ€é‡è¦ï¼ˆå†…éƒ¨é€šå ±ãƒ»ãƒ›ã‚¤ãƒƒã‚¹ãƒ«ãƒ–ãƒ­ã‚¤ãƒ³ã‚°ï¼‰

---

## ğŸ“‹ ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### ãƒšãƒ¼ã‚¸æ¦‚è¦
MyReportDetailPageã¯ã€è·å“¡ãŒæå‡ºã—ãŸå†…éƒ¨é€šå ±ï¼ˆãƒ›ã‚¤ãƒƒã‚¹ãƒ«ãƒ–ãƒ­ã‚¤ãƒ³ã‚°ï¼‰ã®è©³ç´°ã‚’è¡¨ç¤ºã™ã‚‹ãƒšãƒ¼ã‚¸ã§ã™ã€‚
åŒ¿åé€šå ±æ©Ÿèƒ½ã‚’å«ã¿ã€ãƒãƒ©ã‚¹ãƒ¡ãƒ³ãƒˆã€å®‰å…¨ç®¡ç†ã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é•åç­‰ã®é€šå ±ã‚’å®‰å…¨ã«å‡¦ç†ã—ã¾ã™ã€‚

### ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»ã®çµè«–
- âœ… **å†…éƒ¨é€šå ±æ©Ÿèƒ½ã¯VoiceDriveå›ºæœ‰ã®æ©Ÿèƒ½**
- âœ… **åŸºæœ¬çš„ã«VoiceDriveãŒ100%ç®¡è½„**ï¼ˆé€šå ±å—ä»˜ã€ãƒˆãƒªã‚¢ãƒ¼ã‚¸ã€èª¿æŸ»ãƒãƒ¼ãƒˆï¼‰
- ğŸŸ¡ **é‡å¤§æ¡ˆä»¶ã®ã¿åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸é€£æº**ï¼ˆescalated, criticalã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ™‚ï¼‰
- ğŸŸ¡ **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¯å—ä»˜ç¢ºèªé€šçŸ¥ã¨ã‚±ãƒ¼ã‚¹ç•ªå·ç®¡ç†ã®ã¿**

### ä¸»ãªæ©Ÿèƒ½
1. é€šå ±åŸºæœ¬æƒ…å ±è¡¨ç¤ºï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€ã‚«ãƒ†ã‚´ãƒªã€é‡è¦åº¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰
2. é€šå ±å†…å®¹ãƒ»è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«è¡¨ç¤º
3. åŒ¿åIDè¡¨ç¤ºï¼ˆé€šå ±è€…ä¿è­·ï¼‰
4. æ‹…å½“èª¿æŸ»å“¡æƒ…å ±
5. å¯¾å¿œå±¥æ­´ï¼ˆã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰
6. åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å—ä»˜ç¢ºèªæƒ…å ±ï¼ˆé€£æºæ™‚ã®ã¿ï¼‰
7. ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å¿…è¦ãƒ•ãƒ©ã‚°
8. å¯¾å¿œçµæœã‚µãƒãƒªãƒ¼ï¼ˆresolvedæ™‚ï¼‰

### DBçŠ¶æ³
- âœ… `WhistleblowingReport`ãƒ†ãƒ¼ãƒ–ãƒ«: å®Ÿè£…æ¸ˆã¿
- âœ… `InvestigationNote`ãƒ†ãƒ¼ãƒ–ãƒ«: å®Ÿè£…æ¸ˆã¿
- âœ… åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: å®Ÿè£…æ¸ˆã¿
- ğŸŸ¢ **è¿½åŠ å®Ÿè£…ä¸è¦**ï¼ˆç¾çŠ¶ã®ã‚¹ã‚­ãƒ¼ãƒã§ååˆ†ï¼‰

---

## ğŸ¯ ãƒšãƒ¼ã‚¸æ©Ÿèƒ½è©³ç´°åˆ†æ

### 1. é€šå ±åŸºæœ¬æƒ…å ±ã‚«ãƒ¼ãƒ‰

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ‡ãƒ¼ã‚¿å‹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç®¡ç†è²¬ä»» | å‚™è€ƒ |
|-----|---------|------------|---------|------|
| ã‚¿ã‚¤ãƒˆãƒ« | String | WhistleblowingReport.title | ğŸŸ¢ VoiceDrive | é€šå ±è€…å…¥åŠ› |
| ã‚«ãƒ†ã‚´ãƒª | String | WhistleblowingReport.category | ğŸŸ¢ VoiceDrive | 6ç¨®é¡ï¼ˆharassment, safety, financial, compliance, discrimination, otherï¼‰ |
| é‡è¦åº¦ | String | WhistleblowingReport.severity | ğŸŸ¢ VoiceDrive | 4æ®µéšï¼ˆlow, medium, high, criticalï¼‰ |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | String | WhistleblowingReport.status | ğŸŸ¢ VoiceDrive | 6æ®µéšï¼ˆreceived, triaging, investigating, escalated, resolved, closedï¼‰ |
| åŒ¿åé€šå ±ãƒ•ãƒ©ã‚° | Boolean | WhistleblowingReport.isAnonymous | ğŸŸ¢ VoiceDrive | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆtrue |
| å—ä»˜ç¢ºèªæ¸ˆã¿ãƒ•ãƒ©ã‚° | Boolean | WhistleblowingReport.acknowledgementReceived | ğŸŸ¢ VoiceDrive | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºæ™‚true |

#### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å®šç¾©
```typescript
type ReportStatus =
  | 'received'      // å—ä»˜å®Œäº†
  | 'triaging'      // åˆ†é¡ä¸­
  | 'investigating' // èª¿æŸ»ä¸­
  | 'escalated'     // ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸é€£æºï¼‰
  | 'resolved'      // å¯¾å¿œå®Œäº†
  | 'closed';       // æ¡ˆä»¶çµ‚äº†
```

#### ã‚«ãƒ†ã‚´ãƒªå®šç¾©
```typescript
type ReportCategory =
  | 'harassment'     // ãƒãƒ©ã‚¹ãƒ¡ãƒ³ãƒˆ
  | 'safety'         // å®‰å…¨ç®¡ç†
  | 'financial'      // è²¡å‹™ãƒ»ä¼šè¨ˆ
  | 'compliance'     // ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
  | 'discrimination' // å·®åˆ¥ãƒ»ä¸å…¬æ­£
  | 'other';         // ãã®ä»–
```

---

### 2. ãƒ¡ã‚¿æƒ…å ±ã‚°ãƒªãƒƒãƒ‰

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | è¡¨ç¤ºä¾‹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|--------|---------|
| é€šå ±ID | WhistleblowingReport.id | VoiceDrive | RPT-2025-001 | ğŸŸ¢ VoiceDrive |
| åŒ¿åID | WhistleblowingReport.anonymousId | VoiceDrive | ANON-8F3A2B | ğŸŸ¢ VoiceDrive |
| åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ID | WhistleblowingReport.medicalSystemCaseNumber | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  | MED-2025-0001 | ğŸ”µ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  |
| å„ªå…ˆåº¦ | WhistleblowingReport.priority | VoiceDrive | 8/10 | ğŸŸ¢ VoiceDrive |
| é€šå ±æ—¥æ™‚ | WhistleblowingReport.submittedAt | VoiceDrive | 2025-10-01 10:30 | ğŸŸ¢ VoiceDrive |
| æœ€çµ‚æ›´æ–° | WhistleblowingReport.updatedAt | VoiceDrive | 2025-10-02 14:20 | ğŸŸ¢ VoiceDrive |
| é‡è¦åº¦ | WhistleblowingReport.severity | VoiceDrive | ç·Šæ€¥ / é«˜ / ä¸­ / ä½ | ğŸŸ¢ VoiceDrive |

**é‡è¦**: `medicalSystemCaseNumber`ã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ`escalated`ã«ãªã£ãŸæ™‚ã«åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ä»˜ä¸ã•ã‚Œã¾ã™ã€‚

---

### 3. å—ä»˜ç¢ºèªæƒ…å ±ã‚«ãƒ¼ãƒ‰ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºæ™‚ã®ã¿ï¼‰

#### è¡¨ç¤ºæ¡ä»¶
```typescript
if (report.acknowledgementReceived && report.estimatedResponseTime) {
  // å—ä»˜ç¢ºèªã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
}
```

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ä¾‹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|---|---------|
| å¯¾å¿œäºˆå®šæ™‚é–“ | WhistleblowingReport.estimatedResponseTime | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  | "å½“æ—¥ä¸­", "1æ™‚é–“ä»¥å†…" | ğŸ”µ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  |
| å—ä»˜æ—¥æ™‚ | WhistleblowingReport.acknowledgementDate | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  | 2025-10-01 11:00 | ğŸ”µ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  |
| å—ä»˜ç¢ºèªãƒ•ãƒ©ã‚° | WhistleblowingReport.acknowledgementReceived | VoiceDrive | true/false | ğŸŸ¢ VoiceDriveï¼ˆWebhookã§æ›´æ–°ï¼‰ |

**é€£æºãƒ•ãƒ­ãƒ¼**:
```mermaid
sequenceDiagram
    participant Staff as è·å“¡
    participant VD as VoiceDrive
    participant MS as åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ 

    Staff->>VD: é‡å¤§é€šå ±ã‚’æå‡ºï¼ˆseverity: criticalï¼‰
    VD->>VD: WhistleblowingReport.create()
    VD->>VD: status = 'escalated'ã«è‡ªå‹•è¨­å®š
    VD->>MS: POST /api/medical/whistleblowing/escalate
    MS->>MS: MedicalCase.create()
    MS->>MS: caseNumberç”Ÿæˆï¼ˆMED-2025-0001ï¼‰
    MS->>VD: Webhook: POST /api/webhooks/case-acknowledged
    VD->>VD: acknowledgementReceived = true
    VD->>VD: medicalSystemCaseNumber = "MED-2025-0001"
    VD->>VD: estimatedResponseTime = "1æ™‚é–“ä»¥å†…"
    VD->>Staff: é€šçŸ¥: åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã§å—ä»˜ç¢ºèªæ¸ˆã¿
```

---

### 4. é€šå ±å†…å®¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|---------|
| é€šå ±å†…å®¹ | WhistleblowingReport.content | VoiceDrive | ğŸŸ¢ VoiceDrive |
| è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ« | WhistleblowingReport.evidenceFiles | VoiceDrive | ğŸŸ¢ VoiceDrive |

**è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼**:
```typescript
evidenceFiles?: string[]; // ãƒ•ã‚¡ã‚¤ãƒ«URLé…åˆ—ï¼ˆJSONï¼‰
// ä¾‹: ["https://storage/evidence1.jpg", "https://storage/evidence2.pdf"]
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶**:
- è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ã¯æš—å·åŒ–ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
- ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡: é€šå ±è€…æœ¬äººã€æ‹…å½“èª¿æŸ»å“¡ã€Level 99ç®¡ç†è€…ã®ã¿
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ­ã‚°è¨˜éŒ²

---

### 5. æ‹…å½“èª¿æŸ»å“¡ã‚»ã‚¯ã‚·ãƒ§ãƒ³

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|---------|
| èª¿æŸ»å“¡å½¹å‰² | WhistleblowingReport.assignedInvestigators | VoiceDrive | ğŸŸ¢ VoiceDrive |

**èª¿æŸ»å“¡å½¹å‰²å®šç¾©**:
```typescript
type InvestigatorRole =
  | 'hr_specialist'    // äººäº‹æ‹…å½“
  | 'legal_counsel'    // æ³•å‹™æ‹…å½“
  | 'safety_officer'   // å®‰å…¨ç®¡ç†è²¬ä»»è€…
  | 'external_expert'  // å¤–éƒ¨å°‚é–€å®¶
  | 'management';      // ç®¡ç†è·
```

**ãƒ‡ãƒ¼ã‚¿å½¢å¼**:
```json
assignedInvestigators: ["hr_specialist", "management"]
```

**ã‚¢ã‚µã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯**:
- ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®è‡ªå‹•ã‚¢ã‚µã‚¤ãƒ³
- `harassment` â†’ `hr_specialist`, `legal_counsel`
- `safety` â†’ `safety_officer`, `management`
- `financial` â†’ `legal_counsel`, `management`
- `compliance` â†’ `legal_counsel`, `external_expert`
- `critical`ï¼ˆé‡è¦åº¦ï¼‰ â†’ è‡ªå‹•çš„ã«`management`è¿½åŠ 

---

### 6. å¯¾å¿œçµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆresolvedæ™‚ã®ã¿ï¼‰

#### è¡¨ç¤ºæ¡ä»¶
```typescript
if (report.resolutionSummary && report.status === 'resolved') {
  // å¯¾å¿œçµæœã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
}
```

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|---------|
| å¯¾å¿œçµæœ | WhistleblowingReport.resolutionSummary | VoiceDrive | ğŸŸ¢ VoiceDrive |

**å…¥åŠ›è€…**: æ‹…å½“èª¿æŸ»å“¡ï¼ˆLevel 99ç®¡ç†è€…ï¼‰

---

### 7. ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å¿…è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³

#### è¡¨ç¤ºæ¡ä»¶
```typescript
if (report.followUpRequired && report.status !== 'closed') {
  // ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å¿…è¦ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
}
```

#### è¡¨ç¤ºé …ç›®
| é …ç›® | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç®¡ç†è²¬ä»» |
|-----|----------|------------|---------|
| ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ•ãƒ©ã‚° | WhistleblowingReport.followUpRequired | VoiceDrive | ğŸŸ¢ VoiceDrive |

**ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ•ãƒ­ãƒ¼**:
- èª¿æŸ»å“¡ãŒè¿½åŠ æƒ…å ±ãŒå¿…è¦ã¨åˆ¤æ–­ã—ãŸå ´åˆã«ãƒ•ãƒ©ã‚°ã‚’ON
- é€šå ±è€…ã«é€šçŸ¥ï¼ˆåŒ¿åé€šå ±ã®å ´åˆã¯ã‚µã‚¤ãƒˆå†…é€šçŸ¥ã®ã¿ï¼‰
- ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å®Œäº†å¾Œã€ãƒ•ãƒ©ã‚°ã‚’OFF

---

### 8. å¯¾å¿œå±¥æ­´ï¼ˆã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰

#### è¡¨ç¤ºå†…å®¹
- é€šå ±å—ä»˜æ™‚ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´å±¥æ­´
- èª¿æŸ»ãƒãƒ¼ãƒˆè¿½åŠ å±¥æ­´ï¼ˆæ©Ÿå¯†æƒ…å ±ã¯è¡¨ç¤ºã—ãªã„ï¼‰

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**:
- `WhistleblowingReport.submittedAt`, `updatedAt`
- `InvestigationNote`ï¼ˆcreatedAté †ï¼‰

**ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºä¾‹**:
```
2025-10-02 14:20 - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°: èª¿æŸ»ä¸­
2025-10-01 11:00 - åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã§å—ä»˜ç¢ºèª
2025-10-01 10:30 - é€šå ±ã‚’å—ä»˜
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿è²¬ä»»ãƒãƒˆãƒªã‚¯ã‚¹

### WhistleblowingReportï¼ˆé€šå ±æœ¬ä½“ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿å‹ | VoiceDrive | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  | åŒæœŸæ–¹æ³• | å‚™è€ƒ |
|----------|---------|-----------|-------------|---------|------|
| `id` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | VoiceDriveç™ºè¡Œ |
| `userId` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | åŒ¿åé€šå ±æ™‚null |
| `anonymousId` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ANON-XXXXXXå½¢å¼ |
| `category` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | 6ç¨®é¡ |
| `severity` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | 4æ®µéš |
| `title` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | é€šå ±è€…å…¥åŠ› |
| `content` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | é€šå ±å†…å®¹ |
| `evidenceFiles` | Json? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | URLé…åˆ— |
| `submittedAt` | DateTime | âœ… ãƒã‚¹ã‚¿ | âŒ | - | é€šå ±æ—¥æ™‚ |
| `updatedAt` | DateTime | âœ… ãƒã‚¹ã‚¿ | âŒ | - | æœ€çµ‚æ›´æ–° |
| `status` | String | âœ… ãƒã‚¹ã‚¿ | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | API | VoiceDriveãŒç®¡ç† |
| `assignedInvestigators` | Json? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | VoiceDriveãŒç®¡ç† |
| `escalationReason` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç†ç”± |
| `resolutionSummary` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | å¯¾å¿œçµæœ |
| `followUpRequired` | Boolean | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ•ãƒ©ã‚° |
| `isAnonymous` | Boolean | âœ… ãƒã‚¹ã‚¿ | âŒ | - | åŒ¿åãƒ•ãƒ©ã‚° |
| `priority` | Int | âœ… ãƒã‚¹ã‚¿ | âŒ | - | 1-10å„ªå…ˆåº¦ |
| **`medicalSystemCaseNumber`** | String? | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | **âœ… ãƒã‚¹ã‚¿** | **Webhook** | **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ç™ºè¡Œ** |
| **`acknowledgementReceived`** | Boolean | âœ… ãƒã‚¹ã‚¿ | âŒ | **Webhook** | **VoiceDriveãŒç®¡ç†** |
| **`acknowledgementDate`** | DateTime? | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | **âœ… ãƒã‚¹ã‚¿** | **Webhook** | **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰é€šçŸ¥** |
| **`estimatedResponseTime`** | String? | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | **âœ… ãƒã‚¹ã‚¿** | **Webhook** | **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰é€šçŸ¥** |
| `contactMethod` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | email, phone, none |
| `contactInfo` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | æš—å·åŒ–ä¿å­˜ |
| `expectedOutcome` | String? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | æœŸå¾…ã™ã‚‹çµæœ |
| `createdAt` | DateTime | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ä½œæˆæ—¥æ™‚ |

**ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»**:
- **VoiceDriveãŒ100%ç®¡è½„**: é€šå ±å—ä»˜ã€ãƒˆãƒªã‚¢ãƒ¼ã‚¸ã€èª¿æŸ»ã€è§£æ±º
- **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£æº**: `severity=critical`ã¾ãŸã¯`status=escalated`æ™‚ã®ã¿
- **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã®å½¹å‰²**: ã‚±ãƒ¼ã‚¹ç•ªå·ç™ºè¡Œã€å—ä»˜ç¢ºèªé€šçŸ¥ã€å¯¾å¿œäºˆå®šæ™‚é–“é€šçŸ¥ã®ã¿

---

### InvestigationNoteï¼ˆèª¿æŸ»ãƒãƒ¼ãƒˆï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒ‡ãƒ¼ã‚¿å‹ | VoiceDrive | åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ  | åŒæœŸæ–¹æ³• | å‚™è€ƒ |
|----------|---------|-----------|-------------|---------|------|
| `id` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | VoiceDriveç™ºè¡Œ |
| `reportId` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | WhistleblowingReport.id |
| `authorRole` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | InvestigatorRole |
| `authorName` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | èª¿æŸ»å“¡å |
| `content` | String | âœ… ãƒã‚¹ã‚¿ | âŒ | - | èª¿æŸ»å†…å®¹ |
| `isConfidential` | Boolean | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆtrue |
| `actionItems` | Json? | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ é…åˆ— |
| `createdAt` | DateTime | âœ… ãƒã‚¹ã‚¿ | âŒ | - | ä½œæˆæ—¥æ™‚ |
| `updatedAt` | DateTime | âœ… ãƒã‚¹ã‚¿ | âŒ | - | æ›´æ–°æ—¥æ™‚ |

**ãƒ‡ãƒ¼ã‚¿ç®¡ç†è²¬ä»»**:
- **VoiceDriveãŒ100%ç®¡è½„**: èª¿æŸ»ãƒãƒ¼ãƒˆã¯æ©Ÿå¯†æƒ…å ±ã®ãŸã‚VoiceDriveå†…ã®ã¿ã§ç®¡ç†
- **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£æº**: ãªã—ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã«ã¯èª¿æŸ»ãƒãƒ¼ãƒˆã‚’å…±æœ‰ã—ãªã„ï¼‰

---

## ğŸ”„ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ•ãƒ­ãƒ¼

### ãƒ•ãƒ­ãƒ¼1: é‡å¤§é€šå ±ã®ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```mermaid
sequenceDiagram
    participant Staff as è·å“¡
    participant VD as VoiceDrive
    participant MS as åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ 

    Staff->>VD: é‡å¤§é€šå ±ã‚’æå‡ºï¼ˆseverity: criticalï¼‰
    VD->>VD: WhistleblowingReport.create()
    VD->>VD: severity=critical â†’ status='escalated'è‡ªå‹•è¨­å®š

    VD->>MS: POST /api/medical/whistleblowing/escalate
    Note over VD,MS: {reportId, anonymousId, category, severity, title, content}

    MS->>MS: MedicalCase.create()
    MS->>MS: caseNumber = generateCaseNumber() // MED-2025-0001
    MS->>MS: estimatedResponseTime = calculateResponseTime(severity)

    MS->>VD: Webhook: POST /api/webhooks/whistleblowing/acknowledged
    Note over MS,VD: {reportId, caseNumber, estimatedResponseTime, acknowledgedAt}

    VD->>VD: WhistleblowingReport.update()
    VD->>VD: medicalSystemCaseNumber = caseNumber
    VD->>VD: acknowledgementReceived = true
    VD->>VD: acknowledgementDate = acknowledgedAt
    VD->>VD: estimatedResponseTime = estimatedResponseTime

    VD->>Staff: é€šçŸ¥: åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã§å—ä»˜ç¢ºèªæ¸ˆã¿
```

**ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¡ä»¶**:
- `severity === 'critical'`ï¼ˆç·Šæ€¥ï¼‰
- `category === 'compliance'` AND `severity === 'high'`ï¼ˆé«˜ãƒªã‚¹ã‚¯ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ï¼‰
- æ‰‹å‹•ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆèª¿æŸ»å“¡ãŒåˆ¤æ–­ï¼‰

---

### ãƒ•ãƒ­ãƒ¼2: é€šå ±ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ â†’VoiceDriveï¼‰

```mermaid
sequenceDiagram
    participant MS as åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ 
    participant VD as VoiceDrive
    participant Staff as è·å“¡

    MS->>MS: MedicalCase.statusæ›´æ–°ï¼ˆèª¿æŸ»å®Œäº†ï¼‰
    MS->>VD: Webhook: POST /api/webhooks/whistleblowing/status-updated
    Note over MS,VD: {reportId, status: 'resolved', resolutionSummary}

    VD->>VD: WhistleblowingReport.update()
    VD->>VD: status = 'resolved'
    VD->>VD: resolutionSummary = resolutionSummary
    VD->>VD: updatedAt = now()

    VD->>Staff: é€šçŸ¥: é€šå ±ãŒå¯¾å¿œå®Œäº†ã—ã¾ã—ãŸ
```

---

## ğŸš¨ ä¸è¶³é …ç›®ã®æ´—ã„å‡ºã—

### 1. æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç¢ºèª

**WhistleblowingReportãƒ†ãƒ¼ãƒ–ãƒ«**:
- âœ… ã™ã¹ã¦ã®å¿…è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå®Ÿè£…æ¸ˆã¿
- âœ… åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ`medicalSystemCaseNumber`ç­‰ï¼‰ã‚‚å®Ÿè£…æ¸ˆã¿

**InvestigationNoteãƒ†ãƒ¼ãƒ–ãƒ«**:
- âœ… ã™ã¹ã¦ã®å¿…è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå®Ÿè£…æ¸ˆã¿

**çµè«–**: **è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸è¦**

---

### 2. å¿…è¦ãªAPIï¼ˆVoiceDriveå´ï¼‰

#### API-1: é€šå ±è©³ç´°å–å¾—
```http
GET /api/whistleblowing/reports/:id
Authorization: Bearer {jwt_token}
```

**å®Ÿè£…çŠ¶æ³**: â³ **å®Ÿè£…å¿…è¦**ï¼ˆç¾åœ¨ã¯ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ï¼‰

---

#### API-2: é€šå ±ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸ï¼‰
```http
POST /api/whistleblowing/reports/:id/escalate
Authorization: Bearer {jwt_token}
Content-Type: application/json

{
  "reason": "é‡å¤§ãªã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é•åã®ãŸã‚åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"
}
```

**å®Ÿè£…çŠ¶æ³**: â³ **å®Ÿè£…å¿…è¦**

---

### 3. å¿…è¦ãªWebhookï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ â†’VoiceDriveï¼‰

#### Webhook-1: å—ä»˜ç¢ºèªé€šçŸ¥
```http
POST /api/webhooks/whistleblowing/acknowledged
Content-Type: application/json
X-Medical-System-Signature: sha256=abc123...

{
  "eventType": "whistleblowing.acknowledged",
  "timestamp": "2025-10-26T10:00:00Z",
  "data": {
    "reportId": "RPT-2025-001",
    "caseNumber": "MED-2025-0001",
    "estimatedResponseTime": "1æ™‚é–“ä»¥å†…",
    "acknowledgedAt": "2025-10-26T10:00:00Z"
  }
}
```

**å®Ÿè£…çŠ¶æ³**: â³ **å®Ÿè£…å¿…è¦**

---

#### Webhook-2: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°é€šçŸ¥
```http
POST /api/webhooks/whistleblowing/status-updated
Content-Type: application/json
X-Medical-System-Signature: sha256=abc123...

{
  "eventType": "whistleblowing.status_updated",
  "timestamp": "2025-10-27T15:00:00Z",
  "data": {
    "reportId": "RPT-2025-001",
    "status": "resolved",
    "resolutionSummary": "å®‰å…¨å¯¾ç­–ã‚’å¼·åŒ–ã—ã¾ã—ãŸã€‚ã”å ±å‘Šã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚"
  }
}
```

**å®Ÿè£…çŠ¶æ³**: â³ **å®Ÿè£…å¿…è¦**

---

### 4. å¿…è¦ãªAPIï¼ˆåŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´ï¼‰

#### API-1: é€šå ±ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å—ä»˜
```http
POST /api/medical/whistleblowing/escalate
Authorization: Bearer {jwt_token}
Content-Type: application/json

{
  "reportId": "RPT-2025-001",
  "anonymousId": "ANON-8F3A2B",
  "category": "compliance",
  "severity": "critical",
  "title": "é‡å¤§ãªã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é•åã®ç–‘ã„",
  "content": "åŒ»ç™‚è¨˜éŒ²ã®ä¸é©åˆ‡ãªå–ã‚Šæ‰±ã„ã‚’ç›®æ’ƒã—ã¾ã—ãŸ...",
  "submittedAt": "2025-10-26T10:00:00Z"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "success": true,
  "caseNumber": "MED-2025-0001",
  "estimatedResponseTime": "1æ™‚é–“ä»¥å†…",
  "acknowledgedAt": "2025-10-26T10:00:00Z"
}
```

**å®Ÿè£…çŠ¶æ³**: â³ **åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ ã¸å®Ÿè£…ä¾é ¼**

---

## ğŸ“‹ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### VoiceDriveå´

#### DBé–¢é€£
- [x] WhistleblowingReportãƒ†ãƒ¼ãƒ–ãƒ«å®Ÿè£…æ¸ˆã¿
- [x] InvestigationNoteãƒ†ãƒ¼ãƒ–ãƒ«å®Ÿè£…æ¸ˆã¿
- [x] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®Ÿè£…æ¸ˆã¿

#### APIå®Ÿè£…
- [ ] GET /api/whistleblowing/reports/:idï¼ˆé€šå ±è©³ç´°å–å¾—ï¼‰
- [ ] POST /api/whistleblowing/reports/:id/escalateï¼ˆã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- [ ] POST /api/webhooks/whistleblowing/acknowledgedï¼ˆå—ä»˜ç¢ºèªWebhookï¼‰
- [ ] POST /api/webhooks/whistleblowing/status-updatedï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°Webhookï¼‰

#### UIçµ±åˆ
- [ ] MyReportDetailPageã‚’APIæ¥ç¶šï¼ˆç¾åœ¨ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ï¼‰
- [ ] ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³å®Ÿè£…ï¼ˆLevel 99ç®¡ç†è€…ã®ã¿ï¼‰
- [ ] åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å—ä»˜ç¢ºèªã‚«ãƒ¼ãƒ‰è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯

---

### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å´

#### APIå®Ÿè£…
- [ ] POST /api/medical/whistleblowing/escalateï¼ˆé€šå ±ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å—ä»˜ï¼‰
- [ ] MedicalCaseãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆã¾ãŸã¯æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«åˆ©ç”¨ï¼‰
- [ ] ã‚±ãƒ¼ã‚¹ç•ªå·ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
- [ ] å¯¾å¿œäºˆå®šæ™‚é–“è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯

#### Webhookå®Ÿè£…
- [ ] Webhooké€ä¿¡æ©Ÿèƒ½ï¼ˆå—ä»˜ç¢ºèªï¼‰
- [ ] Webhooké€ä¿¡æ©Ÿèƒ½ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼‰
- [ ] HMAC-SHA256ç½²åæ©Ÿèƒ½

---

## ğŸ¯ æˆåŠŸæŒ‡æ¨™ï¼ˆKPIï¼‰

| æŒ‡æ¨™ | ç›®æ¨™å€¤ | æ¸¬å®šæ–¹æ³• |
|------|--------|---------|
| é€šå ±å—ä»˜å¾Œã®è¡¨ç¤ºé€Ÿåº¦ | < 1ç§’ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ¸¬å®š |
| ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸç‡ | > 99% | APIæˆåŠŸç‡ãƒ­ã‚° |
| åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ å—ä»˜ç¢ºèªé€šçŸ¥é…å»¶ | < 5ç§’ | Webhookã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æ¯”è¼ƒ |
| ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ | 100% | æ—¥æ¬¡æ¤œè¨¼ãƒãƒƒãƒ |
| é€šå ±è€…ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­· | 100% | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» |

---

## ğŸ“ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### VoiceDriveãƒãƒ¼ãƒ 
1. APIå®Ÿè£…ï¼ˆé€šå ±è©³ç´°å–å¾—ã€ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
2. Webhookå—ä¿¡ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
3. MyReportDetailPageã®APIçµ±åˆ

### åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ãƒ 
1. POST /api/medical/whistleblowing/escalateå®Ÿè£…
2. MedicalCaseãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãƒ»å®Ÿè£…
3. Webhooké€ä¿¡æ©Ÿèƒ½å®Ÿè£…

### ä¸¡ãƒãƒ¼ãƒ 
1. çµ±åˆãƒ†ã‚¹ãƒˆè¨ˆç”»ç­–å®š
2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼
3. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ç›£æŸ»

---

**æ–‡æ›¸çµ‚äº†**

æœ€çµ‚æ›´æ–°: 2025å¹´10æœˆ26æ—¥
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0
æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼: å®Ÿè£…å®Œäº†å¾Œ
