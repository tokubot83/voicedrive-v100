# VoiceDrive プロジェクト承認権限レベル変更 確認依頼書

**文書番号**: VD-CHANGE-REQ-20251011-001
**作成日**: 2025年10月11日
**発信元**: VoiceDriveチーム
**宛先**: 医療職員管理システム開発チーム
**重要度**: 🟡 中（確認推奨）
**対応期限**: 2025年10月18日

---

## 📋 エグゼクティブサマリー

### 変更概要
VoiceDriveのプロジェクト承認機能において、**組織階層に合わせた権限レベルの調整**を実施しました。
この変更により、各管理職の役割と責任がより適切に反映されます。

### 影響範囲
- ✅ **VoiceDrive内部のみ**: ビジネスロジックの変更
- ❌ **データ構造変更なし**: テーブル定義、API仕様に変更なし
- ❌ **医療システムへの影響なし**: `User.permissionLevel` の提供方法は変更なし

### 確認依頼事項
医療システム側のマスタープラン、権限設計書、連携仕様書等に**本変更内容の記載や影響がないか**をご確認ください。

---

## 🎯 変更内容詳細

### 1. プロジェクト承認権限レベルの変更

| プロジェクトレベル | スコア要件 | 変更前の承認者 | **変更後の承認者** | 変更理由 |
|------------------|-----------|--------------|----------------|---------|
| **PENDING** | 0-99点 | 3.5（中堅リーダー） | **6（主任）** | 主任が現場リーダーとして適切 |
| **TEAM** | 100-199点 | 5（副主任） | **8（師長）** | 師長がチーム（5-15名）を統括 |
| **DEPARTMENT** | 200-399点 | 8（師長） | **10（部長）** | 部長が部署横断を承認 |
| **FACILITY** | 400-799点 | 10（部長） | **11（事務長）** | 事務長が施設全体を統括 |
| **ORGANIZATION** | 800点以上 | 13（院長） | **13（院長）** | 変更なし |
| **STRATEGIC** | 戦略指定 | 18（理事長） | **18（理事長）** | 変更なし |

### 2. 代行承認（フォールバック）権限

本来の承認者が不在の場合、以下のレベルが代行承認可能です：

| プロジェクトレベル | 本来の承認者 | 代行可能レベル |
|------------------|-------------|--------------|
| PENDING | 主任（6） | 副主任（5） |
| TEAM | 師長（8） | 副師長（7） |
| DEPARTMENT | 部長（10） | 副部長（9） |
| FACILITY | 事務長（11） | 事務長のみ（代行なし） |
| ORGANIZATION | 院長（13） | 副院長（12） |
| STRATEGIC | 理事長（18） | 理事長のみ（代行なし） |

### 3. VoiceDriveメニュー表示権限の変更

| ページ | 変更前 | **変更後** | 変更理由 |
|--------|--------|---------|---------|
| プロジェクト承認 | レベル3.5+ | **レベル6+（主任以上）** | 主任が現場リーダーとして承認業務を担当 |
| 進捗ダッシュボード | レベル6+ | **レベル10+（部長以上）** | 部長が複数部署・施設全体の進捗を俯瞰的に管理 |
| マイルストーン管理 | レベル7+ | **削除** | 実務上不要（職員間のコミュニケーションで対応） |
| 投稿の追跡 | レベル1+ | レベル1+（変更なし） | - |
| プロジェクトの追跡 | レベル1+ | レベル1+（変更なし） | - |

**役割分担の明確化**:
- **投稿の追跡（レベル1+）**: アイデア段階の自分の投稿を追跡（プロジェクト化前）
- **プロジェクトの追跡（レベル1+）**: プロジェクト化後の自分のプロジェクトを追跡
- **プロジェクト承認（レベル6+）**: 自分が承認すべきプロジェクトに集中（主任・師長）
- **進捗ダッシュボード（レベル10+）**: 複数部署・施設全体の俯瞰的な進捗管理（部長以上）

**シンプル化の方針**:
議題化モードと同様に、ベテラン職員でも分かりやすいシンプルな設計を重視。マイルストーン的な詳細管理は、システム上で可視化せず、職員間のコミュニケーションに委ねる。

---

## 🔍 医療システムへの影響分析

### ✅ 影響なし（No Action Required）

#### 1. データ管理責任分界点
- **変更なし**: `User.permissionLevel` は引き続き医療システムから提供
- **変更なし**: プロジェクト承認データはVoiceDriveが管理
- **変更なし**: API仕様、Webhook通知に変更なし

#### 2. データベーススキーマ
- **テーブル定義変更なし**: `User`, `Post`, `ProjectApproval` テーブルの構造は不変
- **フィールド追加なし**: 新規カラムの追加なし
- **インデックス変更なし**: 既存のインデックス構造を維持

#### 3. API連携
- **リクエスト/レスポンス形式変更なし**: VoiceDrive ⇄ 医療システム間のAPI仕様は不変
- **Webhook通知変更なし**: 職員情報変更、権限レベル変更通知の形式は不変

### ⚠️ 確認推奨事項

以下のドキュメントに本変更内容が記載されている場合、更新が必要か確認をお願いします：

1. **組織階層・権限設計書**
   - 「レベル3.5がプロジェクト承認可能」等の記載があれば更新推奨

2. **システム連携仕様書**
   - VoiceDrive側の権限レベル別機能一覧が記載されている場合

3. **ユーザーマニュアル・操作手順書**
   - 「副主任（レベル5）がチームプロジェクトを承認する」等の記載

4. **テスト計画書・テストケース**
   - 権限レベル別のテストシナリオに影響がある場合

---

## 📊 変更の背景と理由

### 問題点
従来の設定では、以下の不整合がありました：

1. **副主任（レベル5）がチームプロジェクト（5-15名）を承認**
   - 副主任は補佐的な役割が多く、プロジェクト承認には権限不足
   - 現場の実態と乖離

2. **中堅リーダー（レベル3.5）がアイデア段階を承認**
   - 中堅リーダーはまだ管理職ではない
   - 承認権限を持つには早すぎる

3. **師長（レベル8）が部署プロジェクトを承認**
   - 師長は20-40名規模の部署を統括
   - チームレベル（5-15名）の方が適切

### 解決策
組織階層に合わせて権限レベルを調整：

- **主任（6）**: 現場リーダーとしてアイデア段階の判断
- **師長（8）**: チームプロジェクト（5-15名）の承認
- **部長（10）**: 部署横断プロジェクト（15-30名）の承認
- **事務長（11）**: 施設全体プロジェクト（30-60名）の承認、予算管理

---

## 📅 変更実施スケジュール

| フェーズ | 期間 | 内容 | 状態 |
|---------|------|------|------|
| Phase 1 | 2025-10-11 | VoiceDrive内部実装完了 | ✅ 完了 |
| Phase 2 | 2025-10-11～10-18 | 医療システムチームへの確認依頼 | 🔄 進行中 |
| Phase 3 | 2025-10-18～10-25 | フィードバック反映・調整 | ⏳ 待機中 |
| Phase 4 | 2025-10-25 | 本番環境デプロイ | ⏳ 待機中 |

---

## 🤝 確認依頼事項（医療システムチーム様へ）

以下の点についてご確認をお願いいたします：

### 1. ドキュメント影響確認
- [ ] **組織階層・権限設計書**: VoiceDrive権限レベルの記載確認
- [ ] **システム連携仕様書**: 権限レベル別機能一覧の記載確認
- [ ] **マスタープラン**: 権限レベル設計に関する記載確認
- [ ] **ユーザーマニュアル**: 権限レベル別操作手順の記載確認

### 2. テスト計画への影響確認
- [ ] **統合テストシナリオ**: 権限レベル別テストケースの見直し要否
- [ ] **E2Eテスト**: 権限チェックフローの変更影響確認

### 3. 今後の連携仕様確認
- [ ] **User.permissionLevel提供方法**: 現状維持で問題ないか
- [ ] **Webhook通知仕様**: 権限レベル変更時の通知内容に変更不要か
- [ ] **API仕様**: GET /api/users/{id} のレスポンスに変更不要か

---

## 📞 問い合わせ先

### VoiceDriveチーム
- **担当者**: [担当者名]
- **Email**: voicedrive-dev@example.com
- **Slack**: #voicedrive-dev
- **対応時間**: 平日 9:00-18:00

### 緊急時連絡先
- **プロジェクトリード**: [氏名]
- **携帯**: [電話番号]

---

## 📎 関連ドキュメント

1. **VoiceDrive側ドキュメント**
   - [project-approval_DB要件分析_20251011.md](./project-approval_DB要件分析_20251011.md)
   - [ProjectPermissionService.ts](../../src/services/ProjectPermissionService.ts)
   - [projectMenuConfig.ts](../../src/config/projectMenuConfig.ts)

2. **医療システム側ドキュメント**（確認対象）
   - データ管理責任分界点定義書_20251008.md
   - 組織階層・権限設計書（医療システム側）
   - システム連携仕様書（医療システム側）

---

## ✅ 回答フォーマット

以下の形式でご回答いただけますと幸いです：

```markdown
### 確認結果

**確認日**: 2025-10-XX
**確認者**: [お名前]

#### 1. ドキュメント影響
- [ ] 影響なし
- [ ] 影響あり（更新が必要）
  - 対象ドキュメント:
  - 更新予定日:

#### 2. テスト計画への影響
- [ ] 影響なし
- [ ] 影響あり（テストケース見直しが必要）
  - 対象テストケース:
  - 見直し予定日:

#### 3. 今後の連携仕様
- [ ] 現状維持で問題なし
- [ ] 調整が必要
  - 調整内容:
  - 調整予定日:

#### 4. その他コメント・質問
[自由記述]
```

---

**文書終了**

最終更新: 2025年10月11日
次のアクション: 医療システムチームからの回答待ち（期限: 2025-10-18）
