# 各レベル管理画面のボタン仕様
作成日: 2025年10月19日

## 投稿管理画面に表示されるボタン（レベル別）

---

## 【Level 3.5】主任の投稿管理画面

### 対象投稿
- 50点到達した部署内の投稿
- ステータス: `pending_supervisor_review`

### 表示されるボタン（2つ）

```
┌─────────────────┐
│ ✅ 師長に推薦      │
└─────────────────┘

┌─────────────────┐
│ ❌ 却下           │
└─────────────────┘
```

### ボタンの動作

#### ✅ 師長に推薦
```
クリック
  ↓
【入力フォーム表示】
- 推薦理由（必須）: 「部署として優先度が高いと判断しました。」
- 補足コメント（任意）: 「夜勤帯の安全確保は急務です。」
  ↓
【送信】
  ↓
ステータス: `recommended_to_manager`
師長に通知
```

#### ❌ 却下
```
クリック
  ↓
【入力フォーム表示】
- 却下理由（必須）: 「現在の人員配置では実現が困難です。」
  ↓
【送信】
  ↓
ステータス: `rejected_by_supervisor`
投稿者に通知
投稿終了
```

---

## 【Level 7】師長の投稿管理画面

### 対象投稿
- 主任が推薦した投稿
- ステータス: `recommended_to_manager`

### 表示されるボタン（3つ）

```
┌─────────────────┐
│ ✅ 部署議題承認    │
└─────────────────┘

┌─────────────────┐
│ ⬆️ 施設議題に昇格  │
└─────────────────┘

┌─────────────────┐
│ ❌ 却下           │
└─────────────────┘
```

### ボタンの動作

#### ✅ 部署議題承認
```
クリック
  ↓
【議題提案書編集画面に遷移】
- 自動生成されたProposalDocumentを編集
- 師長が背景・期待効果・実施方針を記入
  ↓
【保存】
  ↓
ステータス: `approved_as_dept_agenda`
部署内全員に通知
投票継続（100点を目指す）
```

#### ⬆️ 施設議題に昇格
```
クリック
  ↓
【確認ダイアログ】
「施設議題に昇格しますか？
 公開範囲が施設内全職員に拡大され、投票期限が延長されます。」
  ↓
【入力フォーム表示】
- 昇格理由（必須）: 「施設全体で検討すべき重要案件と判断しました。」
  ↓
【送信】
  ↓
議題レベル: FACILITY_AGENDA
公開範囲: 施設内全職員
投票期限: +60日
ステータス: `pending_deputy_director_review`
副看護部長・施設内全職員に通知
```

#### ❌ 却下
```
クリック
  ↓
【入力フォーム表示】
- 却下理由（必須）: 「現在の予算状況では実現困難です。」
  ↓
【送信】
  ↓
ステータス: `rejected_by_manager`
投稿者・主任に通知
投稿終了
```

---

## 【Level 8】副看護部長/看護部長の投稿管理画面

### 対象投稿
- 100点到達した投稿
- ステータス: `pending_deputy_director_review`

### 表示されるボタン（3つ）

```
┌─────────────────┐
│ ✅ 委員会提出承認  │
└─────────────────┘

┌─────────────────┐
│ ⬆️ 法人検討に昇格  │
└─────────────────┘

┌─────────────────┐
│ ❌ 却下           │
└─────────────────┘
```

### ボタンの動作

#### ✅ 委員会提出承認
```
クリック
  ↓
【入力フォーム表示】
- 承認理由（必須）: 「施設として重要案件と判断しました。」
- 提出先委員会: [プルダウン]
  - 医療安全管理委員会
  - 感染対策委員会
  - 業務改善委員会
  - 小原病院運営委員会
  - 病院意思決定会議
  ↓
【送信】
  ↓
ステータス: `approved_for_committee`
施設内全職員に通知
投票終了
```

#### ⬆️ 法人検討に昇格
```
クリック
  ↓
【確認ダイアログ】
「法人検討に昇格しますか？
 300点到達を目指して投票が継続されます。
 ※公開範囲は施設内のままです。」
  ↓
【入力フォーム表示】
- 昇格理由（必須）: 「法人全体で検討すべき案件と判断しました。」
  ↓
【送信】
  ↓
議題レベル: CORP_REVIEW
公開範囲: 施設内のまま
投票期限: +30日
ステータス: `pending_general_affairs_review`
事務長・施設内全職員に通知
```

#### ❌ 却下
```
クリック
  ↓
【入力フォーム表示】
- 却下理由（必須）: 「現在の予算状況では施設全体での実施は困難です。」
  ↓
【送信】
  ↓
ステータス: `rejected_by_deputy_director`
施設内全職員に通知
師長に再判断依頼（部署議題化 or 完全却下）
```

---

## 【Level 8】副看護部長（師長からの再判断依頼時）

### 対象投稿
- 副看護部長が却下した投稿
- 師長に再判断依頼された投稿

### 表示されるボタン（師長用・2つ）

```
┌─────────────────┐
│ ✅ 部署議題承認    │
└─────────────────┘

┌─────────────────┐
│ ❌ 完全却下       │
└─────────────────┘
```

---

## 【Level 11】事務長の投稿管理画面

### 対象投稿
- 300点到達した投稿
- ステータス: `pending_general_affairs_review`

### 表示されるボタン（3つ）

```
┌─────────────────┐
│ ✅ 法人議題承認    │
└─────────────────┘

┌─────────────────┐
│ ⬆️ 法人議題に昇格  │
│   (600点目標)     │
└─────────────────┘

┌─────────────────┐
│ ❌ 却下           │
└─────────────────┘
```

### ボタンの動作

#### ✅ 法人議題承認
```
クリック
  ↓
【入力フォーム表示】
- 承認理由（必須）: 「法人全体で検討すべき重要案件と判断しました。」
- 議題提案先: [プルダウン]
  - 経営会議
  - 法人運営委員会
  ↓
【送信】
  ↓
ステータス: `approved_as_corp_agenda`
施設内全職員に通知
投票終了
議題化完了
```

#### ⬆️ 法人議題に昇格（600点目標）
```
クリック
  ↓
【確認ダイアログ】
「法人議題（理事会レベル）に昇格しますか？
 600点到達を目指して投票が継続されます。
 ※公開範囲は施設内のままです。」
  ↓
【入力フォーム表示】
- 昇格理由（必須）: 「理事会で審議すべき重要戦略案件と判断しました。」
  ↓
【送信】
  ↓
議題レベル: CORP_AGENDA
公開範囲: 施設内のまま
投票期限: +30日
ステータス: `pending_general_affairs_director_review`
法人統括事務局長・施設内全職員に通知
```

#### ❌ 却下
```
クリック
  ↓
【入力フォーム表示】
- 却下理由（必須）: 「法人全体での展開は時期尚早と判断しました。」
  ↓
【送信】
  ↓
ステータス: `rejected_by_general_affairs`
施設内全職員に通知
副看護部長に再判断依頼（施設議題化 or 完全却下）
```

---

## 【Level 11】事務長（事務局長からの再判断依頼時）

### 対象投稿
- 事務局長が却下した投稿
- 事務長に再判断依頼された投稿

### 表示されるボタン（2つ）

```
┌─────────────────┐
│ ✅ 施設議題承認    │
└─────────────────┘

┌─────────────────┐
│ ❌ 完全却下       │
└─────────────────┘
```

---

## 【Level 18】法人統括事務局長の投稿管理画面

### 対象投稿
- 600点到達した投稿
- ステータス: `pending_general_affairs_director_review`

### 表示されるボタン（2つ）

```
┌─────────────────┐
│ ✅ 法人運営会議    │
│   提出承認        │
└─────────────────┘

┌─────────────────┐
│ ❌ 却下           │
└─────────────────┘
```

### ボタンの動作

#### ✅ 法人運営会議提出承認
```
クリック
  ↓
【入力フォーム表示】
- 承認理由（必須）: 「法人全体で検討すべき重要案件と判断しました。」
  ↓
【送信】
  ↓
ステータス: `approved_for_corp_management_meeting`
公開範囲: 法人内全職員に拡大
法人内全職員に通知（施設名・投稿者名あり）
全施設の事務長に議題追加通知
投票終了
```

#### ❌ 却下
```
クリック
  ↓
【入力フォーム表示】
- 却下理由（必須）: 「現時点での法人全体での展開は時期尚早と判断しました。」
  ↓
【送信】
  ↓
ステータス: `rejected_by_general_affairs_director`
公開範囲: 法人内 → 施設内に縮小
法人内全職員に通知（却下通知）
事務長に再判断依頼（施設議題化 or 完全却下）
```

---

## ボタン表示の条件まとめ

| レベル | 対象投稿 | ボタン1 | ボタン2 | ボタン3 |
|---|---|---|---|---|
| **Level 3.5（主任）** | 50点到達 | ✅ 師長に推薦 | ❌ 却下 | - |
| **Level 7（師長）** | 主任推薦後 | ✅ 部署議題承認 | ⬆️ 施設昇格 | ❌ 却下 |
| **Level 7（再判断）** | 副看護部長却下後 | ✅ 部署議題承認 | ❌ 完全却下 | - |
| **Level 8（副看護部長）** | 100点到達 | ✅ 委員会提出承認 | ⬆️ 法人検討昇格 | ❌ 却下 |
| **Level 11（事務長）** | 300点到達 | ✅ 法人議題承認 | ⬆️ 法人議題昇格(600点) | ❌ 却下 |
| **Level 11（再判断）** | 事務局長却下後 | ✅ 施設議題承認 | ❌ 完全却下 | - |
| **Level 18（事務局長）** | 600点到達 | ✅ 法人運営会議提出 | ❌ 却下 | - |

---

## UI実装の注意点

### 1. ボタンの色分け

```css
/* 承認系（緑） */
.btn-approve {
  background-color: #10b981; /* 緑 */
}

/* 昇格系（青） */
.btn-escalate {
  background-color: #3b82f6; /* 青 */
}

/* 却下系（赤） */
.btn-reject {
  background-color: #ef4444; /* 赤 */
}
```

### 2. モーダル/ダイアログの実装

```tsx
// 判断理由入力モーダル
<DecisionModal
  isOpen={isModalOpen}
  decisionType="approve" // or "reject" or "escalate"
  onSubmit={handleDecision}
  onCancel={() => setIsModalOpen(false)}
>
  <textarea
    placeholder="判断理由を入力してください（必須）"
    value={decisionReason}
    onChange={(e) => setDecisionReason(e.target.value)}
    required
  />
</DecisionModal>
```

### 3. 確認ダイアログ（昇格時）

```tsx
// 昇格確認ダイアログ
<ConfirmDialog
  title="施設議題に昇格しますか？"
  message="公開範囲が施設内全職員に拡大され、投票期限が延長されます。"
  onConfirm={handleEscalate}
  onCancel={() => setShowConfirm(false)}
/>
```

---

## 次のステップ

この仕様でボタンを実装しますか？
