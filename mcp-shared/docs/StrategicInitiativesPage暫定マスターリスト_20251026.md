# StrategicInitiativesPage 暫定マスターリスト

**作成日**: 2025年10月26日
**ページ**: StrategicInitiativesPage (戦略イニシアチブページ)
**URL**: https://voicedrive-v100.vercel.app/strategic-initiatives
**権限**: Level 13以上（院長・施設長）

---

## 📊 実装状況サマリー

| 項目 | 状態 | 備考 |
|-----|------|------|
| **UI実装** | ✅ 完了 | 全機能実装済み |
| **デモデータ** | ✅ 動作中 | メモリ内でのみ動作 |
| **API統合** | ❌ 未実装 | 医療システムAPIと未連携 |
| **DB永続化** | ❌ 未実装 | ページリロードでデータ消失 |
| **新規作成機能** | ⚠️ 未完成 | UIボタンのみ（機能なし） |

---

## 🎯 主要機能一覧

### 1. 統計サマリー表示

| 項目 | 実装 | データソース | API | 備考 |
|-----|------|------------|-----|------|
| 総プロジェクト数 | ✅ | デモデータ | ❌ | 進行中件数も表示 |
| 平均進捗率 | ✅ | クライアント計算 | ❌ | 進行中プロジェクトの平均 |
| 期限内完了率 | ✅ | クライアント計算 | ❌ | 完了プロジェクトの達成率 |
| 総予算 | ✅ | デモデータ | ❌ | 全プロジェクト合計 |
| 予算消化率 | ✅ | クライアント計算 | ❌ | 支出済/総予算 |
| リスクありプロジェクト数 | ✅ | デモデータ | ❌ | status='at_risk'カウント |

### 2. プロジェクト一覧表示

| 項目 | 実装 | データソース | API | 備考 |
|-----|------|------------|-----|------|
| タブ切り替え | ✅ | ローカル状態 | - | 全/進行中/計画中/完了 |
| プロジェクトカード | ✅ | デモデータ | ❌ | タイトル、説明、ステータス |
| ステータスバッジ | ✅ | デモデータ | ❌ | 6種類（計画中〜キャンセル） |
| 優先度アイコン | ✅ | デモデータ | ❌ | 4段階（critical〜low） |
| 開始日・終了日 | ✅ | デモデータ | ❌ | 日本語フォーマット |
| チーム人数 | ✅ | デモデータ | ❌ | teamSize表示 |
| 予算表示 | ✅ | デモデータ | ❌ | 百万円単位（¥XXM） |
| 進捗バー | ✅ | デモデータ | ❌ | overallProgress（%） |
| KPI表示（上位3件） | ✅ | デモデータ | ❌ | 名前、現在値/目標値、トレンド |
| リスク表示（上位2件） | ✅ | デモデータ | ❌ | タイトルのみ |
| 次のマイルストーン | ✅ | デモデータ | ❌ | in_progress/pendingから取得 |

### 3. プロジェクト詳細モーダル

| 項目 | 実装 | データソース | API | 備考 |
|-----|------|------------|-----|------|
| プロジェクト目標 | ✅ | デモデータ | ❌ | objective表示 |
| マイルストーン一覧 | ✅ | デモデータ | ❌ | 全件表示、4段階ステータス |
| マイルストーン進捗率 | ✅ | デモデータ | ❌ | completionRate（%） |
| マイルストーン遅延表示 | ✅ | デモデータ | ❌ | status='delayed'で赤表示 |
| チームメンバー一覧 | ✅ | デモデータ | ❌ | 名前、役割、所属、稼働率 |
| 予算詳細 | ✅ | デモデータ | ❌ | 総額、支出、残額、消化率 |
| 予算進捗バー | ✅ | デモデータ | ❌ | utilizationRate（%） |
| リスク一覧 | ✅ | デモデータ | ❌ | 全件表示 |
| リスクレベル | ✅ | デモデータ | ❌ | high/medium/low |
| リスクステータス | ✅ | デモデータ | ❌ | identified/mitigating/resolved |
| リスク対策 | ✅ | デモデータ | ❌ | mitigation、owner表示 |

### 4. 新規プロジェクト立案

| 項目 | 実装 | データソース | API | 備考 |
|-----|------|------------|-----|------|
| 立案ボタン | ✅ | - | - | UI表示のみ |
| プロジェクトテンプレート | ✅ | デモデータ | ❌ | 4種類（DX、地域医療等） |
| 新規作成フォーム | ❌ | - | ❌ | 未実装（アラート表示のみ） |
| プロジェクト作成API | ❌ | - | ❌ | 未実装 |

---

## 🗄️ データベーステーブル

### VoiceDrive側テーブル

| テーブル名 | 存在 | 必要性 | 備考 |
|----------|------|--------|------|
| StrategicProject | ❌ | ⚠️ オプション | 医療システム完全依存を推奨 |
| ProjectMilestone | ❌ | ⚠️ オプション | 同上 |
| ProjectKPI | ❌ | ⚠️ オプション | 同上 |
| ProjectRisk | ❌ | ⚠️ オプション | 同上 |
| ProjectTeamMember | ❌ | ⚠️ オプション | 同上 |

**推奨**: テーブル追加不要（医療システムがSingle Source of Truth）

### 医療システム側テーブル（推定）

| テーブル名 | 推定存在 | VoiceDriveからのアクセス |
|----------|---------|----------------------|
| strategic_projects | ⚠️ 要確認 | GET /api/strategic-projects |
| project_milestones | ⚠️ 要確認 | GET経由で取得 |
| project_kpis | ⚠️ 要確認 | GET経由で取得 |
| project_risks | ⚠️ 要確認 | GET経由で取得 |
| project_team_members | ⚠️ 要確認 | GET経由で取得 |

---

## 🔌 API統合状況

### 取得系API

| API | メソッド | 実装 | 優先度 | 備考 |
|-----|---------|------|--------|------|
| プロジェクト一覧取得 | GET /api/strategic-projects | ❌ | 🔴 高 | フィルタリング対応 |
| プロジェクト詳細取得 | GET /api/strategic-projects/:id | ❌ | 🔴 高 | モーダル表示用 |
| 統計情報取得 | GET /api/strategic-projects/stats | ⚠️ | 🟢 低 | クライアント計算で代替可 |

### 作成・更新系API

| API | メソッド | 実装 | 優先度 | 備考 |
|-----|---------|------|--------|------|
| プロジェクト作成 | POST /api/strategic-projects | ❌ | 🟡 中 | 新規立案機能 |
| プロジェクト更新 | PATCH /api/strategic-projects/:id | ❌ | 🟡 中 | 編集機能 |
| マイルストーン完了 | POST /api/strategic-projects/:id/milestones/:mid/complete | ❌ | 🟡 中 | 進捗更新 |
| リスク追加 | POST /api/strategic-projects/:id/risks | ❌ | 🟡 中 | リスク管理 |
| リスク解決 | PATCH /api/strategic-projects/:id/risks/:rid | ❌ | 🟡 中 | リスク管理 |

---

## 📝 型定義

### 既存型定義（完全実装済み）

| 型名 | ファイル | 状態 |
|-----|---------|------|
| StrategicProject | strategicInitiatives.ts | ✅ 完全 |
| StrategicInitiativeStats | strategicInitiatives.ts | ✅ 完全 |
| ProjectMilestone | strategicInitiatives.ts | ✅ 完全 |
| ProjectRisk | strategicInitiatives.ts | ✅ 完全 |
| ProjectBudget | strategicInitiatives.ts | ✅ 完全 |
| ProjectTeamMember | strategicInitiatives.ts | ✅ 完全 |
| StrategicKPI | strategicInitiatives.ts | ✅ 完全 |
| ProjectTemplate | strategicInitiatives.ts | ✅ 完全 |

### 不足している型定義

❌ なし（すべて実装済み）

---

## ⚠️ 不足項目

### 1. データベーステーブル

**決定事項**: VoiceDrive側にテーブルを追加しない（医療システム完全依存）

**理由**:
- データ管理責任分界点: 戦略プロジェクト・予算は医療システムの管轄
- Single Source of Truth: 医療システムが一元管理
- データ重複回避: 同期問題を防ぐ

### 2. API実装

#### 必須（高優先度）
1. **GET /api/strategic-projects**
   - 実装箇所: 医療システムAPI
   - VoiceDrive側: API呼び出しコード追加
   - StrategicProjectService.ts: 書き換え（デモ→実API）

2. **GET /api/strategic-projects/:id**
   - 実装箇所: 医療システムAPI
   - VoiceDrive側: API呼び出しコード追加

#### 推奨（中優先度）
3. **POST /api/strategic-projects**
   - 新規プロジェクト立案フォーム実装
   - テンプレート選択UI
   - バリデーション

4. **POST /api/strategic-projects/:id/milestones/:mid/complete**
   - マイルストーン完了ボタン追加
   - 進捗自動再計算

5. **POST /api/strategic-projects/:id/risks**
   - リスク追加フォーム
   - リスク解決ボタン

### 3. 機能実装

| 機能 | 状態 | 必要な作業 | 優先度 |
|-----|------|-----------|--------|
| 新規プロジェクト作成フォーム | ❌ 未実装 | フォームUI実装、API連携 | 🟡 中 |
| プロジェクト編集機能 | ❌ 未実装 | 編集フォーム、API連携 | 🟡 中 |
| マイルストーン完了ボタン | ❌ 未実装 | ボタン追加、API連携 | 🟡 中 |
| リスク追加フォーム | ❌ 未実装 | フォームUI、API連携 | 🟡 中 |
| リスク解決ボタン | ❌ 未実装 | ボタン追加、API連携 | 🟡 中 |

---

## 🚀 実装ロードマップ

### Phase 1: デモデータから実APIへ移行（必須）

**目標**: 医療システムAPIと連携し、永続化されたデータを表示

**タスク**:
1. ✅ 型定義確認（完了済み）
2. ❌ 医療システムAPI実装確認
3. ❌ GET /api/strategic-projects API統合
4. ❌ GET /api/strategic-projects/:id API統合
5. ❌ StrategicProjectService.ts書き換え（デモ→実API）
6. ❌ エラーハンドリング追加
7. ❌ ローディング状態管理
8. ❌ キャッシュ実装（5分間）

**所要時間**: 3-5日

---

### Phase 2: 新規プロジェクト作成機能（推奨）

**目標**: 院長が新規戦略プロジェクトを立案できる

**タスク**:
1. ❌ プロジェクト作成フォームUI
2. ❌ テンプレート選択UI
3. ❌ バリデーション実装
4. ❌ POST /api/strategic-projects API統合
5. ❌ 作成成功時の一覧更新
6. ❌ エラーハンドリング

**所要時間**: 5-7日

---

### Phase 3: 進捗管理機能（推奨）

**目標**: マイルストーン完了、リスク管理を可能にする

**タスク**:
1. ❌ マイルストーン完了ボタン追加
2. ❌ POST /api/strategic-projects/:id/milestones/:mid/complete API統合
3. ❌ リスク追加フォーム実装
4. ❌ リスク解決ボタン追加
5. ❌ POST /api/strategic-projects/:id/risks API統合
6. ❌ 進捗自動再計算

**所要時間**: 3-5日

---

### Phase 4: プロジェクト編集機能（オプション）

**目標**: プロジェクト情報の編集を可能にする

**タスク**:
1. ❌ 編集フォームUI
2. ❌ PATCH /api/strategic-projects/:id API統合
3. ❌ 予算変更時の警告
4. ❌ 監査ログ記録

**所要時間**: 3-4日

---

## 🔒 セキュリティ要件

| 項目 | 実装 | 備考 |
|-----|------|------|
| 認証（JWT） | ✅ | useAuth hook使用 |
| 認可（Level 13以上） | ✅ | ProtectedRoute実装済み |
| HTTPS | ⚠️ | 本番環境のみ |
| APIタイムアウト | ❌ | 未設定 |
| 監査ログ | ❌ | 医療システム側で実装予定 |

---

## 📊 パフォーマンス要件

| 項目 | 目標 | 現状 | 対策 |
|-----|------|------|------|
| 初期ローディング | < 3秒 | ⚠️ 未測定 | API最適化、キャッシュ |
| プロジェクト一覧取得 | < 2秒 | ⚠️ 未測定 | インデックス、ページネーション |
| 詳細モーダル表示 | < 1秒 | ✅ 即座 | キャッシュ利用 |
| キャッシュ有効期限 | 5分 | ❌ 未実装 | 実装予定 |

---

## 📌 注意事項

### データ管理責任分界点

**医療システム管理（推奨）**:
- プロジェクト基本データ
- 予算データ
- マイルストーン
- KPI
- リスク
- チームメンバー（職員マスタ参照）
- 理事会連携

**VoiceDrive管理（オプション）**:
- プロジェクトテンプレート
- UI設定（ソート順、フィルタ等）
- 一時セッションデータ

### 既知の制約事項

1. **デモデータのみ**: 現在はメモリ内でのみ動作、ページリロードでデータ消失
2. **新規作成機能未完成**: ボタンはあるが機能なし（アラート表示のみ）
3. **編集機能なし**: プロジェクト情報の変更不可
4. **マイルストーン完了機能なし**: 進捗更新不可
5. **リスク管理機能なし**: リスク追加・解決不可

---

## 📚 関連ドキュメント

- [StrategicInitiativesPage_DB要件分析_20251026.md](./StrategicInitiativesPage_DB要件分析_20251026.md)
- [データ管理責任分界点定義書](./データ管理責任分界点定義書.md)（要作成）
- 医療システムAPI仕様書（要作成）

---

**最終更新**: 2025年10月26日
**次回レビュー予定**: Phase 1完了時
