# AWS 最小コスト構成（職員500名・セキュリティ簡素化版）

## 前提条件の見直し
- **データ特性**: 職員情報のみ（医療情報ガイドライン対象外）
- **セキュリティ**: 一般企業レベル（過剰なセキュリティ不要）
- **可用性**: 99.9%で十分（Multi-AZ不要）
- **バックアップ**: 日次バックアップ3日分で十分

## 超軽量構成
**月額: 約1.5〜2万円**

### 1. シンプル構成（本番環境）
```yaml
コンピューティング:
  EC2:
    - t3.micro × 1台: 約1,100円
    - または t4g.micro（ARM）: 約880円
    - Auto Scaling不要（500名なら1台で十分）

データベース:
  RDS PostgreSQL:
    - db.t3.micro（Single-AZ）: 約2,750円
    - またはEC2上の自前PostgreSQL: 0円（EC2に含む）
    - ストレージ: 20GB

ストレージ:
  S3:
    - 30GB（必要最小限）: 約100円
    - CloudFrontなし（Vercelが担当）

その他:
  - Route 53: 約550円（ドメイン管理）
  - CloudWatch基本メトリクス: 無料
  - データ転送: 約1,000円

月額合計: 約5,530円
```

### 2. サーバーレス構成（さらに削減）
```yaml
API:
  API Gateway + Lambda:
    - 50万リクエスト/月: 約500円
    - Lambda実行時間: 約300円
    - コールドスタート許容

データベース:
  Aurora Serverless v2:
    - 0.5 ACU最小: 約4,400円
    - 自動停止機能あり
    
  または DynamoDB:
    - オンデマンド: 約2,000円
    - 25GB無料枠あり

ストレージ:
  S3: 約100円

月額合計: 約6,900円
```

### 3. 超最小構成（Lightsail活用）
```yaml
Amazon Lightsail:
  - 2GB RAM, 1vCPU, 60GB SSD: $10（約1,100円）
  - データベース付き: +$15（約1,650円）
  - 固定IP: 無料
  - データ転送3TB含む

追加:
  - S3バックアップ: 約100円
  - Route 53: 約550円

月額合計: 約3,400円
```

## 段階的コスト計画

### Year 1（MVP・検証段階）
```yaml
Phase 1（1-6ヶ月）:
  構成: Lightsail
  月額: 3,400円
  年間: 20,400円

Phase 2（7-12ヶ月）:
  構成: EC2 t3.micro + RDS
  月額: 5,530円
  年間: 33,180円

初年度合計: 約5.4万円
```

### Year 2（本格運用）
```yaml
構成: EC2 + RDS（リザーブド）
月額: 3,871円（30%削減）
年間: 約4.6万円
```

## セキュリティの簡素化

### 不要なセキュリティサービス
```yaml
削除可能:
  - WAF: -3,300円/月（Cloudflareの無料版で代替）
  - GuardDuty: -2,200円/月
  - Secrets Manager: -550円/月（環境変数で管理）
  - VPN: 不要（HTTPS通信で十分）

残すべき最小セキュリティ:
  - IAMロール: 無料
  - Security Group: 無料
  - SSL証明書: 無料（Let's Encrypt）
  - MFA: 無料（Google Authenticator）
```

## 無料枠・無料サービスの最大活用

### AWS無料枠（12ヶ月）
```yaml
対象サービス:
  - EC2 t2.micro: 750時間/月
  - RDS db.t2.micro: 750時間/月
  - S3: 5GB
  - CloudFront: 50GB転送
  - Lambda: 100万リクエスト/月

初年度削減額: 約3万円
```

### 永続無料枠
```yaml
Lambda: 100万リクエスト/月
DynamoDB: 25GB
S3: 5GB（Glacierへ移行）
CloudWatch: 基本メトリクス
SNS: 1,000通知/月
```

## 代替サービス活用

### 1. Supabase（PostgreSQL）
```yaml
無料プラン:
  - PostgreSQL: 500MB
  - 認証機能込み
  - リアルタイム機能
  月額: 0円

有料プラン:
  - 8GB: $25/月（約2,750円）
```

### 2. PlanetScale（MySQL）
```yaml
無料プラン:
  - 5GB ストレージ
  - 10億行読み取り/月
  月額: 0円
```

### 3. Cloudflare（CDN/セキュリティ）
```yaml
無料プラン:
  - CDN
  - DDoS保護
  - SSL証明書
  - 基本WAF
  月額: 0円
```

## 最終推奨構成

### 実用的最小構成（500名対応）
```yaml
バックエンド:
  AWS Lightsail: 3,400円/月
  または
  EC2 + RDS（リザーブド）: 3,871円/月

フロントエンド:
  Vercel Pro: 2,200円/月

セキュリティ:
  Cloudflare無料版: 0円/月

バックアップ:
  S3: 100円/月

月額合計: 約6,000円
年間合計: 約7.2万円
```

### さらに節約する場合
```yaml
開発期間（6ヶ月）:
  - AWS無料枠: 0円
  - Vercel無料版: 0円
  - Supabase無料版: 0円
  月額: 0円

本番移行後:
  - Lightsail: 3,400円
  - Vercel Pro: 2,200円
  月額: 5,600円

年間予算: 約3.4万円（6ヶ月無料 + 6ヶ月有料）
```

## リスクと対策

### 簡素化によるリスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| 単一障害点 | 中 | 日次バックアップ + 迅速な復旧手順 |
| DDoS攻撃 | 低 | Cloudflare無料版で基本防御 |
| データ漏洩 | 中 | HTTPS必須 + 基本的なアクセス制御 |
| 性能劣化 | 低 | 500名なら問題なし、必要時スケールアップ |

### 移行の容易さ
```yaml
Lightsail → EC2:
  - スナップショット経由で簡単移行
  - ダウンタイム: 30分程度

Single-AZ → Multi-AZ:
  - RDS設定変更のみ
  - ダウンタイム: 数分

t3.micro → t3.small:
  - インスタンスタイプ変更
  - ダウンタイム: 5分
```

## 結論

**職員情報管理なら月額6,000円で十分運用可能**

- 医療情報ガイドライン対象外
- 一般的な個人情報保護法準拠で十分
- 500名規模ならLightsailで対応可能
- 必要に応じて段階的にスケールアップ

初期は無料枠を最大活用し、本番でも月6,000円。年間7.2万円で運用できます。