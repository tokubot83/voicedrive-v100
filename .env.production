# ==================== 本番環境設定 ====================
# 医療法人厚生会システム - 本番環境
# 最終更新: 2025年9月25日

# ==================== API設定 ====================

# プライマリエンドポイント
MEDICAL_SYSTEM_API_BASE="https://api.medical-system.kosei-kai.jp/v2"
MEDICAL_SYSTEM_API_ENDPOINT="/compliance/voicedrive"
WEBHOOK_ENDPOINT="/compliance/webhook"

# フェイルオーバーエンドポイント
FAILOVER_API_URL="https://api-backup.medical-system.kosei-kai.jp/v2"

# API設定
API_VERSION="2.0.0"
API_TIMEOUT="30000"
RATE_LIMIT_PER_MINUTE="60"
BURST_LIMIT="100"

# ==================== 認証設定 ====================

# OAuth設定
TOKEN_ENDPOINT="https://auth.medical-system.kosei-kai.jp/oauth/token"
CLIENT_ID="voicedrive_production_2025"
CLIENT_SECRET="${CLIENT_SECRET_HERE}"  # セキュアチャネルで提供される値に置き換え
SCOPE="compliance:write compliance:read audit:write"

# Token設定
ACCESS_TOKEN=""  # 初回取得後に自動更新
REFRESH_TOKEN=""  # 初回取得後に自動更新
TOKEN_REFRESH_INTERVAL="50"  # 分

# ==================== データベース設定 ====================

# MySQLプライマリデータベース
DB_HOST="mysql-primary.medical-system.kosei-kai.jp"
DB_PORT="3306"
DB_NAME="compliance_production"
DB_USER="voicedrive_prod"
DB_PASSWORD="${DB_PASSWORD_HERE}"  # お知らせ配信機能で提供される値に置き換え
DB_SSL_MODE="REQUIRED"
DB_SSL_CERT="/secure/certs/mysql-ca.crt"
DB_CHARSET="utf8mb4"
DB_COLLATION="utf8mb4_unicode_ci"

# MySQLレプリカデータベース（読み取り専用）
DB_REPLICA_HOST="mysql-replica.medical-system.kosei-kai.jp"
DB_REPLICA_PORT="3306"

# 接続プール設定
DB_POOL_MIN="2"
DB_POOL_MAX="10"
DB_IDLE_TIMEOUT="30000"
DB_CONNECTION_TIMEOUT="2000"

# ==================== ストレージ設定 ====================

# AWS S3設定
S3_BUCKET="kosei-kai-compliance-archive"
S3_REGION="ap-northeast-1"
S3_ACCESS_KEY_ID="${AWS_ACCESS_KEY_ID_HERE}"  # セキュアチャネルで提供される値に置き換え
S3_SECRET_ACCESS_KEY="${AWS_SECRET_ACCESS_KEY_HERE}"  # セキュアチャネルで提供される値に置き換え
S3_ENCRYPTION="AES256"
S3_STORAGE_CLASS="GLACIER"

# ==================== 暗号化設定 ====================

# 暗号化キー（本番用）
ENCRYPTION_KEY="${PRODUCTION_ENCRYPTION_KEY_HERE}"  # 64文字のhex形式キー（生成して設定）
ENCRYPTION_KEY_ID="voicedrive_prod_2025"
ENCRYPTION_ALGORITHM="AES-256-GCM"

# キーローテーション
KEY_ROTATION_DAYS="90"

# ==================== 通知設定 ====================

# SendGrid（Email）
SENDGRID_API_KEY="${SENDGRID_API_KEY_HERE}"  # セキュアチャネルで提供される値に置き換え
SENDGRID_FROM_EMAIL="compliance@medical-system.kosei-kai.jp"
SENDGRID_FROM_NAME="医療法人厚生会コンプライアンス窓口"
SENDGRID_TEMPLATE_CRITICAL="d-abc123def456"
SENDGRID_TEMPLATE_ASSIGNED="d-ghi789jkl012"
SENDGRID_TEMPLATE_COMPLETE="d-mno345pqr678"

# Teams
TEAMS_WEBHOOK_URL="${TEAMS_WEBHOOK_URL_HERE}"  # セキュアチャネルで提供される値に置き換え
TEAMS_CHANNEL="コンプライアンス通知"

# Slack
SLACK_WEBHOOK_URL="${SLACK_WEBHOOK_URL_HERE}"  # セキュアチャネルで提供される値に置き換え
SLACK_CHANNEL="#compliance-alerts"
SLACK_USERNAME="Compliance Bot"

# 通知有効化設定
NOTIFICATION_EMAIL_ENABLED="true"
NOTIFICATION_TEAMS_ENABLED="true"
NOTIFICATION_SLACK_ENABLED="true"

# ==================== セキュリティ設定 ====================

# JWT設定
JWT_SECRET="${JWT_SECRET_HERE}"  # 生成して設定
JWT_EXPIRES_IN="1h"
JWT_ALGORITHM="RS256"

# MFA設定
MFA_ENABLED="true"
MFA_TIMEOUT="300000"  # 5分

# セッション設定
SESSION_MAX_AGE="3600000"  # 1時間
SESSION_REFRESH_THRESHOLD="900000"  # 15分

# ==================== 監査ログ設定 ====================

# ログ保存期間
AUDIT_LOG_RETENTION_DAYS="2555"  # 7年間
AUDIT_LOG_HASH_ALGORITHM="SHA-512"

# CloudWatch設定
CLOUDWATCH_LOG_GROUP="/aws/lambda/compliance-api"
CLOUDWATCH_METRICS_NAMESPACE="VoiceDrive/Compliance"

# ==================== 環境設定 ====================

# 基本設定
NODE_ENV="production"
PORT="443"
HOST="0.0.0.0"

# デバッグ設定（本番では無効）
DEBUG="false"
LOG_LEVEL="error"
LOG_REQUESTS="false"
LOG_RESPONSES="false"

# リトライ設定
MAX_RETRIES="3"
RETRY_BACKOFF="exponential"
INITIAL_DELAY="1000"
MAX_DELAY="10000"

# 同期設定
SYNC_INTERVAL="15"  # 分

# ==================== アクセス制限 ====================

# 許可IPアドレス（カンマ区切り）
ALLOWED_IPS="203.0.113.0/24,198.51.100.0/24"

# CORS設定
CORS_ORIGIN="https://voicedrive.ai"
CORS_CREDENTIALS="true"

# ==================== 監視・アラート ====================

# ヘルスチェックエンドポイント
HEALTH_CHECK_ENDPOINT="/health"
HEALTH_CHECK_INTERVAL="60000"  # 1分

# アラート閾値
ALERT_RESPONSE_TIME="1000"  # ms
ALERT_ERROR_RATE="0.01"  # 1%
ALERT_DB_POOL_USAGE="0.8"  # 80%

# ==================== バックアップ設定 ====================

# 自動バックアップ
BACKUP_ENABLED="true"
BACKUP_SCHEDULE="0 2 * * *"  # 毎日午前2時
BACKUP_RETENTION_DAYS="30"

# ==================== 注意事項 ====================
#
# このファイルには機密情報が含まれます。
# 以下の値は必ず置き換えてください：
#
# 1. ${CLIENT_SECRET_HERE}
# 2. ${DB_PASSWORD_HERE}
# 3. ${AWS_ACCESS_KEY_ID_HERE}
# 4. ${AWS_SECRET_ACCESS_KEY_HERE}
# 5. ${PRODUCTION_ENCRYPTION_KEY_HERE}
# 6. ${SENDGRID_API_KEY_HERE}
# 7. ${TEAMS_WEBHOOK_URL_HERE}
# 8. ${SLACK_WEBHOOK_URL_HERE}
# 9. ${JWT_SECRET_HERE}
#
# これらの値は医療システムチームから
# セキュアチャネル（暗号化メール）で提供されます。
#
# ==================== END ====================