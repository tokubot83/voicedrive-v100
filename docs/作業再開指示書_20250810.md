# VoiceDrive 作業再開指示書

**作成日**: 2025年8月10日  
**対象**: 次回作業再開時のClaude Code

---

## 📋 プロジェクト現況

### Phase完了状況
- ✅ **Phase 1**: 基本機能実装（完了）
- ✅ **Phase 2**: 3段階面談選択フロー実装（完了）
- 🔄 **統合作業**: 2025/8/12(月) 10:00 キックオフ予定

### 実装完了機能
1. **3段階選択フロー**
   - 大分類選択（面談種別）
   - 中分類選択（詳細タイプ）
   - 予約内容確認
   
2. **API実装**（3エンドポイント稼働中）
   - `/api/v1/interview-types`
   - `/api/v1/interview-types/:id/subtypes`
   - `/api/v1/interview/create`

3. **統合テスト**: 成功率100%達成

---

## 🚀 作業開始時の必須確認事項

### 1. MCP共有ファイルの確認
```bash
# 同期状況の確認
cat mcp-shared/sync-status.json | grep lastSync

# 設定ファイルの確認
cat mcp-shared/config/interview-types.json

# 型定義の確認
cat mcp-shared/interfaces/interview.interface.ts
```

### 2. 開発サーバー起動確認
```bash
# VoiceDrive開発サーバー
npm run dev
# → http://localhost:5173

# APIサーバー（別ターミナル）
cd server && npm run dev
# → http://localhost:3001

# MCPサーバー（必要時）
cd mcp-integration-server && npm run dev
# → http://localhost:8080
```

### 3. テスト実行
```bash
# 統合テストで動作確認
npm run test:integration
```

---

## 📁 重要ファイルパス

### フロントエンド主要コンポーネント
- `src/components/interview/InterviewFlowContainer.tsx` - メインコンテナ
- `src/components/interview/ClassificationSelector.tsx` - 分類選択UI
- `src/components/interview/SubClassificationSelector.tsx` - 詳細選択UI
- `src/components/interview/InterviewConfirmation.tsx` - 確認画面
- `src/hooks/useInterviewFlow.ts` - 状態管理フック

### API実装
- `server/src/routes/interviewRoutes.ts` - APIルート定義
- `server/src/controllers/interviewController.ts` - コントローラー
- `server/src/services/interviewService.ts` - ビジネスロジック

### 設定・型定義
- `mcp-shared/config/interview-types.json` - 面談タイプ設定
- `mcp-shared/interfaces/interview.interface.ts` - TypeScript型定義
- `src/types/interview.ts` - フロントエンド型定義

---

## 🔧 現在の環境設定

### ポート構成
| サービス | ポート | URL |
|---------|--------|-----|
| Viteフロントエンド | 5173 | http://localhost:5173 |
| APIサーバー | 3001 | http://localhost:3001 |
| MCPサーバー | 8080 | http://localhost:8080 |
| MCPダッシュボード | 8080 | http://localhost:8080/dashboard |

### CORS設定
```javascript
// server/src/app.ts
allowedOrigins: [
  'http://localhost:5173',
  'http://localhost:3000',
  'https://medical-system.example.com'
]
```

---

## 📅 直近の予定

### 2025/8/12（月）Week 2 開始
1. **10:00-10:30**: キックオフミーティング
   - 実装デモ準備
   - API仕様書確認
   - テスト結果共有

2. **統合作業週間スケジュール**
   - 月曜: API接続作業
   - 火曜: コンポーネント統合
   - 水曜: 不具合修正
   - 木曜: パフォーマンステスト
   - 金曜: 本番環境準備

---

## ⚠️ 注意事項

### コード規約
1. **TypeScript厳密モード**を維持
2. **日本語エラーメッセージ**を使用（`src/utils/errorMessages.ts`）
3. **関数コンポーネント**のみ使用（クラスコンポーネント不可）
4. **カスタムフック**は`use`プレフィックス必須

### Git運用
- メインブランチ: `main`
- プルリクエスト先: `main`
- コミットメッセージ: 日本語で記載

### テスト要件
- 新機能追加時は必ずテストを追加
- 統合テスト成功率100%を維持
- `npm run test:integration`でテスト実行

---

## 🐛 既知の問題と対処法

### 1. ポート競合
```bash
# ポート使用確認
netstat -ano | findstr :5173
netstat -ano | findstr :3001

# プロセス終了（必要時）
taskkill /PID [プロセスID] /F
```

### 2. npm依存関係エラー
```bash
# キャッシュクリアと再インストール
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### 3. TypeScriptエラー
```bash
# 型定義の再生成
npm run type-check
```

---

## 📞 連絡先

### 通常連絡
- Slack: #phase2-integration
- メール: voicedrive-dev@example.com

### GitHub
- リポジトリ: https://github.com/tokubot83/voicedrive-v100
- Issues: 随時対応中

---

## 🎯 次回作業時のチェックリスト

作業開始時に以下を確認：

- [ ] MCP共有ファイルの最新状態確認
- [ ] 開発サーバーの起動
- [ ] 統合テストの実行（動作確認）
- [ ] Git最新状態の取得（`git pull`）
- [ ] 依存関係の更新確認（`npm outdated`）
- [ ] CLAUDE.mdの再読（最新指示確認）
- [ ] 本指示書の内容確認

---

## 💡 作業効率化のヒント

1. **並列作業**
   - 複数のターミナルで各サーバーを起動
   - VSCodeの分割ビューで関連ファイルを開く

2. **デバッグ**
   - Chrome DevToolsのNetworkタブでAPI通信確認
   - React Developer Toolsでコンポーネント状態確認

3. **ホットリロード活用**
   - Viteの高速HMRで即座に変更確認
   - APIサーバーはnodemonで自動再起動

---

**最終メモ**: Phase 2が完了し、システムは安定稼働中です。8/12からの統合作業に向けて、環境は完全に準備されています。この指示書を参照しながら、円滑に作業を再開してください。

---

**作成者**: Claude Code  
**更新日**: 2025年8月10日