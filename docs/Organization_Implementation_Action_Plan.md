# VoiceDrive çµ„ç¹”æ§‹é€ å®Ÿè£… - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³

**ä½œæˆæ—¥**: 2025-10-12
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… åŒ»ç™‚ãƒãƒ¼ãƒ å›ç­”å—é ˜æ¸ˆã¿ã€å®Ÿè£…é–‹å§‹å¯èƒ½
**å„ªå…ˆåº¦**: ğŸ”´ æœ€é«˜

---

## ğŸ“‹ åŒ»ç™‚ãƒãƒ¼ãƒ ã‹ã‚‰ã®å›ç­”ã‚µãƒãƒªãƒ¼

### âœ… ç¢ºå®šã—ãŸæƒ…å ±

#### 1. æ–½è¨­æƒ…å ±ï¼ˆ3æ–½è¨­ï¼‰

| æ–½è¨­ | ã‚³ãƒ¼ãƒ‰ | ç¨®åˆ¥ | è·å“¡æ•° | çŠ¶æ…‹ |
|------|--------|------|--------|------|
| å°åŸç—…é™¢ | `obara-hospital` | ç—…é™¢ | ç´„80å | âœ… Phase 3å®Œäº† |
| ç«‹ç¥ãƒªãƒãƒ“ãƒª | `tategami-rehabilitation` | ç—…é™¢ | ç´„100å | âœ… Phase 3å®Œäº† |
| ã‚¨ã‚¹ãƒãƒ¯ãƒ¼ãƒ«ç«‹ç¥ | `espoir-tategami` | è€å¥ | ç´„150å | âœ… å®Ÿè£…å®Œäº† |

**åˆè¨ˆè·å“¡æ•°**: ç´„330å

#### 2. çµ„ç¹”æ§‹é€ 

**å°åŸç—…é™¢**ï¼ˆ6éƒ¨é–€ï¼‰:
- çœ‹è­·éƒ¨ï¼ˆç´„30åï¼‰
- è¨ºç™‚æŠ€è¡“éƒ¨ï¼ˆç´„15åï¼‰
- è¨ºç™‚æ”¯æ´éƒ¨ï¼ˆç´„5åï¼‰
- è–¬å‰¤éƒ¨ï¼ˆç´„3åï¼‰
- äº‹å‹™éƒ¨ï¼ˆç´„8åï¼‰
- åŒ»å±€ï¼ˆç´„10åï¼‰
- æ „é¤Šç§‘ï¼ˆç´„3åï¼‰

**ç«‹ç¥ãƒªãƒãƒ“ãƒª**ï¼ˆ6éƒ¨é–€ï¼‰:
- ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³éƒ¨ï¼ˆç´„40åï¼‰- PT/OT/ST
- çœ‹è­·éƒ¨ï¼ˆç´„30åï¼‰
- æ¸©æ³‰ç™‚æ³•ç§‘ï¼ˆç´„5åï¼‰
- äº‹å‹™éƒ¨ï¼ˆç´„15åï¼‰
- æ „é¤Šç§‘ï¼ˆç´„5åï¼‰
- è–¬å‰¤éƒ¨ï¼ˆç´„3åï¼‰
- åŒ»å±€ï¼ˆç´„10åï¼‰

**ã‚¨ã‚¹ãƒãƒ¯ãƒ¼ãƒ«ç«‹ç¥**ï¼ˆ2èª²ä½“åˆ¶ï¼‰:
- å…¥æ‰€èª²ï¼ˆç´„80åï¼‰- 6é…ä¸‹éƒ¨é–€
- åœ¨å®…èª²ï¼ˆç´„40åï¼‰- 4é…ä¸‹äº‹æ¥­æ‰€
- äº‹å‹™éƒ¨ï¼ˆç´„10åï¼‰

#### 3. æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—ã®æ±ºå®š

| éƒ¨é–€ã‚¿ã‚¤ãƒ— | ã‚¹ã‚³ãƒ¼ãƒ— | è©²å½“éƒ¨é–€ |
|-----------|---------|---------|
| **é…ç½®å ´æ‰€ãƒ™ãƒ¼ã‚¹** | A | çœ‹è­·éƒ¨ã€ä»‹è­·éƒ¨ã€åœ¨å®…èª²äº‹æ¥­æ‰€ |
| **è·ç¨®ãƒ™ãƒ¼ã‚¹** | B | ãƒªãƒãƒ“ãƒªç§‘ã€è¨ºç™‚æŠ€è¡“éƒ¨ã€åŒ»å±€ |
| **éƒ¨é–€å…¨ä½“ãƒ™ãƒ¼ã‚¹** | C | è–¬å‰¤éƒ¨ã€äº‹å‹™éƒ¨ã€è¨ºç™‚æ”¯æ´éƒ¨ã€æ¸©æ³‰ç™‚æ³•ç§‘ |

#### 4. é‡è¦ãªæ±ºå®šäº‹é …

âœ… **æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—**: å½“é¢ä¸è¦ï¼ˆå„éƒ¨é–€ã®äººæ•°ãŒååˆ†ï¼‰
âœ… **ã‚¹ã‚³ã‚¢é–¾å€¤**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’æ¡ç”¨
âœ… **å§”å“¡ä¼šãƒã‚¹ã‚¿ãƒ¼**: DBæ§‹ç¯‰å¾Œã«è©³ç´°åŒ–
âœ… **è¿½åŠ è·ç¨®**: 5è·ç¨®ã‚’è¿½åŠ ï¼ˆã‚±ã‚¢ãƒãƒã€SWã€ä»‹è­·ç¦ç¥‰å£«ç­‰ï¼‰

---

## ğŸ¯ å®Ÿè£…è¨ˆç”»ï¼ˆå³åº§ã«é–‹å§‹å¯èƒ½ï¼‰

### Phase 1: åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆ1-2æ—¥ï¼‰

#### 1.1 æ–½è¨­ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ä½œæˆ

```typescript
// scripts/seed/01-facilities.ts

const facilities = [
  {
    id: 'fac_obara',
    facilityCode: 'obara-hospital',
    facilityName: 'å°åŸç—…é™¢',
    facilityType: 'hospital',
    corporationId: 'kouseikai',
    corporationName: 'åŒ»ç™‚æ³•äººåšç”Ÿä¼š',
    totalStaffCount: 80,
    totalBedCount: 60,
    createdBy: 'LEVEL_99'
  },
  {
    id: 'fac_tategami',
    facilityCode: 'tategami-rehabilitation',
    facilityName: 'ç«‹ç¥ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ¸©æ³‰ç—…é™¢',
    facilityType: 'hospital',
    corporationId: 'kouseikai',
    corporationName: 'åŒ»ç™‚æ³•äººåšç”Ÿä¼š',
    totalStaffCount: 100,
    totalBedCount: 90,
    createdBy: 'LEVEL_99'
  },
  {
    id: 'fac_espoir',
    facilityCode: 'espoir-tategami',
    facilityName: 'ä»‹è­·è€äººä¿å¥æ–½è¨­ã‚¨ã‚¹ãƒãƒ¯ãƒ¼ãƒ«ç«‹ç¥',
    facilityType: 'nursing_home',
    corporationId: 'kouseikai',
    corporationName: 'åŒ»ç™‚æ³•äººåšç”Ÿä¼š',
    totalStaffCount: 150,
    createdBy: 'LEVEL_99'
  }
];
```

#### 1.2 çµ„ç¹”æ§‹é€ ãƒ‡ãƒ¼ã‚¿ä½œæˆ

```typescript
// scripts/seed/02-organization-structure.ts

// å°åŸç—…é™¢ã®çµ„ç¹”æ§‹é€ 
const obaraOrganizations = [
  // çœ‹è­·éƒ¨
  {
    id: 'org_obara_nursing',
    facilityId: 'fac_obara',
    departmentId: 'nursing_dept_obara',
    departmentCode: 'nursing_dept',
    departmentName: 'çœ‹è­·éƒ¨',
    departmentType: 'clinical',
    level: 2,
    staffCount: 30,
    createdBy: 'LEVEL_99'
  },
  // çœ‹è­·éƒ¨ > 3éšç—…æ£Ÿ
  {
    id: 'org_obara_nursing_ward3f',
    facilityId: 'fac_obara',
    departmentId: 'nursing_dept_obara',
    departmentCode: 'nursing_dept',
    departmentName: 'çœ‹è­·éƒ¨',
    departmentType: 'clinical',
    sectionId: 'ward_3f_obara',
    sectionCode: 'ward_3f',
    sectionName: '3éšç—…æ£Ÿ',
    sectionType: 'inpatient',
    parentDeptId: 'nursing_dept_obara',
    level: 3,
    staffCount: 10,
    createdBy: 'LEVEL_99'
  },
  // è¨ºç™‚æŠ€è¡“éƒ¨ > ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®¤
  {
    id: 'org_obara_medtech_rehab',
    facilityId: 'fac_obara',
    departmentId: 'medical_technology_dept_obara',
    departmentCode: 'medical_technology_dept',
    departmentName: 'è¨ºç™‚æŠ€è¡“éƒ¨',
    departmentType: 'clinical',
    sectionId: 'rehab_room_obara',
    sectionCode: 'rehab_room',
    sectionName: 'ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®¤',
    sectionType: 'therapy',
    parentDeptId: 'medical_technology_dept_obara',
    level: 3,
    staffCount: 10,
    createdBy: 'LEVEL_99'
  }
  // ... ä»–ã®éƒ¨é–€ãƒ»ã‚»ã‚¯ã‚·ãƒ§ãƒ³
];
```

#### 1.3 è·ç¨®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ä½œæˆ

```typescript
// scripts/seed/03-job-categories.ts

const jobCategories = [
  // æ—¢å­˜è·ç¨®
  { categoryCode: 'nurse', categoryName: 'çœ‹è­·å¸«', profession: 'nursing', requiresLicense: true },
  { categoryCode: 'pt', categoryName: 'ç†å­¦ç™‚æ³•å£«', profession: 'rehabilitation', requiresLicense: true },
  // ... ä»–ã®æ—¢å­˜è·ç¨®

  // è¿½åŠ è·ç¨®ï¼ˆã‚¨ã‚¹ãƒãƒ¯ãƒ¼ãƒ«ç«‹ç¥ç”¨ï¼‰
  {
    categoryCode: 'care_manager',
    categoryName: 'ã‚±ã‚¢ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼',
    profession: 'care_management',
    jobFunction: 'administrative',
    requiresLicense: true,
    licenseType: 'national',
    createdBy: 'LEVEL_99'
  },
  {
    categoryCode: 'social_worker',
    categoryName: 'ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ¯ãƒ¼ã‚«ãƒ¼',
    profession: 'social_work',
    jobFunction: 'support',
    requiresLicense: true,
    licenseType: 'national',
    createdBy: 'LEVEL_99'
  },
  {
    categoryCode: 'certified_care_worker',
    categoryName: 'ä»‹è­·ç¦ç¥‰å£«',
    profession: 'care',
    jobFunction: 'clinical',
    requiresLicense: true,
    licenseType: 'national',
    createdBy: 'LEVEL_99'
  },
  {
    categoryCode: 'registered_dietitian',
    categoryName: 'ç®¡ç†æ „é¤Šå£«',
    profession: 'nutrition',
    jobFunction: 'clinical',
    requiresLicense: true,
    licenseType: 'national',
    createdBy: 'LEVEL_99'
  },
  {
    categoryCode: 'dietitian',
    categoryName: 'æ „é¤Šå£«',
    profession: 'nutrition',
    jobFunction: 'clinical',
    requiresLicense: true,
    licenseType: 'prefectural',
    createdBy: 'LEVEL_99'
  }
];
```

#### 1.4 è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šãƒ‡ãƒ¼ã‚¿ä½œæˆ

```typescript
// scripts/seed/04-agenda-mode-configs.ts

// å°åŸç—…é™¢ãƒ»çœ‹è­·éƒ¨ã®è¨­å®šï¼ˆé…ç½®å ´æ‰€ãƒ™ãƒ¼ã‚¹ï¼‰
const obaraNursingConfig = {
  id: 'amc_nursing_obara',
  departmentId: 'nursing_dept_obara',
  scoreThresholds: {
    pending: 30,
    deptReview: 50,
    deptAgenda: 50,
    facilityAgenda: 100,
    corpReview: 300,
    corpAgenda: 600
  },
  votingScopeRules: {
    scopeType: 'location_based',
    rules: [
      {
        scoreRange: '0-29',
        scope: 'section',
        criteria: ['sectionId'],
        description: 'åŒã˜ç—…æ£Ÿã®ã¿'
      },
      {
        scoreRange: '30-99',
        scope: 'department',
        criteria: ['departmentId'],
        description: 'çœ‹è­·éƒ¨å…¨ä½“'
      },
      {
        scoreRange: '100+',
        scope: 'facility',
        criteria: ['facilityId'],
        description: 'æ–½è¨­å…¨ä½“'
      }
    ]
  },
  committeeSettings: {
    autoSubmit: true,
    targetCommittee: 'nursing_committee',
    submitThreshold: 100
  },
  createdBy: 'LEVEL_99'
};

// å°åŸç—…é™¢ãƒ»ãƒªãƒãƒ“ãƒªå®¤ã®è¨­å®šï¼ˆè·ç¨®ãƒ™ãƒ¼ã‚¹ï¼‰
const obaraRehabConfig = {
  id: 'amc_rehab_obara',
  departmentId: 'medical_technology_dept_obara',
  scoreThresholds: {
    pending: 30,
    deptReview: 50,
    deptAgenda: 50,
    facilityAgenda: 100
  },
  votingScopeRules: {
    scopeType: 'profession_based',
    rules: [
      {
        scoreRange: '0-29',
        scope: 'job_category',
        criteria: ['jobCategory'],
        description: 'åŒã˜è·ç¨®ã®ã¿ï¼ˆPTåŒå£«ã€OTåŒå£«ï¼‰'
      },
      {
        scoreRange: '30-99',
        scope: 'department',
        criteria: ['departmentId'],
        description: 'è¨ºç™‚æŠ€è¡“éƒ¨å…¨ä½“'
      },
      {
        scoreRange: '100+',
        scope: 'facility',
        criteria: ['facilityId'],
        description: 'æ–½è¨­å…¨ä½“'
      }
    ]
  },
  createdBy: 'LEVEL_99'
};

// å°åŸç—…é™¢ãƒ»è–¬å‰¤éƒ¨ã®è¨­å®šï¼ˆéƒ¨é–€å…¨ä½“ãƒ™ãƒ¼ã‚¹ï¼‰
const obaraPharmacyConfig = {
  id: 'amc_pharmacy_obara',
  departmentId: 'pharmacy_dept_obara',
  scoreThresholds: {
    pending: 30,
    deptReview: 50,
    deptAgenda: 50,
    facilityAgenda: 100
  },
  votingScopeRules: {
    scopeType: 'department_based',
    rules: [
      {
        scoreRange: '0-99',
        scope: 'department',
        criteria: ['departmentId'],
        description: 'è–¬å‰¤éƒ¨å…¨ä½“ï¼ˆå°‘äººæ•°ã®ãŸã‚æœ€åˆã‹ã‚‰éƒ¨é–€å…¨ä½“ï¼‰'
      },
      {
        scoreRange: '100+',
        scope: 'facility',
        criteria: ['facilityId'],
        description: 'æ–½è¨­å…¨ä½“'
      }
    ]
  },
  createdBy: 'LEVEL_99'
};
```

---

### Phase 2: ã‚¹ã‚­ãƒ¼ãƒçµ±åˆã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ2-3æ—¥ï¼‰

#### 2.1 æ—¢å­˜schema.prismaã¸ã®çµ±åˆ

```bash
# 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
cp prisma/schema.prisma prisma/schema.prisma.backup

# 2. æ–°è¦ã‚¹ã‚­ãƒ¼ãƒã‚’æ—¢å­˜ã‚¹ã‚­ãƒ¼ãƒã«çµ±åˆ
# schema_organization_extension.prismaã®å†…å®¹ã‚’
# schema.prismaã«ãƒãƒ¼ã‚¸

# 3. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
npx prisma migrate dev --name add_organization_structure

# 4. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œç¢ºèª
npx prisma migrate status
```

#### 2.2 ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥

```bash
# 1. ã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
npm run seed:organization

# 2. ãƒ‡ãƒ¼ã‚¿ç¢ºèª
npx prisma studio
```

---

### Phase 3: AgendaLevelEngineæ”¹ä¿®ï¼ˆ3-4æ—¥ï¼‰

#### 3.1 çµ„ç¹”æ§‹é€ å¯¾å¿œã®æ”¹ä¿®

```typescript
// src/systems/agenda/engines/AgendaLevelEngine.ts

class AgendaLevelEngine {

  /**
   * çµ„ç¹”æ§‹é€ ã«åŸºã¥ãæ¨©é™åˆ¤å®šï¼ˆæ”¹ä¿®ç‰ˆï¼‰
   */
  async getAgendaPermissions(
    post: Post,
    currentUser: User,
    currentScore: number
  ): Promise<AgendaPermissions> {

    // 1. æŠ•ç¨¿è€…ã®éƒ¨é–€è¨­å®šã‚’å–å¾—
    const deptConfig = await prisma.agendaModeConfig.findUnique({
      where: { departmentId: post.authorDepartmentId }
    });

    // 2. ã‚¹ã‚³ã‚¢ã«å¿œã˜ãŸãƒ«ãƒ¼ãƒ«ã‚’å–å¾—
    const rule = this.getRuleForScore(deptConfig.votingScopeRules, currentScore);

    // 3. ãƒ«ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸæ¨©é™åˆ¤å®š
    switch (rule.scope) {
      case 'section':
        return this.checkSectionPermission(post, currentUser);

      case 'job_category':
        return this.checkJobCategoryPermission(post, currentUser);

      case 'department':
        return this.checkDepartmentPermission(post, currentUser);

      case 'facility':
        return this.checkFacilityPermission(post, currentUser);

      case 'corporation':
        return this.checkCorporationPermission(post, currentUser);
    }
  }

  /**
   * ã‚»ã‚¯ã‚·ãƒ§ãƒ³å˜ä½ã®æ¨©é™ãƒã‚§ãƒƒã‚¯
   */
  private checkSectionPermission(post: Post, user: User): AgendaPermissions {
    const canVote = post.authorSectionId === user.primarySectionId;

    return {
      canView: true,
      canVote,
      canComment: canVote,
      visibilityScope: 'åŒã˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ã¿',
      permissionReason: canVote ? undefined : 'ä»–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãŸã‚æŠ•ç¥¨ä¸å¯'
    };
  }

  /**
   * è·ç¨®å˜ä½ã®æ¨©é™ãƒã‚§ãƒƒã‚¯
   */
  private checkJobCategoryPermission(post: Post, user: User): AgendaPermissions {
    const canVote = post.authorJobCategory === user.jobCategory;

    return {
      canView: true,
      canVote,
      canComment: canVote,
      visibilityScope: 'åŒã˜è·ç¨®ã®ã¿',
      permissionReason: canVote ? undefined : 'ä»–è·ç¨®ã®ãŸã‚æŠ•ç¥¨ä¸å¯'
    };
  }

  // ... ä»–ã®æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰
}
```

---

### Phase 4: ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢ï¼ˆç°¡æ˜“ç‰ˆï¼‰ï¼ˆ2-3æ—¥ï¼‰

#### 4.1 çµ„ç¹”ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†ç”»é¢

```typescript
// src/pages/admin/OrganizationMasterAdmin.tsx

export const OrganizationMasterAdmin: React.FC = () => {
  const [facilities, setFacilities] = useState<Facility[]>([]);
  const [organizations, setOrganizations] = useState<OrganizationStructure[]>([]);

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-6">çµ„ç¹”ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†</h1>

      {/* æ–½è¨­ä¸€è¦§ */}
      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-4">æ–½è¨­ä¸€è¦§</h2>
        {facilities.map(facility => (
          <FacilityCard key={facility.id} facility={facility} />
        ))}
      </section>

      {/* çµ„ç¹”æ§‹é€  */}
      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-4">çµ„ç¹”æ§‹é€ </h2>
        <OrganizationTree organizations={organizations} />
      </section>

      {/* è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®š */}
      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-4">è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®š</h2>
        <AgendaModeConfigEditor />
      </section>
    </div>
  );
};
```

---

## ğŸ“Š å®Ÿè£…ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³

### Week 1ï¼ˆ10/14-10/20ï¼‰

| æ—¥ä»˜ | ã‚¿ã‚¹ã‚¯ | æ‹…å½“ | çŠ¶æ…‹ |
|------|--------|------|------|
| 10/14 | ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ | Dev1 | ğŸ”µ Ready |
| 10/15 | ã‚¹ã‚­ãƒ¼ãƒçµ±åˆ | Dev1 | ğŸ”µ Ready |
| 10/16 | ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ | Dev1 | ğŸ”µ Ready |
| 10/17 | ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ | Dev1 | ğŸ”µ Ready |
| 10/18 | ãƒ‡ãƒ¼ã‚¿ç¢ºèªãƒ»ä¿®æ­£ | Dev1 | ğŸ”µ Ready |

### Week 2ï¼ˆ10/21-10/27ï¼‰

| æ—¥ä»˜ | ã‚¿ã‚¹ã‚¯ | æ‹…å½“ | çŠ¶æ…‹ |
|------|--------|------|------|
| 10/21 | AgendaLevelEngineæ”¹ä¿®é–‹å§‹ | Dev2 | ğŸ”µ Ready |
| 10/22 | æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£… | Dev2 | ğŸ”µ Ready |
| 10/23 | ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ | Dev2 | ğŸ”µ Ready |
| 10/24 | çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿæ–½ | Dev2 | ğŸ”µ Ready |
| 10/25 | ãƒã‚°ä¿®æ­£ | Dev2 | ğŸ”µ Ready |

### Week 3ï¼ˆ10/28-11/3ï¼‰

| æ—¥ä»˜ | ã‚¿ã‚¹ã‚¯ | æ‹…å½“ | çŠ¶æ…‹ |
|------|--------|------|------|
| 10/28 | ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢UIå®Ÿè£… | Dev3 | ğŸ”µ Ready |
| 10/29 | çµ„ç¹”ãƒã‚¹ã‚¿ãƒ¼ç·¨é›†æ©Ÿèƒ½ | Dev3 | ğŸ”µ Ready |
| 10/30 | è­°é¡Œè¨­å®šç·¨é›†æ©Ÿèƒ½ | Dev3 | ğŸ”µ Ready |
| 10/31 | çµ±åˆãƒ†ã‚¹ãƒˆ | All | ğŸ”µ Ready |
| 11/1-3 | ãƒã‚°ä¿®æ­£ãƒ»æœ€çµ‚ç¢ºèª | All | ğŸ”µ Ready |

---

## ğŸ¯ åŒ»ç™‚ãƒãƒ¼ãƒ ã‹ã‚‰ã®è³ªå•ã¸ã®å›ç­”

### â“ è³ªå•1: æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ã®å‹•çš„å¤‰æ›´

**å›ç­”**: âœ… **å®Œå…¨å¯¾å¿œå¯èƒ½**

```typescript
// ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢ã‹ã‚‰å‹•çš„å¤‰æ›´å¯èƒ½
await prisma.votingGroup.create({
  data: {
    groupId: 'medical_support_group_obara',
    groupName: 'è¨ºç™‚ãƒ»è–¬å‰¤ãƒ»æ „é¤Šã‚°ãƒ«ãƒ¼ãƒ—',
    facilityId: 'fac_obara',
    memberDepartmentIds: ['diagnostic_support_dept', 'pharmacy_dept', 'nutrition_dept'],
    totalStaffCount: 11,
    createdBy: 'LEVEL_99'
  }
});

// æ—¢å­˜ã®éƒ¨é–€è¨­å®šã‚’è‡ªå‹•æ›´æ–°
await prisma.organizationStructure.updateMany({
  where: {
    departmentId: {
      in: ['diagnostic_support_dept', 'pharmacy_dept', 'nutrition_dept']
    }
  },
  data: {
    votingGroupId: 'medical_support_group_obara'
  }
});
```

**å®Ÿè£…**: ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢ã«ã€Œã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã€æ©Ÿèƒ½ã‚’å®Ÿè£…

---

### â“ è³ªå•2: æ–½è¨­é–“é€£æºè­°é¡Œã®æ‰±ã„

**å›ç­”**: âœ… **æ³•äººãƒ¬ãƒ™ãƒ«è­°é¡Œã¨ã—ã¦å¯¾å¿œ**

```typescript
// ã‚¹ã‚³ã‚¢ãŒ300ç‚¹ä»¥ä¸Šã§æ³•äººæ¤œè¨ã«æ˜‡æ ¼
if (score >= 300) {
  post.agendaLevel = 'CORP_REVIEW';
  post.agendaScope = 'corporation';

  // å…¨æ–½è¨­ã®è·å“¡ãŒæŠ•ç¥¨å¯èƒ½
  return {
    canView: true,
    canVote: true,  // æ–½è¨­ã«é–¢ä¿‚ãªãå…¨å“¡æŠ•ç¥¨å¯èƒ½
    canComment: true,
    visibilityScope: 'æ³•äººå†…å…¨å“¡'
  };
}
```

**å®Ÿè£…**: æ—¢å­˜ã®AgendaLevelEngineã§å¯¾å¿œæ¸ˆã¿

---

### â“ è³ªå•3: å…¼ä»»è·å“¡ã®æŠ•ç¥¨æ¨©

**å›ç­”**: âœ… **ä¸»æ‰€å±ã®ã¿ã§æŠ•ç¥¨**ï¼ˆäºŒé‡æŠ•ç¥¨é˜²æ­¢ï¼‰

```typescript
// User.primaryDepartmentId: ä¸»æ‰€å±ï¼ˆå…¥æ‰€èª²ï¼‰
// User.secondaryDepartmentIds: å‰¯æ‰€å±ï¼ˆ["æ”¯æ´ç›¸è«‡å®¤"]ï¼‰

// æŠ•ç¥¨æ¨©åˆ¤å®š
const canVote = post.authorDepartmentId === user.primaryDepartmentId;

// äºŒé‡æŠ•ç¥¨ãƒã‚§ãƒƒã‚¯
const existingVote = await prisma.vote.findUnique({
  where: {
    userId_postId: {
      userId: user.id,
      postId: post.id
    }
  }
});

if (existingVote) {
  throw new Error('æ—¢ã«æŠ•ç¥¨æ¸ˆã¿ã§ã™');
}
```

**å®Ÿè£…**: ä¸»æ‰€å±ã®ã¿ã§æŠ•ç¥¨ã€å‰¯æ‰€å±ã¯é–²è¦§ã®ã¿

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å®Ÿè£…å‰ã®ç¢ºèª

- [x] åŒ»ç™‚ãƒãƒ¼ãƒ ã‹ã‚‰ã®å›ç­”å—é ˜ âœ…
- [x] æ–½è¨­æƒ…å ±ã®ç¢ºå®šï¼ˆ3æ–½è¨­ï¼‰ âœ…
- [x] çµ„ç¹”æ§‹é€ ã®ç¢ºå®šï¼ˆå…¨éƒ¨é–€ï¼‰ âœ…
- [x] æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—ã®æ±ºå®šï¼ˆ14éƒ¨é–€ï¼‰ âœ…
- [x] è¿½åŠ è·ç¨®ã®ç¢ºèªï¼ˆ5è·ç¨®ï¼‰ âœ…
- [x] è³ªå•ã¸ã®å›ç­”æº–å‚™ âœ…

### å®Ÿè£…ä¸­ã®ç¢ºèª

- [ ] ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- [ ] ã‚¹ã‚­ãƒ¼ãƒçµ±åˆå®Œäº†
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- [ ] ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥
- [ ] AgendaLevelEngineæ”¹ä¿®
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿæ–½
- [ ] ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢å®Ÿè£…

### å®Ÿè£…å¾Œã®ç¢ºèª

- [ ] çµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸ
- [ ] åŒ»ç™‚ãƒãƒ¼ãƒ ãƒ¬ãƒ“ãƒ¥ãƒ¼
- [ ] æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆ

---

## ğŸ“ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### ğŸ”´ æœ€å„ªå…ˆï¼ˆä»Šé€±ä¸­ï¼‰

1. **ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ**
   - 3æ–½è¨­ã®æ–½è¨­ãƒã‚¹ã‚¿ãƒ¼
   - å…¨éƒ¨é–€ã®çµ„ç¹”æ§‹é€ 
   - è¿½åŠ è·ç¨®ãƒã‚¹ã‚¿ãƒ¼
   - è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆ14éƒ¨é–€ï¼‰

2. **ã‚¹ã‚­ãƒ¼ãƒçµ±åˆã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**
   - schema_organization_extension.prismaã‚’çµ±åˆ
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
   - ãƒ‡ãƒ¼ã‚¿æŠ•å…¥

### ğŸŸ¡ ä¸­å„ªå…ˆï¼ˆæ¥é€±ï¼‰

3. **AgendaLevelEngineæ”¹ä¿®**
   - çµ„ç¹”æ§‹é€ å¯¾å¿œ
   - è·ç¨®ãƒ™ãƒ¼ã‚¹æŠ•ç¥¨
   - é…ç½®å ´æ‰€ãƒ™ãƒ¼ã‚¹æŠ•ç¥¨

4. **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè£…**

### ğŸŸ¢ ä½å„ªå…ˆï¼ˆå†æ¥é€±ï¼‰

5. **ãƒ¬ãƒ™ãƒ«99ç®¡ç†ç”»é¢å®Ÿè£…**
6. **åŒ»ç™‚ãƒãƒ¼ãƒ ãƒ¬ãƒ“ãƒ¥ãƒ¼**

---

**ä½œæˆæ—¥**: 2025-10-12
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…æº–å‚™å®Œäº†
**æ¬¡ã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³**: ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆ10/17äºˆå®šï¼‰
