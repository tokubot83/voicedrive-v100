# Level 99 æŠ•ç¥¨è¨­å®šæ©Ÿèƒ½ - è©³ç´°è¨­è¨ˆæ›¸

**ä½œæˆæ—¥**: 2025-10-13
**ä½œæˆè€…**: VoiceDriveé–‹ç™ºãƒãƒ¼ãƒ 
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [UIè¨­è¨ˆ](#uiè¨­è¨ˆ)
3. [ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ](#ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ)
4. [ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ](#ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [å®Ÿè£…è¨ˆç”»](#å®Ÿè£…è¨ˆç”»)

---

## æ¦‚è¦

### ç›®çš„

Level 99ç®¡ç†è€…ãŒã€è­°é¡Œãƒ¢ãƒ¼ãƒ‰ã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰ã®æŠ•ç¥¨è¨­å®šã‚’ç›´æ„Ÿçš„ã«ç®¡ç†ã§ãã‚‹UIã‚’æä¾›ã™ã‚‹ã€‚

### ä¸»è¦æ©Ÿèƒ½

1. **æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®š**: éƒ¨é–€åˆ¥ã«æŠ•ç¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆA/B/Cï¼‰ã‚’è¨­å®š
2. **æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†**: å°è¦æ¨¡éƒ¨é–€ã®çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆãƒ»ç®¡ç†
3. **æ‰¿èªè€…æŒ‡å®š**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰ã®æ‰¿èªè€…ã¨ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
4. **è¨­å®šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: å¤‰æ›´å‰ã«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ç¢ºèª
5. **å¤‰æ›´å±¥æ­´**: å…¨ã¦ã®è¨­å®šå¤‰æ›´ã‚’è¨˜éŒ²ãƒ»è¡¨ç¤º

---

## UIè¨­è¨ˆ

### ãƒ¡ã‚¤ãƒ³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

```
Layout.tsx (Level 99å°‚ç”¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼)
â”œâ”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”œâ”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
â”œâ”€ çµ„ç¹”ç®¡ç†
â”œâ”€ æŠ•ç¥¨è¨­å®š â† æ–°è¦è¿½åŠ 
â”‚  â””â”€ /admin/voting-settings
â”œâ”€ çµ±è¨ˆãƒ»ãƒ¬ãƒãƒ¼ãƒˆ
â””â”€ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
```

### ã‚¿ãƒ–æ§‹é€ 

```
/admin/voting-settings

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŠ•ç¥¨è¨­å®š                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ—³ï¸ è­°é¡Œãƒ¢ãƒ¼ãƒ‰] [ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ï¼ˆé¸æŠã—ãŸãƒ¢ãƒ¼ãƒ‰ã®è¨­å®šå†…å®¹ï¼‰             â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ

### ãƒ«ãƒ¼ãƒˆå®šç¾©

```typescript
// src/App.tsx ã¾ãŸã¯ src/routes/index.tsx

// Level 99å°‚ç”¨ãƒ«ãƒ¼ãƒˆ
{
  path: '/admin',
  element: <AdminLayout />,
  children: [
    {
      path: 'voting-settings',
      element: <VotingSettingsPage />,
      children: [
        {
          path: 'agenda',
          element: <AgendaModeSettings />
        },
        {
          path: 'project',
          element: <ProjectModeSettings />
        }
      ]
    }
  ]
}
```

### URLæ§‹é€ 

```
/admin/voting-settings/agenda          # è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®š
/admin/voting-settings/project         # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®š
/admin/voting-settings/history         # å¤‰æ›´å±¥æ­´ï¼ˆå…±é€šï¼‰
```

---

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ admin/
â”‚       â”œâ”€â”€ VotingSettingsPage.tsx              # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚       â”œâ”€â”€ AgendaModeSettingsPage.tsx          # è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®š
â”‚       â””â”€â”€ ProjectModeSettingsPage.tsx         # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®š
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ voting/
â”‚           â”œâ”€â”€ common/
â”‚           â”‚   â”œâ”€â”€ VotingScopeConfig.tsx       # æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®šï¼ˆå…±é€šï¼‰
â”‚           â”‚   â”œâ”€â”€ VotingGroupManager.tsx      # æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ï¼ˆå…±é€šï¼‰
â”‚           â”‚   â”œâ”€â”€ ChangeHistoryViewer.tsx     # å¤‰æ›´å±¥æ­´è¡¨ç¤ºï¼ˆå…±é€šï¼‰
â”‚           â”‚   â””â”€â”€ SettingsPreview.tsx         # è¨­å®šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå…±é€šï¼‰
â”‚           â”‚
â”‚           â”œâ”€â”€ agenda/
â”‚           â”‚   â”œâ”€â”€ AgendaVotingScopeConfig.tsx # è­°é¡Œãƒ¢ãƒ¼ãƒ‰æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—
â”‚           â”‚   â”œâ”€â”€ PublicScopeConfig.tsx       # å…¬é–‹ç¯„å›²è¨­å®š
â”‚           â”‚   â””â”€â”€ CrossFacilityConfig.tsx     # æ–½è¨­æ¨ªæ–­è­°é¡Œè¨­å®š
â”‚           â”‚
â”‚           â””â”€â”€ project/
â”‚               â”œâ”€â”€ ProjectApprovalConfig.tsx   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ‰¿èªãƒ•ãƒ­ãƒ¼
â”‚               â”œâ”€â”€ VotingGroupApprover.tsx     # æ‰¿èªè€…æŒ‡å®š
â”‚               â”œâ”€â”€ ApproverRotation.tsx        # æ‰¿èªè€…ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
â”‚               â””â”€â”€ CommitteeSubmission.tsx     # å§”å“¡ä¼šæå‡ºè¨­å®š
â”‚
â””â”€â”€ services/
    â””â”€â”€ admin/
        â””â”€â”€ VotingConfigService.ts              # æŠ•ç¥¨è¨­å®šã‚µãƒ¼ãƒ“ã‚¹
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### Stateç®¡ç†

```typescript
// src/hooks/useVotingSettings.ts

interface VotingSettings {
  agenda: AgendaModeConfig;
  project: ProjectModeConfig;
}

interface AgendaModeConfig {
  votingScopes: DepartmentVotingScope[];
  votingGroups: VotingGroup[];
  publicScopes: PublicScopeRule[];
  crossFacilityTags: CrossFacilityTag[];
}

interface ProjectModeConfig {
  approvalFlow: ApprovalFlowConfig;
  votingGroupApprovers: VotingGroupApprover[];
  committeeSubmission: CommitteeSubmissionConfig;
}

export const useVotingSettings = () => {
  const [settings, setSettings] = useState<VotingSettings | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const loadSettings = async () => {
    // APIå‘¼ã³å‡ºã—
  };

  const saveSettings = async (newSettings: Partial<VotingSettings>) => {
    // APIå‘¼ã³å‡ºã—
  };

  return { settings, loading, error, loadSettings, saveSettings };
};
```

### APIè¨­è¨ˆ

```typescript
// API Endpoints

// è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®š
GET    /api/admin/voting-settings/agenda           # å–å¾—
PUT    /api/admin/voting-settings/agenda           # æ›´æ–°

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®š
GET    /api/admin/voting-settings/project          # å–å¾—
PUT    /api/admin/voting-settings/project          # æ›´æ–°

// æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—
GET    /api/admin/voting-groups                    # ä¸€è¦§å–å¾—
POST   /api/admin/voting-groups                    # ä½œæˆ
PUT    /api/admin/voting-groups/:id                # æ›´æ–°
DELETE /api/admin/voting-groups/:id                # å‰Šé™¤

// å¤‰æ›´å±¥æ­´
GET    /api/admin/voting-settings/history          # å±¥æ­´å–å¾—

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
POST   /api/admin/voting-settings/preview          # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```

---

## å®Ÿè£…è¨ˆç”»

### Phase 1: åŸºæœ¬æ§‹é€ å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸ”´ HIGHï¼‰

#### 1.1 ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 

```typescript
// src/App.tsx

// Level 99å°‚ç”¨ãƒ«ãƒ¼ãƒˆã«è¿½åŠ 
<Route path="/admin/voting-settings" element={<VotingSettingsPage />}>
  <Route index element={<Navigate to="agenda" replace />} />
  <Route path="agenda" element={<AgendaModeSettingsPage />} />
  <Route path="project" element={<ProjectModeSettingsPage />} />
  <Route path="history" element={<ChangeHistoryPage />} />
</Route>
```

#### 1.2 ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸å®Ÿè£…

```typescript
// src/pages/admin/VotingSettingsPage.tsx

import React from 'react';
import { Outlet, useLocation, useNavigate } from 'react-router-dom';

const VotingSettingsPage: React.FC = () => {
  const location = useLocation();
  const navigate = useNavigate();

  const activeTab = location.pathname.includes('project') ? 'project' : 'agenda';

  return (
    <div className="min-h-screen bg-gray-50">
      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
      <header className="bg-white shadow">
        <div className="max-w-7xl mx-auto px-4 py-6">
          <h1 className="text-3xl font-bold text-gray-900">
            æŠ•ç¥¨è¨­å®š
          </h1>
          <p className="mt-2 text-sm text-gray-600">
            è­°é¡Œãƒ¢ãƒ¼ãƒ‰ã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰ã®æŠ•ç¥¨è¨­å®šã‚’ç®¡ç†ã—ã¾ã™
          </p>
        </div>
      </header>

      {/* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
      <div className="max-w-7xl mx-auto px-4 py-4">
        <div className="border-b border-gray-200">
          <nav className="-mb-px flex space-x-8">
            <button
              onClick={() => navigate('/admin/voting-settings/agenda')}
              className={`
                py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2
                ${activeTab === 'agenda'
                  ? 'border-blue-500 text-blue-600'
                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }
              `}
            >
              <span>ğŸ—³ï¸</span>
              <span>è­°é¡Œãƒ¢ãƒ¼ãƒ‰</span>
            </button>
            <button
              onClick={() => navigate('/admin/voting-settings/project')}
              className={`
                py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2
                ${activeTab === 'project'
                  ? 'border-blue-500 text-blue-600'
                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }
              `}
            >
              <span>ğŸ“‹</span>
              <span>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰</span>
            </button>
            <button
              onClick={() => navigate('/admin/voting-settings/history')}
              className={`
                py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2
                ${location.pathname.includes('history')
                  ? 'border-blue-500 text-blue-600'
                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }
              `}
            >
              <span>ğŸ“œ</span>
              <span>å¤‰æ›´å±¥æ­´</span>
            </button>
          </nav>
        </div>
      </div>

      {/* ãƒ¢ãƒ¼ãƒ‰åˆ¥è¨­å®šç”»é¢ */}
      <div className="max-w-7xl mx-auto px-4 py-6">
        <Outlet />
      </div>
    </div>
  );
};

export default VotingSettingsPage;
```

#### 1.3 Layout.tsx ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ 

```typescript
// src/components/layout/Layout.tsx

// Level 99ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«è¿½åŠ 
{user.permissionLevel >= 99 && (
  <>
    <Link
      to="/admin/voting-settings"
      className="flex items-center px-4 py-2 text-sm hover:bg-gray-100"
    >
      <span className="mr-3">âš™ï¸</span>
      æŠ•ç¥¨è¨­å®š
    </Link>
  </>
)}
```

---

### Phase 2: è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šå®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸ”´ HIGHï¼‰

#### 2.1 è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šãƒšãƒ¼ã‚¸

```typescript
// src/pages/admin/AgendaModeSettingsPage.tsx

import React, { useState, useEffect } from 'react';
import AgendaVotingScopeConfig from '../../components/admin/voting/agenda/AgendaVotingScopeConfig';
import VotingGroupManager from '../../components/admin/voting/common/VotingGroupManager';
import PublicScopeConfig from '../../components/admin/voting/agenda/PublicScopeConfig';

const AgendaModeSettingsPage: React.FC = () => {
  const [hasChanges, setHasChanges] = useState(false);
  const [saving, setSaving] = useState(false);

  const handleSave = async () => {
    setSaving(true);
    try {
      // APIå‘¼ã³å‡ºã—
      console.log('ä¿å­˜ä¸­...');
      // await saveAgendaModeSettings(settings);
      setHasChanges(false);
    } catch (error) {
      console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
    } finally {
      setSaving(false);
    }
  };

  return (
    <div className="space-y-6">
      {/* 1. æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®š */}
      <div className="bg-white shadow rounded-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h2 className="text-xl font-bold text-gray-900">
              æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®š
            </h2>
            <p className="mt-1 text-sm text-gray-600">
              éƒ¨é–€ã”ã¨ã«æŠ•ç¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆé…ç½®å˜ä½ãƒ»è·ç¨®å˜ä½ãƒ»éƒ¨é–€å…¨ä½“ï¼‰ã‚’è¨­å®šã—ã¾ã™
            </p>
          </div>
        </div>
        <AgendaVotingScopeConfig onChange={() => setHasChanges(true)} />
      </div>

      {/* 2. æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç† */}
      <div className="bg-white shadow rounded-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h2 className="text-xl font-bold text-gray-900">
              æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
            </h2>
            <p className="mt-1 text-sm text-gray-600">
              å°è¦æ¨¡éƒ¨é–€ã‚’çµ±åˆã—ã¦æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã¾ã™
            </p>
          </div>
        </div>
        <VotingGroupManager mode="agenda" onChange={() => setHasChanges(true)} />
      </div>

      {/* 3. å…¬é–‹ç¯„å›²è¨­å®š */}
      <div className="bg-white shadow rounded-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h2 className="text-xl font-bold text-gray-900">
              å…¬é–‹ç¯„å›²è¨­å®š
            </h2>
            <p className="mt-1 text-sm text-gray-600">
              ã‚¹ã‚³ã‚¢ç¯„å›²åˆ¥ã«æŠ•ç¨¿ã®å…¬é–‹ç¯„å›²ã‚’è¨­å®šã—ã¾ã™
            </p>
          </div>
        </div>
        <PublicScopeConfig onChange={() => setHasChanges(true)} />
      </div>

      {/* ä¿å­˜ãƒœã‚¿ãƒ³ */}
      <div className="flex justify-end space-x-4 sticky bottom-0 bg-white py-4 border-t">
        <button
          onClick={() => window.location.href = '/admin/voting-settings/agenda/preview'}
          className="px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
        >
          ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        </button>
        <button
          onClick={handleSave}
          disabled={!hasChanges || saving}
          className={`
            px-6 py-2 rounded-md font-medium
            ${hasChanges && !saving
              ? 'bg-blue-600 text-white hover:bg-blue-700'
              : 'bg-gray-300 text-gray-500 cursor-not-allowed'
            }
          `}
        >
          {saving ? 'ä¿å­˜ä¸­...' : 'å¤‰æ›´ã‚’ä¿å­˜'}
        </button>
      </div>
    </div>
  );
};

export default AgendaModeSettingsPage;
```

---

### Phase 3: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®šå®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸ”´ HIGHï¼‰

#### 3.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®šãƒšãƒ¼ã‚¸

```typescript
// src/pages/admin/ProjectModeSettingsPage.tsx

import React, { useState } from 'react';
import ProjectApprovalConfig from '../../components/admin/voting/project/ProjectApprovalConfig';
import VotingGroupApprover from '../../components/admin/voting/project/VotingGroupApprover';

const ProjectModeSettingsPage: React.FC = () => {
  const [hasChanges, setHasChanges] = useState(false);
  const [saving, setSaving] = useState(false);

  const handleSave = async () => {
    setSaving(true);
    try {
      console.log('ä¿å­˜ä¸­...');
      setHasChanges(false);
    } catch (error) {
      console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
    } finally {
      setSaving(false);
    }
  };

  return (
    <div className="space-y-6">
      {/* 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ‰¿èªãƒ•ãƒ­ãƒ¼ */}
      <div className="bg-white shadow rounded-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h2 className="text-xl font-bold text-gray-900">
              ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ‰¿èªãƒ•ãƒ­ãƒ¼
            </h2>
            <p className="mt-1 text-sm text-gray-600">
              ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‰¿èªãƒ•ãƒ­ãƒ¼ã¨ã‚¹ã‚³ã‚¢é–¾å€¤ã‚’è¨­å®šã—ã¾ã™
            </p>
          </div>
        </div>
        <ProjectApprovalConfig onChange={() => setHasChanges(true)} />
      </div>

      {/* 2. æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—æ‰¿èªè€…æŒ‡å®š */}
      <div className="bg-white shadow rounded-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h2 className="text-xl font-bold text-gray-900">
              æŠ•ç¥¨ã‚°ãƒ«ãƒ¼ãƒ—æ‰¿èªè€…æŒ‡å®š
            </h2>
            <p className="mt-1 text-sm text-gray-600">
              å°è¦æ¨¡éƒ¨é–€çµ±åˆæ™‚ã®ä»£è¡¨æ‰¿èªè€…ã¨ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¾ã™
            </p>
          </div>
        </div>
        <VotingGroupApprover onChange={() => setHasChanges(true)} />
      </div>

      {/* ä¿å­˜ãƒœã‚¿ãƒ³ */}
      <div className="flex justify-end space-x-4 sticky bottom-0 bg-white py-4 border-t">
        <button
          onClick={() => window.location.href = '/admin/voting-settings/project/preview'}
          className="px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
        >
          ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        </button>
        <button
          onClick={handleSave}
          disabled={!hasChanges || saving}
          className={`
            px-6 py-2 rounded-md font-medium
            ${hasChanges && !saving
              ? 'bg-blue-600 text-white hover:bg-blue-700'
              : 'bg-gray-300 text-gray-500 cursor-not-allowed'
            }
          `}
        >
          {saving ? 'ä¿å­˜ä¸­...' : 'å¤‰æ›´ã‚’ä¿å­˜'}
        </button>
      </div>
    </div>
  );
};

export default ProjectModeSettingsPage;
```

---

### Phase 4: å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸŸ¡ MEDIUMï¼‰

#### 4.1 æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// src/components/admin/voting/agenda/AgendaVotingScopeConfig.tsx

import React, { useState } from 'react';

interface VotingScopePattern {
  code: 'A' | 'B' | 'C';
  name: string;
  description: string;
}

const patterns: VotingScopePattern[] = [
  { code: 'A', name: 'é…ç½®å˜ä½', description: 'ç—…æ£Ÿãƒ»å¤–æ¥ãªã©é…ç½®ã”ã¨ã«æŠ•ç¥¨' },
  { code: 'B', name: 'è·ç¨®å˜ä½', description: 'PT/OT/STãªã©è·ç¨®ã”ã¨ã«æŠ•ç¥¨' },
  { code: 'C', name: 'éƒ¨é–€å…¨ä½“', description: 'éƒ¨é–€å…¨ä½“ã§æŠ•ç¥¨' }
];

interface Props {
  onChange: () => void;
}

const AgendaVotingScopeConfig: React.FC<Props> = ({ onChange }) => {
  const [selectedFacility, setSelectedFacility] = useState('obara-hospital');
  const [departments, setDepartments] = useState([
    { id: 'nursing', name: 'çœ‹è­·éƒ¨', pattern: 'A' as const, sections: ['å¤–æ¥', '2éš', '3éš', '4éš', '5éš'] },
    { id: 'rehab', name: 'ãƒªãƒãƒ“ãƒªéƒ¨', pattern: 'B' as const, sections: ['PT', 'OT', 'ST'] },
    { id: 'admin', name: 'äº‹å‹™éƒ¨', pattern: 'C' as const, sections: [] }
  ]);

  const [editingDept, setEditingDept] = useState<string | null>(null);

  return (
    <div className="space-y-4">
      {/* æ–½è¨­é¸æŠ */}
      <div className="flex items-center space-x-4">
        <label className="text-sm font-medium text-gray-700">æ–½è¨­:</label>
        <select
          value={selectedFacility}
          onChange={(e) => setSelectedFacility(e.target.value)}
          className="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
        >
          <option value="obara-hospital">å°åŸç—…é™¢</option>
          <option value="tategami-rehabilitation">ç«‹ç¥ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ¸©æ³‰ç—…é™¢</option>
          <option value="espoir-tategami">ã‚¨ã‚¹ãƒãƒ¯ãƒ¼ãƒ«ç«‹ç¥</option>
        </select>
      </div>

      {/* éƒ¨é–€ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« */}
      <div className="overflow-x-auto">
        <table className="min-w-full divide-y divide-gray-200">
          <thead className="bg-gray-50">
            <tr>
              <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                éƒ¨é–€å
              </th>
              <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                æŠ•ç¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³
              </th>
              <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                å¯¾è±¡ç¯„å›²
              </th>
              <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
                æ“ä½œ
              </th>
            </tr>
          </thead>
          <tbody className="bg-white divide-y divide-gray-200">
            {departments.map((dept) => (
              <tr key={dept.id} className="hover:bg-gray-50">
                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  {dept.name}
                </td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    {dept.pattern}: {patterns.find(p => p.code === dept.pattern)?.name}
                  </span>
                </td>
                <td className="px-6 py-4 text-sm text-gray-500">
                  {dept.sections.length > 0 ? dept.sections.join(', ') : 'å…¨å“¡'}
                </td>
                <td className="px-6 py-4 whitespace-nowrap text-sm">
                  <button
                    onClick={() => setEditingDept(dept.id)}
                    className="text-blue-600 hover:text-blue-900"
                  >
                    ç·¨é›†
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰ */}
      {editingDept && (
        <div className="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 max-w-2xl w-full">
            <h3 className="text-lg font-medium mb-4">æŠ•ç¥¨ã‚¹ã‚³ãƒ¼ãƒ—ç·¨é›†</h3>
            <p className="text-sm text-gray-600 mb-4">
              â€» è©³ç´°ãªç·¨é›†UIã¯æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã§å®Ÿè£…
            </p>
            <div className="flex justify-end space-x-2">
              <button
                onClick={() => setEditingDept(null)}
                className="px-4 py-2 border border-gray-300 rounded-md"
              >
                é–‰ã˜ã‚‹
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default AgendaVotingScopeConfig;
```

---

## ã¾ã¨ã‚

### å®Ÿè£…å®Œäº†äºˆå®š

- **Phase 1**: ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ï¼ˆ1æ—¥ï¼‰
- **Phase 2**: è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆ2æ—¥ï¼‰
- **Phase 3**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆ2æ—¥ï¼‰
- **Phase 4**: å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆ2æ—¥ï¼‰

**åˆè¨ˆ**: ç´„1é€±é–“ã§åŸºæœ¬å®Ÿè£…å®Œäº†

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. Layout.tsxã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ 
2. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
3. ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸å®Ÿè£…
4. è­°é¡Œãƒ¢ãƒ¼ãƒ‰è¨­å®šå®Ÿè£…
5. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®šå®Ÿè£…

---

**ä½œæˆè€…**: VoiceDriveé–‹ç™ºãƒãƒ¼ãƒ 
**æœ€çµ‚æ›´æ–°**: 2025-10-13
